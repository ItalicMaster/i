(function(){if(!window.common)window.common={};if(!common.logging){var logging={};common.logging=logging;if(!window.console){window.console={log:function(){}}};if(!window.console.log)window.console.log=function(){}
if(!window.console.error)window.console.error=window.console.log;var console_log=undefined;logging.init=function(){var kwdebug=window.kwdebug;if(!kwdebug)kwdebug=document.cookie.indexOf("kwdebug=true")>=0;if(!kwdebug){try{if(window.localStorage){var kwdebug1=localStorage.getItem("kw.debug");if(kwdebug1&&kwdebug1=="true")kwdebug=true;}}catch(e){}}
if(!kwdebug)kwdebug=location.href.indexOf("kwdebug=true")>=0;if(!console_log)console_log=window.console.log;logging.kwdebug=kwdebug;if(!kwdebug){window.console.log=function(){}}else{window.console.log=console_log;}}
logging.init();logging.getLogger=function(context,error){var ret={};if(window.console.log.bind)ret.log=window.console.log.bind(window.console,context);if(window.console.error.bind)ret.error=window.console.error.bind(window.console,context);if(!ret.log)ret.log=window.console.log;if(!ret.error)ret.error=window.console.error;return ret;}}
if(!common.errors){common.errors={conf:{max_errors:30}}
common.errors.get=function(){var ret=null;if(window.localStorage&&window.JSON){var ret=localStorage.getItem("kw.errors");if(ret)ret=JSON.parse(ret);}
return ret;}
common.errors.add=function(name,data){if(!common.logging.kwdebug){common.errors.clear();return;}
var max_errors=common.errors.conf.max_errors;if(window.localStorage&&window.JSON){var errors=localStorage.getItem("kw.errors");if(!errors)errors=[];else errors=JSON.parse(errors);var ts=new Date().getTime();var error={"code":name,"ts":ts,"data":data}
errors.push(error);if(errors.length>max_errors)errors=errors.slice(errors.length-max_errors);localStorage.setItem("kw.errors",JSON.stringify(errors));}}
common.errors.clear=function(){if(window.localStorage&&window.JSON){localStorage.setItem("kw.errors",JSON.stringify([]));}}}})();;
if(!window.pw)window.pw={};pw.config={COOKIE_NAME:"kw_pw_data",COOKIE_EXPIRE:365,CLUSTER_COOKIE_NAME:"kw_pw",DEFAULT_COUNTER:"counter1",VALIDITY_PERIOD:"month",PW_PAGE_URL:location.protocol+"//scripts.repubblica.it/pw/pw.js",PW_TRACKING_URL:location.protocol+"//scripts.repubblica.it/pw/void.js",DRY_RUN:true}
pw.config.referrer={};
(function(){if(window.pw&&window.jQuery&&pw.config){var $=window.jQuery;var quotidiani="(tangeri)";var getQuotidiano=function(){var quot=null;var match=location.hostname.match("([^\.]+\.)*"+quotidiani+".repubblica.it");var match2=location.href.match("https?:\/\/([\.]+\.)*video\.repubblica\.it\/"+quotidiani+"(\/.*)?$")
if(match)quot=match[2];if(!quot&&match2)quot=match2[2];return quot;}
var quot=getQuotidiano();var readCookieREP=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;};var is_test=pw.config.TEST;if(is_test){var sfoglio="https://test-api.gelocal.it/edicola-v1?testata=repubblica";var cookie_name="KWSOCIAL";var pw2_cookie_name="T-repubsfoglio";var quotidiani="https://test.quotidiani.gelocal.it/";}else{var sfoglio="https://api.repubblica.it/edicola-v1?testata=repubblica";var cookie_name="KWSOCIAL";var pw2_cookie_name="repubblicasfoglio";var quotidiani="https://quotidiani.repubblica.it/";}
pw.config=$.extend(true,pw.config,{PW2_COOKIE_NAME:pw2_cookie_name,LOGGED_COOKIE_NAME:cookie_name,LOGGED_CLUSTER:1401,SITE_CLUSTER:1400,DRY_RUN:false});var cb=function(ev,data){var authorized=false;if(pw_assistant_info)
{if(pw_assistant_info.user)
{if(pw_assistant_info.user.authorized)
{if(pw_assistant_info.user.authorized===true)
authorized=true;}
session=readCookieREP(pw2_cookie_name);if(session)
pw_assistant_info.user.logged=true;}}
var status=data.status;var tracked=data.tracked;var active=data.active&&!data.pw2&&status!="free_pageviews";if(!active&&window.kwdnt===undefined&&!data.pw2&&!authorized)active=true;if(active){$(function(){$("body").addClass("premium-pw-active");$(".paywall-adagio").removeAttr("style");$(".article-body").removeAttr("style").css({"max-height":"200px",overflow:"hidden",display:"inline-block"});});}else{$(function(){$("body").addClass("premium-user");$(".article-body").removeAttr("style");$(".paywall-adagio,.paywall-gradient").remove();});}};pw.config.CALLBACKS=[cb];window.pw_redirect=function(ev,data){};}})();;
(function(){if(window.jQuery){var $=window.jQuery;if(!$.deparam){(function(h){h.deparam=function(i,j){var d={},k={"true":!0,"false":!1,"null":null};h.each(i.replace(/\+/g," ").split("&"),function(i,l){var m;var a=l.split("="),c=decodeURIComponent(a[0]),g=d,f=0,b=c.split("]["),e=b.length-1;/\[/.test(b[0])&&/\]$/.test(b[e])?(b[e]=b[e].replace(/\]$/,""),b=b.shift().split("[").concat(b),e=b.length-1):e=0;if(2===a.length)if(a=decodeURIComponent(a[1]),j&&(a=a&&!isNaN(a)?+a:"undefined"===a?void 0:void 0!==k[a]?k[a]:a),e)for(;f<=e;f++)c=""===b[f]?g.length:b[f],m=g[c]=f<e?g[c]||(b[f+1]&&isNaN(b[f+1])?{}:[]):a,g=m;else h.isArray(d[c])?d[c].push(a):d[c]=void 0!==d[c]?[d[c],a]:a;else c&&(d[c]=j?void 0:"")});return d}})(jQuery);}
if(!window.pw)return;if(!pw.config)return;if(location.href.indexOf("kw_dry_run=false")>=0&&pw.config.DRY_RUN){pw.config.DRY_RUN=false;}
var COOKIE_NAME=pw.config.COOKIE_NAME;var PW2_COOKIE_NAME=pw.config.PW2_COOKIE_NAME;var COOKIE_EXPIRE=pw.config.COOKIE_EXPIRE;var CLUSTER_COOKIE_NAME=pw.config.CLUSTER_COOKIE_NAME;var CLUSTER_COOKIE_SET=pw.config.CLUSTER_COOKIE_SET;var LOGGED_COOKIE_NAME=pw.config.LOGGED_COOKIE_NAME;var LOGGED_CLUSTER=pw.config.LOGGED_CLUSTER;if(!LOGGED_CLUSTER)LOGGED_CLUSTER="logged";var SITE_CLUSTER=pw.config.SITE_CLUSTER;var PW_PAGE_URL=pw.config.PW_PAGE_URL;var PW_PAGE2_URL=pw.config.PW_PAGE2_URL;var PW_TRACKING_URL=pw.config.PW_TRACKING_URL;var VALIDITY_PERIOD=pw.config.VALIDITY_PERIOD;var DEFAULT_COUNTER=pw.config.DEFAULT_COUNTER;var DRY_RUN=pw.config.DRY_RUN;var CALLBACKS=pw.config.CALLBACKS;var counter_data={};var intermediate_data={};current_page_counter=null;pw_assistant_info=null;actual_counter=null;actual_limit=null;info_user_logged=false;actual_blocked=0;var addParams=function(url,params){if(url.indexOf("?")>=0)url+="&";else url+="?";url+=$.param(params);return url;}
var getLogger=function(context){var ret={log:function(){},error:function(){}};if(window.common&&common.logging){ret=common.logging.getLogger(context);}else if(window.console){ret=window.console;}
return ret;}
var logger=getLogger("PW");var readDate=function(source){source=source.replace(/\//g,"-");source=source.replace(/\s+/g,"T");return new Date(Date.parse(source));}
var getFirstLevelDomain=function(){var d=document.domain;var idx=d.lastIndexOf(".",d.lastIndexOf(".")-1);return d.substring(idx);}
var readCookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;};var setCookie=function(cookieName,cookieValue,domain,path,nDays){if(!domain)domain=document.domain;if(!path)path="/";var today=new Date();if(nDays==null||nDays==0)nDays=1;var expire=new Date(today.getTime()+3600000*24*nDays);var cookieString=cookieName+"="+cookieValue+";expires="+expire.toGMTString()
+";domain="+domain+";path="+path+";";document.cookie=cookieString;}
var config={isTracked:function(){if(!window.pw||!pw.page)return false;var ret=pw.page.tracked===true||(pw.page.tracked&&pw.page.tracked=="true");return ret;},getDays:function(){if(!window.pw||!pw.page)return null;try{return parseInt(pw.page.days);}catch(e){return undefined;}},getFromDay:function(){if(!window.pw||!pw.page)return null;try{var ret=parseInt(pw.page.from_day);if(isNaN(ret))return null;else return new Date(ret*1000);}catch(e){return undefined;}},getToDay:function(){if(!window.pw||!pw.page)return null;try{var ret=parseInt(pw.page.to_day);if(isNaN(ret))return null;else return new Date(ret*1000);}catch(e){return undefined;}},getCounters:function(clusters){if(!window.pw||!pw.page)return null;var counters=pw.page.counters;if(!counters)return null;if(!clusters){clusters=[];}
var counter_ids_map={}
var counter_ids=[];var add_to_counters=function(cluster){var counter_ids1=counters[cluster];if(counter_ids1&&!(counter_ids1 instanceof Array)){counter_ids1=[counter_ids1]}
if(counter_ids1){for(var j=0;j<counter_ids1.length;j++){var counter_id=counter_ids1[j];if(!counter_ids_map[counter_id]){counter_ids_map[counter_id]=true;counter_ids.push(counter_id);}}}}
for(var i=0;i<clusters.length;i++){var cluster=clusters[i];add_to_counters(cluster);}
if(counter_ids.length==0){add_to_counters("default");if(counter_ids.length==0){counter_ids.push(DEFAULT_COUNTER);}}
var ret=[];for(var i=0;i<counter_ids.length;i++){var counter_id=counter_ids[i];var counter_data1=counter_data[counter_id];if(counter_data1)ret.push(counter_data1);}
return ret;},getPublished:function(){var published=$("meta[property*=':published_time']").attr("content");if(published){return readDate(published);}
return null;},getAllowedReferrers:function(){if(!window.pw||!pw.page)return null;return pw.page.allowedReferrers;},getClusters:function(callback){var readClusters=function(){var ret=readCookie(CLUSTER_COOKIE_NAME);var logged=false;if(LOGGED_COOKIE_NAME)logged=!!readCookie(LOGGED_COOKIE_NAME);if(ret){var ret=ret.replace(/^\"+|\"+$/g,'');ret=ret.split(",").slice(1);}else ret=[];if(logged&&ret.indexOf(LOGGED_CLUSTER)<0){ret.push(LOGGED_CLUSTER);info_user_logged=true;}
else
{if(SITE_CLUSTER){ret.push(SITE_CLUSTER);}}
return ret;}
onCookieAvailable=function(){onCookieAvailable=undefined;var ret=readClusters();callback(ret);}
var cookie=readCookie(CLUSTER_COOKIE_NAME);var ret=readClusters();if(cookie||!CLUSTER_COOKIE_SET||!callback){if(!callback)return ret;else callback(ret);}else if(CLUSTER_COOKIE_SET){$.ajax({url:CLUSTER_COOKIE_SET,dataType:'script',cache:true,success:onCookieAvailable});setTimeout(onCookieAvailable,1000);}}}
var cookie={}
cookie.get=function(cookie_name){if(!cookie_name)cookie_name=COOKIE_NAME;var cookie=readCookie(cookie_name);if(cookie===null)cookie={}
else{cookie=$.deparam(cookie);}
return cookie}
cookie.set=function(cookie){setCookie(COOKIE_NAME,$.param(cookie),getFirstLevelDomain(),"/",COOKIE_EXPIRE);}
cookie.increment=function(counter){var counter_id=counter.id;var limit=counter.getLimit();var cookieVal=cookie.get();if(!cookieVal[counter_id])cookieVal[counter_id]={};var current=cookieVal[counter_id];if(current.c===undefined)current.c=0;current.c++;var after_limit=current.c>=limit;if(!after_limit){delete current.blk;}
cookieVal[counter_id]=current;logger.log("after_paywall: counter.id: "+counter.id);logger.log("after_paywall: value: "+current.c);logger.log("after_paywall: limit: "+limit);logger.log("after_paywall: counter after_limit: "+after_limit);current_page_counter=current.c;cookie.set(cookieVal);}
cookie.getIntermediateRedirect=function(counters){var cookieVal=cookie.get();var ret=null;if(cookieVal){for(var i=0;i<counters.length;i++){var counter=counters[i]
var counter_id=counter.id;var cookieVal1=cookieVal[counter_id];int_test=cookieVal1!==undefined;var int_trig_id=null;var int_trig_data=null;var int_trigs=[];if(counter.intermediate&&int_test){$.each(counter.intermediate,function(i,intr_id){intr_data=intermediate_data[intr_id];if(intr_data&&cookieVal1.c==(intr_data.getLimit()+1)&&(!cookieVal1.intr||!cookieVal1.intr[intr_id])){if(!int_trig_id){int_trig_id=intr_id;int_trig_data=intr_data;}
int_trigs.push(intr_id);}});}
if(int_trig_id){if(ret==null){var red=addParams(int_trig_data.redirect,{"backurl":location.href,"counter":counter_id,"intr":int_trig_id});ret={"redirect":red,"counter":counter_id,"intermediate":int_trig_id};}
cookieVal1.c--;if(!cookieVal1.intr)cookieVal1.intr={};$.each(int_trigs,function(i,intr_id){cookieVal1.intr[intr_id]=1;});}}}
cookie.set(cookieVal);return ret;}
cookie.increment_blocked=function(counter){var cookieVal=cookie.get();if(!cookieVal[counter])cookieVal[counter]={};var current=cookieVal[counter];if(!current.blk){current.blk=1;}else{current.blk++;}
cookieVal[counter]=current;cookie.set(cookieVal);}
cookie.set_last_blocked=function(counter_id){var cookieVal=cookie.get();cookieVal["_lstblk"]=counter_id;cookie.set(cookieVal);}
cookie.getCounterValue=function(counter){var ret={c:0};var cookieVal=cookie.get();if(cookieVal[counter.id])ret=cookieVal[counter.id];return ret;}
cookie.setValidFrom=function(){var cookieVal=cookie.get();var now=getNow();now=getTime(now);var vf=now;cookieVal._vf=vf;cookie.set(cookieVal);}
cookie.getValidTo=function(now,cookieVal){if(cookieVal._vf!==undefined){var vf=parseInt(cookieVal._vf);}else{var vf=getTime(now);}
var vt=null;if(vf&&VALIDITY_PERIOD){vf=new Date(vf*1000);if(VALIDITY_PERIOD=="hour"||VALIDITY_PERIOD=="day"||VALIDITY_PERIOD=="week"||VALIDITY_PERIOD=="month"){vt=new Date(vf.getTime());vt.setUTCSeconds(0);vt.setUTCMinutes(0);vt.setUTCHours(0);}
if(vt){if(VALIDITY_PERIOD=="hour"){vt.setUTCHours(vf.getUTCHours()+1);}else if(VALIDITY_PERIOD=="day"){vt.setUTCDate(vt.getUTCDate()+1);}else if(VALIDITY_PERIOD=="week"){vt.setUTCDate(vt.getUTCDate()-vt.getUTCDay()+7+1);}else if(VALIDITY_PERIOD=="month"){vt.setUTCDate(1);vt.setUTCMonth(vt.getUTCMonth()+1);}}}
return vt;}
cookie.setValidTo=function(now){var cookieVal=cookie.get();if(now&&cookieVal){var vt=cookie.getValidTo(now,cookieVal);var vt1=getTime(vt);if(vt&&(cookieVal._vt===undefined||cookieVal._vt!=vt1)){cookieVal._vt=vt1;cookie.set(cookieVal);}}}
cookie.resetExpired=function(now){var cookieVal=cookie.get();if(now&&cookieVal){var vt=cookie.getValidTo(now,cookieVal);if(vt&&getTime(now)>getTime(vt)){cookieVal={};cookie.set(cookieVal);}}}
var getTime=function(date){return Math.round(date.getTime()/ 1000);}
var getNow=function(){if(window.pw&&pw.time&&!isNaN(parseInt(pw.time))){return new Date(parseInt(pw.time)*1000);}else{return new Date();}}
var checkAllowed=function(){var allowed=false;var allowedReferrers=config.getAllowedReferrers();var referrers=pw.config.referrer;if(referrers===undefined)referrers={};if(pw.referrer!==undefined){$.each(pw.referrer,function(k,v){referrers[k]=v;});}
if(allowedReferrers&&referrers){var referrer=document.referrer;var regexps=[];for(var i=0;i<allowedReferrers.length;i++){var allowedReferrer=allowedReferrers[i];if(allowedReferrer&&referrers[allowedReferrer]){regexps=regexps.concat(referrers[allowedReferrer]);}}
for(var i=0;i<regexps.length;i++){var regexp=regexps[i];regexp=new RegExp(regexp);var res=regexp.exec(referrer);if(res&&res.length>0){allowed=true;}}}
return allowed;}
var getPss=function(counters,now){var ret=false;if(window.pw&&pw.pw2)ret=true;return ret;}
var statusCallbacks=$({});var status=null;var pw_assistant=function(stat)
{var allowed=true;if(stat.status=="blocked")
allowed=false;if(current_page_counter===null)
{if(actual_limit===null)
actual_limit=0;var a=parseInt(actual_blocked);var b=parseInt(actual_limit);var c=a+b;current_page_counter=c;}
var userinfo={authorized:allowed,auth_info:stat.status,consumed:current_page_counter,logged:info_user_logged};var tracked={tracked:pw.page.tracked};var counter_info={id:actual_counter,limit:actual_limit}
pw_assistant_info={page:tracked,counter:counter_info,user:userinfo};return pw_assistant_info;}
var notifyStatus=function(stat){console.log(JSON.stringify(stat));t=pw_assistant(stat);try{if(window.kw_tlh&&window.kw_tlh.paywall){console.log("[pw.js] Neo Data Tag Not Called because Traffic Light Handler is present in page - Calling tlh callback");try{kw_tlh_pw()}catch(e){}}else{console.log("[pw.js] TLH NOT FOUND -> trying to call neodata callback...");window.callNeodataTag();}}catch(e){console.log("[pw.js] ERROR calling tag neodata",e);}
try{console.log("[pw.js] pw_assistant_info",JSON.stringify(t));}catch(e){}
if(!status){status=stat;}
statusCallbacks.trigger("pw.status",stat);};pw.getStatus=function(cb){statusCallbacks.one("pw.status",cb);if(status){notifyStatus(status);}}
if(CALLBACKS){for(var i=0;i<CALLBACKS.length;i++){var cb=CALLBACKS[i];if(cb)pw.getStatus(cb);}}
var pw_finished=false;var pw2_finished=false;var clusters_finished=false;var main=function(){if(!pw_finished||!pw2_finished||!clusters_finished)return;var counter_data1=pw.counter;var intermediate_data1=pw.intermediate;if(!counter_data1&&!pw.pw2){logger.error("configurazione di pagina non caricata");notifyStatus({active:!pw.pw2&&window.kwdnt===undefined,status:"no_configuration"});return;}
if(counter_data1){for(var i=0;i<counter_data1.length;i++){var cd=counter_data1[i];if(cd&&cd.id){counter_data[cd.id]=cd;cd.getLimit=function(){try{return parseInt(this.limit);}catch(e){return undefined;}};if(cd["default"]===true)DEFAULT_COUNTER=cd.id;}}}
if(intermediate_data1){for(var i=0;i<intermediate_data1.length;i++){var id=intermediate_data1[i];if(id&&id.id){intermediate_data[id.id]=id;id.getLimit=function(){try{return parseInt(this.limit);}catch(e){return undefined;}};}}}
var clusters=config.getClusters();var is_tracked=config.isTracked();var counters=config.getCounters(clusters);var now=getNow();var pss=getPss(counters,now);var allowed=checkAllowed();cookie.resetExpired(now);logger.log("is_tracked: "+is_tracked);if(counters)logger.log("counters length: "+counters.length);var st={active:window.kwdnt===undefined,status:"not_tracked"};st.pw2=pss;if(window.pw&&window.pw.pw2_code)st.pw2_code=window.pw.pw2_code;st.ar=allowed;st.tracked=is_tracked;if(is_tracked&&counters.length>0){var nt=window.pw_nt;if(nt){st.status="nt_by_design";}
var published=config.getPublished();logger.log("referrer allowed: "+allowed);logger.log("published: "+published);var days=config.getDays();var from_day=config.getFromDay();var to_day=config.getToDay();if((!days||published!==null)&&!nt){var endPw=null;var voidJsData={};var inside_paywall_window=true;if(published){endPw=new Date(published);endPw.setUTCDate(endPw.getUTCDate()+days);inside_paywall_window=(!from_day||published>=from_day)&&(!to_day||published<=to_day)&&(!endPw||now<=endPw);}
if(!inside_paywall_window){st.status="outside_paywall_window";}
logger.log("pass: "+pss);if(!inside_paywall_window)logger.log("outside paywall window");else{logger.log("inside paywall window");if(endPw){logger.log("paywall active until: "+endPw);}else{logger.log("paywall always active");}}
if(inside_paywall_window){st.active=true;if(pss){st.status="subscribed_user";}else if(allowed){st.status="allowed_referrer";}else{var location_href=null;var redirect_to=null;var redirect_counter=null;var increment=[];st.status="free_pageviews";var limit_pageviews=null;var consumed_pageviews=null;var min_diff=null;for(var i=0;i<counters.length;i++){var counter=counters[i];if(!counter.redirect)continue;var value=cookie.getCounterValue(counter);var value_c=value.c;if(value_c===undefined)
value_c=0;if(value.blk===undefined)
value.blk=0;var limit=counter.getLimit();if(limit===undefined)
limit=0;var limit=counter.getLimit();var after_limit=value_c>=limit;logger.log("counter.id: "+counter.id);logger.log("value: "+value_c);logger.log("blocked_value: "+value.blk);logger.log("limit: "+limit);logger.log("counter after_limit: "+after_limit);if(after_limit){value.blk++;actual_blocked=value.blk;cookie.increment_blocked(counter.id);if(redirect_to===null){limit_pageviews=null;consumed_pageviews=null;min_diff=null;st.status="blocked";redirect_to=addParams(counter.redirect,{"backurl":location.href,"counter":counter.id});redirect_counter=counter.id;}}else{var diff=limit-value_c;if(min_diff==null||(diff<min_diff||(diff==min_diff&&limit>limit_pageviews))){consumed_pageviews=value_c;limit_pageviews=limit;min_diff=diff;}
increment.push(counter);}
actual_counter=counter.id;actual_limit=limit;}
if(st.status=="free_pageviews"&&min_diff==null){st.pageviews={consumed:consumed_pageviews,limit:limit_pageviews,remaining:min_diff};}else if(st.status=="blocked"){st.pageviews={blocked:parseInt(value.blk)};}
var cookieVal=cookie.get();if(cookieVal._vf===undefined){cookie.setValidFrom();}
cookie.setValidTo(now);if(redirect_to===null){for(var i=0;i<increment.length;i++){var counter=increment[i];cookie.increment(counter);}
var int_redirect=cookie.getIntermediateRedirect(increment);if(int_redirect){logger.log("intermediate_redirect: "+int_redirect.redirect);location_href=int_redirect.redirect;}}else{logger.log("redirect: "+redirect_to);logger.log("last_blocked: "+redirect_counter);voidJsData["blkdby"]=redirect_counter;cookie.set_last_blocked(redirect_counter);location_href=redirect_to;}
if(location_href&&window.pw_redirect)location_href=window.pw_redirect;var after_tracking=function(){if(location_href&&!DRY_RUN){if(location_href instanceof Function){pw.getStatus(location_href);}else{var body=document.getElementsByTagName("body");if(body.length>0)body[0].innerHTML="";location.replace(location_href);}}}
if(!PW_TRACKING_URL){after_tracking();}else{var params={};if(pw.rule&&pw.rule.id){var param_rule={};param_rule.id=pw.rule.id;if(pw.rule.name)param_rule.name=pw.rule.name;voidJsData["rule"]=param_rule;}
var voidJsData=unescape($.param(voidJsData));if(voidJsData.length>0)params["pagedata"]=voidJsData;$.ajax({url:PW_TRACKING_URL,data:params,dataType:"script",cache:true,success:after_tracking,error:after_tracking});}}}}}
notifyStatus(st);try{kw_tlh_pw()}catch(e){}}
if(window.location.href.indexOf("pwdebugger=true")>0){debugger;}
if(PW_PAGE_URL){var data={};if(window.pw_force_value){data["force_value"]=pw_force_value;}
data=$.param(data).replace(/\+/g,'%20');var loadPW2=function(){var pw2Data={};var published=config.getPublished();if(published){var issue=published.getFullYear();issue+=published.getMonth()>=9?(published.getMonth()+1):"0"+(published.getMonth()+1);issue+=published.getDate()>=10?published.getDate():"0"+published.getDate();pw2Data.issue=issue;}
if(window.pw_data&&window.pw_data.profile&&window.pw_data.profile.name){pw2Data.zona=window.pw_data.profile.name;}else{pw2Data.zona="n";}
console.log("invio questi dati");console.log(pw2Data);if(PW2_COOKIE_NAME){var session=readCookie(PW2_COOKIE_NAME);if(session)pw2Data.cookie=session;}
console.log(JSON.stringify(pw2Data));if(PW_PAGE2_URL&&(!PW2_COOKIE_NAME||(pw2Data.cookie&&pw2Data.zona)))
{console.log("siamo dentro if");console.log(PW_PAGE2_URL);$.ajax({url:PW_PAGE2_URL,data:pw2Data,dataType:'script',cache:true,success:onPw2});}
else pw2_finished=true;};var onPw=function(){if(pw_finished)return;pw_finished=true;console.log("sto per caricare pw2");loadPW2();main();}
var onPw2=function(){pw2_finished=true;console.log("prima di chiamare la main");main();}
var onClusters=function(){clusters_finished=true;main();}
if(!PW_PAGE2_URL)pw2_finished=true;else{PW_PAGE2_URL+=PW_PAGE2_URL.indexOf("?")>=0?"&":"?";PW_PAGE2_URL+="ts="+new Date().getTime();}
var canonical=$('meta[property="og:url"]').last().attr("content");if(!canonical)canonical=$('link[rel="canonical"]').last().attr("href");if(canonical){PW_PAGE_URL+="?deskurl="+canonical;}
$.ajax({url:PW_PAGE_URL,data:data,dataType:'script',cache:true,success:onPw});config.getClusters(onClusters);setTimeout(onPw,5000);}}})();;
(function(){if(window.SSO&&window.SSO.injectFrame)return;if(!window.jQuery||!window.postMessage||!window.JSON){if(window.console)console.error("jquery needed or old browser");return;}
var $=window.jQuery;if(!window.SSO)window.SSO={};var SSO=window.SSO;var SSOConf={};var user=null;var userCallbacks=$({});var userCallbacksPeriodic=$({});var iframeReady=false;var iframe=null;var targetDomain=null;var messagesWaiting=[];var initSSOConf=function(){SSOConf=$.extend(true,SSOConf,window.SSOConf);}
var injectFrame=function(){initSSOConf();if(!SSOConf||!SSOConf.appId)return;targetDomain="https://login.kataweb.it";if(SSOConf.targetDomain){if(SSOConf.targetDomain=="test")targetDomain="https://test-login.kataweb.it";else if(SSOConf.targetDomain!="prod"){targetDomain=SSOConf.targetDomain;}}
var iframe_page=targetDomain+"/login/common/api/sso-frame.jsp";var currentDomain=location.protocol+"//"+location.host;currentDomain=escape(currentDomain);iframe_page+="?c=2&appId="+SSOConf.appId+"&targetDomain="+currentDomain;iframe_page+="&prova6";injectFrame=function(){};iframe=$('<iframe id="sso-frame" name="sso-frame" style="width:0px;height:0px;display:none !important;" src="'+iframe_page+'"></iframe>');console.log("SSO-API.JS:  iframe_page: "+iframe_page);$(document.body).prepend(iframe);}
var sendMessage=function(message){message=JSON.stringify(message);iframe[0].contentWindow.postMessage(message,targetDomain);}
var enqueueMessage=function(message){initSSOConf();if(!message.appId&&SSOConf.appId)message.appId=SSOConf.appId;if(!message.origin&&SSOConf.origin)message.origin=SSOConf.origin;if(!iframeReady){messagesWaiting.push(message);}else{sendMessage(message);}}
var emptyQueue=function(){for(var i=0;i<messagesWaiting.length;i++){var msg1=messagesWaiting[i];sendMessage(msg1);}
messagesWaiting=[];}
var statusChangeCallbacks=[];var lastOp=null;var onMessage=function(e){if(e.originalEvent.origin!=targetDomain)return;var data=null;try{data=JSON.parse(e.originalEvent.data);}catch(e){}
if(data){if(data.op=="init"){iframeReady=true;emptyQueue();}else if(data.op=="statusChange"){data=data.data;console.log("[sso-api] - JSON:"+JSON.stringify(data))
var isSomeoneListening=statusChangeCallbacks.length>0;if(isSomeoneListening){if(data.op=="login"||data.op=="logout"||data.op=="changeuser"){if(document.cookie.indexOf("sso_autologin_done="+data.op)>=0){data.op="sameuser";}else{document.cookie="sso_autologin_done="+data.op;}}else{document.cookie="sso_autologin_done=none; expires="+new Date(0).toString();}}
if(!lastOp||lastOp!=data.op){lastOp=data.op;userCallbacksPeriodic.trigger("SSO.statusChange",data);}
userCallbacks.trigger("SSO.statusChange",data);}else if(data.op=="getSSID"){data=data.data;userCallbacks.trigger("SSO.getSSID",data);}}}
$(window).bind("message",onMessage);SSO.setSiteUser=function(siteUser){enqueueMessage({"op":"setSiteUser","siteUser":siteUser});}
SSO.getSSID=function(appId,cb){if(!cb)return;var origin=appId.origin;if(appId.appId)appId=appId.appId;userCallbacks.one("SSO.getSSID",function(ev,data){try{cb(data);}catch(e){}});enqueueMessage({"op":"getSSID","appId":appId,"origin":origin});}
SSO.onStatusChange=function(cb,one){var ev1="SSO.statusChange";statusChangeCallbacks.push(cb);var f1=function(){cb.apply(SSO,Array.prototype.slice.call(arguments,1));if(one){statusChangeCallbacks.splice(statusChangeCallbacks.indexOf(cb),1);}};if(!one)userCallbacksPeriodic.on(ev1,f1);else userCallbacks.one(ev1,f1);};SSO.checkStatusChange=function(siteUser,cb,dc){if(dc)document.cookie="sso_autologin_done=none; expires="+new Date(0).toString();SSO.onStatusChange(cb,true);SSO.setSiteUser(siteUser);};SSO.quickSetup=function(siteUser,loginUrl,logoutUrl){SSO.checkStatusChange(siteUser,function(data){if(data.op=="logout"){if(logoutUrl){if(typeof logoutUrl==="function"){logoutUrl();}else{window.top.location.replace(logoutUrl);}}}else{var ssid=null;if(data.op=="login"||data.op=="changeuser"){if(data.SSID){if(loginUrl){if(typeof loginUrl==="function"){loginUrl(data.SSID);}else{loginUrl+=loginUrl.indexOf("?")<0?"?":"&";loginUrl+="SSID="+encodeURIComponent(data.SSID);window.top.location.replace(loginUrl);}}}}}});};SSO.injectFrame=function(){injectFrame()};})();;
/*
 * Shadowbox.js, version 3.0.3
 * http://shadowbox-js.com/
 *
 * Copyright 2007-2010, Michael J. I. Jackson
 * Date: 2011-02-24 10:14:14 +0000
 */
(function(T,p){var g={version:"3.0.3"};var Y=navigator.userAgent.toLowerCase();if(Y.indexOf("windows")>-1||Y.indexOf("win32")>-1){g.isWindows=true}else{if(Y.indexOf("macintosh")>-1||Y.indexOf("mac os x")>-1){g.isMac=true}else{if(Y.indexOf("linux")>-1){g.isLinux=true}}}
g.isIE=Y.indexOf("msie")>-1;g.isIE6=Y.indexOf("msie 6")>-1;g.isIE7=Y.indexOf("msie 7")>-1;g.isGecko=Y.indexOf("gecko")>-1&&Y.indexOf("safari")==-1;g.isWebKit=Y.indexOf("applewebkit/")>-1;var e=/#(.+)$/,M=/^(light|shadow)box\[(.*?)\]/i,o=/\s*([a-z_]*?)\s*=\s*(.+)\s*/,ar=/[0-9a-z]+$/i,ap=/(.+\/)shadowbox\.js/i;var w=false,m=false,V={},ai=0,O,aa;g.current=-1;g.dimensions=null;g.ease=function(K){return 1+Math.pow(K-1,3)};g.errorInfo={fla:{name:"Flash",url:"http://www.adobe.com/products/flashplayer/"},qt:{name:"QuickTime",url:"http://www.apple.com/quicktime/download/"},wmp:{name:"Windows Media Player",url:"http://www.microsoft.com/windows/windowsmedia/"},f4m:{name:"Flip4Mac",url:"http://www.flip4mac.com/wmv_download.htm"}};g.gallery=[];g.onReady=aj;g.path=null;g.player=null;g.playerId="sb-player";g.options={animate:true,animateFade:true,autoplayMovies:true,continuous:false,enableKeys:true,flashParams:{bgcolor:"#000000",allowfullscreen:true},flashVars:{},flashVersion:"9.0.115",handleOversize:"resize",handleUnsupported:"link",onChange:aj,onClose:aj,onFinish:aj,onOpen:aj,showMovieControls:true,skipSetup:false,slideshowDelay:0,viewportPadding:20};g.getCurrent=function(){return g.current>-1?g.gallery[g.current]:null};g.hasNext=function(){return g.gallery.length>1&&(g.current!=g.gallery.length-1||g.options.continuous)};g.isOpen=function(){return w};g.isPaused=function(){return aa=="pause"};g.applyOptions=function(K){V=ao({},g.options);ao(g.options,K)};g.revertOptions=function(){ao(g.options,V)};g.init=function(au,ax){if(m){return}
m=true;if(g.skin.options){ao(g.options,g.skin.options)}
if(au){ao(g.options,au)}
if(!g.path){var aw,S=document.getElementsByTagName("script");for(var av=0,K=S.length;av<K;++av){aw=ap.exec(S[av].src);if(aw){g.path=aw[1];break}}}
if(ax){g.onReady=ax}
aq()};g.open=function(S){if(w){return}
var K=g.makeGallery(S);g.gallery=K[0];g.current=K[1];S=g.getCurrent();if(S==null){return}
g.applyOptions(S.options||{});f();if(g.gallery.length){S=g.getCurrent();if(g.options.onOpen(S)===false){return}
w=true;g.skin.onOpen(S,U)}};g.close=function(){if(!w){return}
w=false;if(g.player){g.player.remove();g.player=null}
if(typeof aa=="number"){clearTimeout(aa);aa=null}
ai=0;af(false);g.options.onClose(g.getCurrent());g.skin.onClose();g.revertOptions()};g.play=function(){if(!g.hasNext()){return}
if(!ai){ai=g.options.slideshowDelay*1000}
if(ai){O=X();aa=setTimeout(function(){ai=O=0;g.next()},ai);if(g.skin.onPlay){g.skin.onPlay()}}};g.pause=function(){if(typeof aa!="number"){return}
ai=Math.max(0,ai-(X()-O));if(ai){clearTimeout(aa);aa="pause";if(g.skin.onPause){g.skin.onPause()}}};g.change=function(K){if(!(K in g.gallery)){if(g.options.continuous){K=(K<0?g.gallery.length+K:0);if(!(K in g.gallery)){return}}else{return}}
g.current=K;if(typeof aa=="number"){clearTimeout(aa);aa=null;ai=O=0}
g.options.onChange(g.getCurrent());U(true)};g.next=function(){g.change(g.current+1)};g.previous=function(){g.change(g.current-1)};g.setDimensions=function(aG,ax,aE,aF,aw,K,aC,az){var aB=aG,av=ax;var aA=2*aC+aw;if(aG+aA>aE){aG=aE-aA}
var au=2*aC+K;if(ax+au>aF){ax=aF-au}
var S=(aB-aG)/aB,aD=(av-ax)/av,ay=(S>0||aD>0);if(az&&ay){if(S>aD){ax=Math.round((av/aB)*aG)}else{if(aD>S){aG=Math.round((aB/av)*ax)}}}
g.dimensions={height:aG+aw,width:ax+K,innerHeight:aG,innerWidth:ax,top:Math.floor((aE-(aG+aA))/2+aC),left:Math.floor((aF-(ax+au))/2+aC),oversized:ay};return g.dimensions};g.makeGallery=function(aw){var K=[],av=-1;if(typeof aw=="string"){aw=[aw]}
if(typeof aw.length=="number"){ac(aw,function(ay,az){if(az.content){K[ay]=az}else{K[ay]={content:az}}});av=0}else{if(aw.tagName){var S=g.getCache(aw);aw=S?S:g.makeObject(aw)}
if(aw.gallery){K=[];var ax;for(var au in g.cache){ax=g.cache[au];if(ax.gallery&&ax.gallery==aw.gallery){if(av==-1&&ax.content==aw.content){av=K.length}
K.push(ax)}}
if(av==-1){K.unshift(aw);av=0}}else{K=[aw];av=0}}
ac(K,function(ay,az){K[ay]=ao({},az)});return[K,av]};g.makeObject=function(av,au){var aw={content:av.href,title:av.getAttribute("title")||"",link:av};if(au){au=ao({},au);ac(["player","title","height","width","gallery"],function(ax,ay){if(typeof au[ay]!="undefined"){aw[ay]=au[ay];delete au[ay]}});aw.options=au}else{aw.options={}}
if(!aw.player){aw.player=g.getPlayer(aw.content)}
var K=av.getAttribute("rel");if(K){var S=K.match(M);if(S){aw.gallery=escape(S[2])}
ac(K.split(";"),function(ax,ay){S=ay.match(o);if(S){aw[S[1]]=S[2]}})}
return aw};g.getPlayer=function(au){if(au.indexOf("#")>-1&&au.indexOf(document.location.href)==0){return"inline"}
var av=au.indexOf("?");if(av>-1){au=au.substring(0,av)}
var S,K=au.match(ar);if(K){S=K[0].toLowerCase()}
if(S){if(g.img&&g.img.ext.indexOf(S)>-1){return"img"}
if(g.swf&&g.swf.ext.indexOf(S)>-1){return"swf"}
if(g.flv&&g.flv.ext.indexOf(S)>-1){return"flv"}
if(g.qt&&g.qt.ext.indexOf(S)>-1){if(g.wmp&&g.wmp.ext.indexOf(S)>-1){return"qtwmp"}else{return"qt"}}
if(g.wmp&&g.wmp.ext.indexOf(S)>-1){return"wmp"}}
return"iframe"};function f(){var av=g.errorInfo,aw=g.plugins,ay,az,aC,au,aB,S,aA,K;for(var ax=0;ax<g.gallery.length;++ax){ay=g.gallery[ax];az=false;aC=null;switch(ay.player){case"flv":case"swf":if(!aw.fla){aC="fla"}
break;case"qt":if(!aw.qt){aC="qt"}
break;case"wmp":if(g.isMac){if(aw.qt&&aw.f4m){ay.player="qt"}else{aC="qtf4m"}}else{if(!aw.wmp){aC="wmp"}}
break;case"qtwmp":if(aw.qt){ay.player="qt"}else{if(aw.wmp){ay.player="wmp"}else{aC="qtwmp"}}
break}
if(aC){if(g.options.handleUnsupported=="link"){switch(aC){case"qtf4m":aB="shared";S=[av.qt.url,av.qt.name,av.f4m.url,av.f4m.name];break;case"qtwmp":aB="either";S=[av.qt.url,av.qt.name,av.wmp.url,av.wmp.name];break;default:aB="single";S=[av[aC].url,av[aC].name]}
ay.player="html";ay.content='<div class="sb-message">'+s(g.lang.errors[aB],S)+"</div>"}else{az=true}}else{if(ay.player=="inline"){au=e.exec(ay.content);if(au){aA=ag(au[1]);if(aA){ay.content=aA.innerHTML}else{az=true}}else{az=true}}else{if(ay.player=="swf"||ay.player=="flv"){K=(ay.options&&ay.options.flashVersion)||g.options.flashVersion;if(g.flash&&!g.flash.hasFlashPlayerVersion(K)){ay.width=310;ay.height=177}}}}
if(az){g.gallery.splice(ax,1);if(ax<g.current){--g.current}else{if(ax==g.current){g.current=ax>0?ax-1:ax}}--ax}}}
function af(K){if(!g.options.enableKeys){return}(K?j:a)(document,"keydown",W)}
function W(au){if(au.metaKey||au.shiftKey||au.altKey||au.ctrlKey){return}
var S=l(au),K;switch(S){case 81:case 88:case 27:K=g.close;break;case 37:K=g.previous;break;case 39:K=g.next;break;case 32:K=typeof aa=="number"?g.pause:g.play;break}
if(K){G(au);K()}}
function U(ay){af(false);var ax=g.getCurrent();var au=(ax.player=="inline"?"html":ax.player);if(typeof g[au]!="function"){throw"unknown player "+au}
if(ay){g.player.remove();g.revertOptions();g.applyOptions(ax.options||{})}
g.player=new g[au](ax,g.playerId);if(g.gallery.length>1){var av=g.gallery[g.current+1]||g.gallery[0];if(av.player=="img"){var S=new Image();S.src=av.content}
var aw=g.gallery[g.current-1]||g.gallery[g.gallery.length-1];if(aw.player=="img"){var K=new Image();K.src=aw.content}}
g.skin.onLoad(ay,r)}
function r(){if(!w){return}
if(typeof g.player.ready!="undefined"){var K=setInterval(function(){if(w){if(g.player.ready){clearInterval(K);K=null;g.skin.onReady(J)}}else{clearInterval(K);K=null}},10)}else{g.skin.onReady(J)}}
function J(){if(!w){return}
g.player.append(g.skin.body,g.dimensions);g.skin.onShow(q)}
function q(){if(!w){return}
if(g.player.onLoad){g.player.onLoad()}
g.options.onFinish(g.getCurrent());if(!g.isPaused()){g.play()}
af(true)}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(S,au){var K=this.length>>>0;au=au||0;if(au<0){au+=K}
for(;au<K;++au){if(au in this&&this[au]===S){return au}}
return-1}}
function X(){return(new Date).getTime()}
function ao(K,au){for(var S in au){K[S]=au[S]}
return K}
function ac(av,aw){var S=0,K=av.length;for(var au=av[0];S<K&&aw.call(au,S,au)!==false;au=av[++S]){}}
function s(S,K){return S.replace(/\{(\w+?)\}/g,function(au,av){return K[av]})}
function aj(){}
function ag(K){return document.getElementById(K)}
function z(K){K.parentNode.removeChild(K)}
var ak=true,L=true;function an(){var K=document.body,S=document.createElement("div");ak=typeof S.style.opacity==="string";S.style.position="fixed";S.style.margin=0;S.style.top="20px";K.appendChild(S,K.firstChild);L=S.offsetTop==20;K.removeChild(S)}
g.getStyle=(function(){var K=/opacity=([^)]*)/,S=document.defaultView&&document.defaultView.getComputedStyle;return function(ax,aw){var av;if(!ak&&aw=="opacity"&&ax.currentStyle){av=K.test(ax.currentStyle.filter||"")?(parseFloat(RegExp.$1)/100)+"":"";return av===""?"1":av}
if(S){var au=S(ax,null);if(au){av=au[aw]}
if(aw=="opacity"&&av==""){av="1"}}else{av=ax.currentStyle[aw]}
return av}})();g.appendHTML=function(au,S){if(au.insertAdjacentHTML){au.insertAdjacentHTML("BeforeEnd",S)}else{if(au.lastChild){var K=au.ownerDocument.createRange();K.setStartAfter(au.lastChild);var av=K.createContextualFragment(S);au.appendChild(av)}else{au.innerHTML=S}}};g.getWindowSize=function(K){if(document.compatMode==="CSS1Compat"){return document.documentElement["client"+K]}
return document.body["client"+K]};g.setOpacity=function(au,K){var S=au.style;if(ak){S.opacity=(K==1?"":K)}else{S.zoom=1;if(K==1){if(typeof S.filter=="string"&&(/alpha/i).test(S.filter)){S.filter=S.filter.replace(/\s*[\w\.]*alpha\([^\)]*\);?/gi,"")}}else{S.filter=(S.filter||"").replace(/\s*[\w\.]*alpha\([^\)]*\)/gi,"")+" alpha(opacity="+(K*100)+")"}}};g.clearOpacity=function(K){g.setOpacity(K,1)};function C(K){return K.target}
function Q(K){return[K.pageX,K.pageY]}
function G(K){K.preventDefault()}
function l(K){return K.keyCode}
function j(au,S,K){jQuery(au).bind(S,K)}
function a(au,S,K){jQuery(au).unbind(S,K)}
jQuery.fn.shadowbox=function(K){return this.each(function(){var au=jQuery(this);var av=jQuery.extend({},K||{},jQuery.metadata?au.metadata():jQuery.meta?au.data():{});var S=this.className||"";av.width=parseInt((S.match(/w:(\d+)/)||[])[1])||av.width;av.height=parseInt((S.match(/h:(\d+)/)||[])[1])||av.height;Shadowbox.setup(au,av)})};var D=false,N;if(document.addEventListener){N=function(){document.removeEventListener("DOMContentLoaded",N,false);g.load()}}else{if(document.attachEvent){N=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",N);g.load()}}}}
function i(){if(D){return}
try{document.documentElement.doScroll("left")}catch(K){setTimeout(i,1);return}
g.load()}
function aq(){if(document.readyState==="complete"){return g.load()}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",N,false);T.addEventListener("load",g.load,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",N);T.attachEvent("onload",g.load);var K=false;try{K=T.frameElement===null}catch(S){}
if(document.documentElement.doScroll&&K){i()}}}}
g.load=function(){if(D){return}
if(!document.body){return setTimeout(g.load,13)}
D=true;an();g.onReady();if(!g.options.skipSetup){g.setup()}
g.skin.init()};g.plugins={};if(navigator.plugins&&navigator.plugins.length){var am=[];ac(navigator.plugins,function(K,S){am.push(S.name)});am=am.join(",");var d=am.indexOf("Flip4Mac")>-1;g.plugins={fla:am.indexOf("Shockwave Flash")>-1,qt:am.indexOf("QuickTime")>-1,wmp:!d&&am.indexOf("Windows Media")>-1,f4m:d}}else{var B=function(K){var S;try{S=new ActiveXObject(K)}catch(au){}
return!!S};g.plugins={fla:B("ShockwaveFlash.ShockwaveFlash"),qt:B("QuickTime.QuickTime"),wmp:B("wmplayer.ocx"),f4m:false}}
var c=/^(light|shadow)box/i,Z="shadowboxCacheKey",h=1;g.cache={};g.select=function(S){var au=[];if(!S){var K;ac(document.getElementsByTagName("a"),function(ax,ay){K=ay.getAttribute("rel");if(K&&c.test(K)){au.push(ay)}})}else{var aw=S.length;if(aw){if(typeof S=="string"){if(g.find){au=g.find(S)}}else{if(aw==2&&typeof S[0]=="string"&&S[1].nodeType){if(g.find){au=g.find(S[0],S[1])}}else{for(var av=0;av<aw;++av){au[av]=S[av]}}}}else{au.push(S)}}
return au};g.setup=function(K,S){ac(g.select(K),function(au,av){g.addCache(av,S)})};g.teardown=function(K){ac(g.select(K),function(S,au){g.removeCache(au)})};g.addCache=function(au,K){var S=au[Z];if(S==p){S=h++;au[Z]=S;j(au,"click",b)}
g.cache[S]=g.makeObject(au,K)};g.removeCache=function(K){a(K,"click",b);delete g.cache[K[Z]];K[Z]=null};g.getCache=function(S){var K=S[Z];return(K in g.cache&&g.cache[K])};g.clearCache=function(){for(var K in g.cache){g.removeCache(g.cache[K].link)}
g.cache={}};function b(K){g.open(this);if(g.gallery.length){G(K)}}

/*
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 *
 * Modified for inclusion in Shadowbox.js
 */
g.find=(function(){var aD=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,aE=0,aG=Object.prototype.toString,ay=false,ax=true;[0,0].sort(function(){ax=false;return 0});var au=function(aP,aK,aS,aT){aS=aS||[];var aV=aK=aK||document;if(aK.nodeType!==1&&aK.nodeType!==9){return[]}
if(!aP||typeof aP!=="string"){return aS}
var aQ=[],aM,aX,a0,aL,aO=true,aN=av(aK),aU=aP;while((aD.exec(""),aM=aD.exec(aU))!==null){aU=aM[3];aQ.push(aM[1]);if(aM[2]){aL=aM[3];break}}
if(aQ.length>1&&az.exec(aP)){if(aQ.length===2&&aA.relative[aQ[0]]){aX=aH(aQ[0]+aQ[1],aK)}else{aX=aA.relative[aQ[0]]?[aK]:au(aQ.shift(),aK);while(aQ.length){aP=aQ.shift();if(aA.relative[aP]){aP+=aQ.shift()}
aX=aH(aP,aX)}}}else{if(!aT&&aQ.length>1&&aK.nodeType===9&&!aN&&aA.match.ID.test(aQ[0])&&!aA.match.ID.test(aQ[aQ.length-1])){var aW=au.find(aQ.shift(),aK,aN);aK=aW.expr?au.filter(aW.expr,aW.set)[0]:aW.set[0]}
if(aK){var aW=aT?{expr:aQ.pop(),set:aC(aT)}:au.find(aQ.pop(),aQ.length===1&&(aQ[0]==="~"||aQ[0]==="+")&&aK.parentNode?aK.parentNode:aK,aN);aX=aW.expr?au.filter(aW.expr,aW.set):aW.set;if(aQ.length>0){a0=aC(aX)}else{aO=false}
while(aQ.length){var aZ=aQ.pop(),aY=aZ;if(!aA.relative[aZ]){aZ=""}else{aY=aQ.pop()}
if(aY==null){aY=aK}
aA.relative[aZ](a0,aY,aN)}}else{a0=aQ=[]}}
if(!a0){a0=aX}
if(!a0){throw"Syntax error, unrecognized expression: "+(aZ||aP)}
if(aG.call(a0)==="[object Array]"){if(!aO){aS.push.apply(aS,a0)}else{if(aK&&aK.nodeType===1){for(var aR=0;a0[aR]!=null;aR++){if(a0[aR]&&(a0[aR]===true||a0[aR].nodeType===1&&aB(aK,a0[aR]))){aS.push(aX[aR])}}}else{for(var aR=0;a0[aR]!=null;aR++){if(a0[aR]&&a0[aR].nodeType===1){aS.push(aX[aR])}}}}}else{aC(a0,aS)}
if(aL){au(aL,aV,aS,aT);au.uniqueSort(aS)}
return aS};au.uniqueSort=function(aL){if(aF){ay=ax;aL.sort(aF);if(ay){for(var aK=1;aK<aL.length;aK++){if(aL[aK]===aL[aK-1]){aL.splice(aK--,1)}}}}
return aL};au.matches=function(aK,aL){return au(aK,null,null,aL)};au.find=function(aR,aK,aS){var aQ,aO;if(!aR){return[]}
for(var aN=0,aM=aA.order.length;aN<aM;aN++){var aP=aA.order[aN],aO;if((aO=aA.leftMatch[aP].exec(aR))){var aL=aO[1];aO.splice(1,1);if(aL.substr(aL.length-1)!=="\\"){aO[1]=(aO[1]||"").replace(/\\/g,"");aQ=aA.find[aP](aO,aK,aS);if(aQ!=null){aR=aR.replace(aA.match[aP],"");break}}}}
if(!aQ){aQ=aK.getElementsByTagName("*")}
return{set:aQ,expr:aR}};au.filter=function(aU,aT,aX,aN){var aM=aU,aZ=[],aR=aT,aP,aK,aQ=aT&&aT[0]&&av(aT[0]);while(aU&&aT.length){for(var aS in aA.filter){if((aP=aA.match[aS].exec(aU))!=null){var aL=aA.filter[aS],aY,aW;aK=false;if(aR===aZ){aZ=[]}
if(aA.preFilter[aS]){aP=aA.preFilter[aS](aP,aR,aX,aZ,aN,aQ);if(!aP){aK=aY=true}else{if(aP===true){continue}}}
if(aP){for(var aO=0;(aW=aR[aO])!=null;aO++){if(aW){aY=aL(aW,aP,aO,aR);var aV=aN^!!aY;if(aX&&aY!=null){if(aV){aK=true}else{aR[aO]=false}}else{if(aV){aZ.push(aW);aK=true}}}}}
if(aY!==p){if(!aX){aR=aZ}
aU=aU.replace(aA.match[aS],"");if(!aK){return[]}
break}}}
if(aU===aM){if(aK==null){throw"Syntax error, unrecognized expression: "+aU}else{break}}
aM=aU}
return aR};var aA=au.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(aK){return aK.getAttribute("href")}},relative:{"+":function(aQ,aL){var aN=typeof aL==="string",aP=aN&&!/\W/.test(aL),aR=aN&&!aP;if(aP){aL=aL.toLowerCase()}
for(var aM=0,aK=aQ.length,aO;aM<aK;aM++){if((aO=aQ[aM])){while((aO=aO.previousSibling)&&aO.nodeType!==1){}
aQ[aM]=aR||aO&&aO.nodeName.toLowerCase()===aL?aO||false:aO===aL}}
if(aR){au.filter(aL,aQ,true)}},">":function(aQ,aL){var aO=typeof aL==="string";if(aO&&!/\W/.test(aL)){aL=aL.toLowerCase();for(var aM=0,aK=aQ.length;aM<aK;aM++){var aP=aQ[aM];if(aP){var aN=aP.parentNode;aQ[aM]=aN.nodeName.toLowerCase()===aL?aN:false}}}else{for(var aM=0,aK=aQ.length;aM<aK;aM++){var aP=aQ[aM];if(aP){aQ[aM]=aO?aP.parentNode:aP.parentNode===aL}}
if(aO){au.filter(aL,aQ,true)}}},"":function(aN,aL,aP){var aM=aE++,aK=aI;if(typeof aL==="string"&&!/\W/.test(aL)){var aO=aL=aL.toLowerCase();aK=K}
aK("parentNode",aL,aM,aN,aO,aP)},"~":function(aN,aL,aP){var aM=aE++,aK=aI;if(typeof aL==="string"&&!/\W/.test(aL)){var aO=aL=aL.toLowerCase();aK=K}
aK("previousSibling",aL,aM,aN,aO,aP)}},find:{ID:function(aL,aM,aN){if(typeof aM.getElementById!=="undefined"&&!aN){var aK=aM.getElementById(aL[1]);return aK?[aK]:[]}},NAME:function(aM,aP){if(typeof aP.getElementsByName!=="undefined"){var aL=[],aO=aP.getElementsByName(aM[1]);for(var aN=0,aK=aO.length;aN<aK;aN++){if(aO[aN].getAttribute("name")===aM[1]){aL.push(aO[aN])}}
return aL.length===0?null:aL}},TAG:function(aK,aL){return aL.getElementsByTagName(aK[1])}},preFilter:{CLASS:function(aN,aL,aM,aK,aQ,aR){aN=" "+aN[1].replace(/\\/g,"")+" ";if(aR){return aN}
for(var aO=0,aP;(aP=aL[aO])!=null;aO++){if(aP){if(aQ^(aP.className&&(" "+aP.className+" ").replace(/[\t\n]/g," ").indexOf(aN)>=0)){if(!aM){aK.push(aP)}}else{if(aM){aL[aO]=false}}}}
return false},ID:function(aK){return aK[1].replace(/\\/g,"")},TAG:function(aL,aK){return aL[1].toLowerCase()},CHILD:function(aK){if(aK[1]==="nth"){var aL=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(aK[2]==="even"&&"2n"||aK[2]==="odd"&&"2n+1"||!/\D/.test(aK[2])&&"0n+"+aK[2]||aK[2]);aK[2]=(aL[1]+(aL[2]||1))-0;aK[3]=aL[3]-0}
aK[0]=aE++;return aK},ATTR:function(aO,aL,aM,aK,aP,aQ){var aN=aO[1].replace(/\\/g,"");if(!aQ&&aA.attrMap[aN]){aO[1]=aA.attrMap[aN]}
if(aO[2]==="~="){aO[4]=" "+aO[4]+" "}
return aO},PSEUDO:function(aO,aL,aM,aK,aP){if(aO[1]==="not"){if((aD.exec(aO[3])||"").length>1||/^\w/.test(aO[3])){aO[3]=au(aO[3],null,null,aL)}else{var aN=au.filter(aO[3],aL,aM,true^aP);if(!aM){aK.push.apply(aK,aN)}
return false}}else{if(aA.match.POS.test(aO[0])||aA.match.CHILD.test(aO[0])){return true}}
return aO},POS:function(aK){aK.unshift(true);return aK}},filters:{enabled:function(aK){return aK.disabled===false&&aK.type!=="hidden"},disabled:function(aK){return aK.disabled===true},checked:function(aK){return aK.checked===true},selected:function(aK){aK.parentNode.selectedIndex;return aK.selected===true},parent:function(aK){return!!aK.firstChild},empty:function(aK){return!aK.firstChild},has:function(aM,aL,aK){return!!au(aK[3],aM).length},header:function(aK){return/h\d/i.test(aK.nodeName)},text:function(aK){return"text"===aK.type},radio:function(aK){return"radio"===aK.type},checkbox:function(aK){return"checkbox"===aK.type},file:function(aK){return"file"===aK.type},password:function(aK){return"password"===aK.type},submit:function(aK){return"submit"===aK.type},image:function(aK){return"image"===aK.type},reset:function(aK){return"reset"===aK.type},button:function(aK){return"button"===aK.type||aK.nodeName.toLowerCase()==="button"},input:function(aK){return/input|select|textarea|button/i.test(aK.nodeName)}},setFilters:{first:function(aL,aK){return aK===0},last:function(aM,aL,aK,aN){return aL===aN.length-1},even:function(aL,aK){return aK%2===0},odd:function(aL,aK){return aK%2===1},lt:function(aM,aL,aK){return aL<aK[3]-0},gt:function(aM,aL,aK){return aL>aK[3]-0},nth:function(aM,aL,aK){return aK[3]-0===aL},eq:function(aM,aL,aK){return aK[3]-0===aL}},filter:{PSEUDO:function(aQ,aM,aN,aR){var aL=aM[1],aO=aA.filters[aL];if(aO){return aO(aQ,aN,aM,aR)}else{if(aL==="contains"){return(aQ.textContent||aQ.innerText||S([aQ])||"").indexOf(aM[3])>=0}else{if(aL==="not"){var aP=aM[3];for(var aN=0,aK=aP.length;aN<aK;aN++){if(aP[aN]===aQ){return false}}
return true}else{throw"Syntax error, unrecognized expression: "+aL}}}},CHILD:function(aK,aN){var aQ=aN[1],aL=aK;switch(aQ){case"only":case"first":while((aL=aL.previousSibling)){if(aL.nodeType===1){return false}}
if(aQ==="first"){return true}
aL=aK;case"last":while((aL=aL.nextSibling)){if(aL.nodeType===1){return false}}
return true;case"nth":var aM=aN[2],aT=aN[3];if(aM===1&&aT===0){return true}
var aP=aN[0],aS=aK.parentNode;if(aS&&(aS.sizcache!==aP||!aK.nodeIndex)){var aO=0;for(aL=aS.firstChild;aL;aL=aL.nextSibling){if(aL.nodeType===1){aL.nodeIndex=++aO}}
aS.sizcache=aP}
var aR=aK.nodeIndex-aT;if(aM===0){return aR===0}else{return(aR%aM===0&&aR/aM>=0)}}},ID:function(aL,aK){return aL.nodeType===1&&aL.getAttribute("id")===aK},TAG:function(aL,aK){return(aK==="*"&&aL.nodeType===1)||aL.nodeName.toLowerCase()===aK},CLASS:function(aL,aK){return(" "+(aL.className||aL.getAttribute("class"))+" ").indexOf(aK)>-1},ATTR:function(aP,aN){var aM=aN[1],aK=aA.attrHandle[aM]?aA.attrHandle[aM](aP):aP[aM]!=null?aP[aM]:aP.getAttribute(aM),aQ=aK+"",aO=aN[2],aL=aN[4];return aK==null?aO==="!=":aO==="="?aQ===aL:aO==="*="?aQ.indexOf(aL)>=0:aO==="~="?(" "+aQ+" ").indexOf(aL)>=0:!aL?aQ&&aK!==false:aO==="!="?aQ!==aL:aO==="^="?aQ.indexOf(aL)===0:aO==="$="?aQ.substr(aQ.length-aL.length)===aL:aO==="|="?aQ===aL||aQ.substr(0,aL.length+1)===aL+"-":false},POS:function(aO,aL,aM,aP){var aK=aL[2],aN=aA.setFilters[aK];if(aN){return aN(aO,aM,aL,aP)}}}};var az=aA.match.POS;for(var aw in aA.match){aA.match[aw]=new RegExp(aA.match[aw].source+/(?![^\[]*\])(?![^\(]*\))/.source);aA.leftMatch[aw]=new RegExp(/(^(?:.|\r|\n)*?)/.source+aA.match[aw].source)}
var aC=function(aL,aK){aL=Array.prototype.slice.call(aL,0);if(aK){aK.push.apply(aK,aL);return aK}
return aL};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(aJ){aC=function(aO,aN){var aL=aN||[];if(aG.call(aO)==="[object Array]"){Array.prototype.push.apply(aL,aO)}else{if(typeof aO.length==="number"){for(var aM=0,aK=aO.length;aM<aK;aM++){aL.push(aO[aM])}}else{for(var aM=0;aO[aM];aM++){aL.push(aO[aM])}}}
return aL}}
var aF;if(document.documentElement.compareDocumentPosition){aF=function(aL,aK){if(!aL.compareDocumentPosition||!aK.compareDocumentPosition){if(aL==aK){ay=true}
return aL.compareDocumentPosition?-1:1}
var aM=aL.compareDocumentPosition(aK)&4?-1:aL===aK?0:1;if(aM===0){ay=true}
return aM}}else{if("sourceIndex"in document.documentElement){aF=function(aL,aK){if(!aL.sourceIndex||!aK.sourceIndex){if(aL==aK){ay=true}
return aL.sourceIndex?-1:1}
var aM=aL.sourceIndex-aK.sourceIndex;if(aM===0){ay=true}
return aM}}else{if(document.createRange){aF=function(aN,aL){if(!aN.ownerDocument||!aL.ownerDocument){if(aN==aL){ay=true}
return aN.ownerDocument?-1:1}
var aM=aN.ownerDocument.createRange(),aK=aL.ownerDocument.createRange();aM.setStart(aN,0);aM.setEnd(aN,0);aK.setStart(aL,0);aK.setEnd(aL,0);var aO=aM.compareBoundaryPoints(Range.START_TO_END,aK);if(aO===0){ay=true}
return aO}}}}
function S(aK){var aL="",aN;for(var aM=0;aK[aM];aM++){aN=aK[aM];if(aN.nodeType===3||aN.nodeType===4){aL+=aN.nodeValue}else{if(aN.nodeType!==8){aL+=S(aN.childNodes)}}}
return aL}(function(){var aL=document.createElement("div"),aM="script"+(new Date).getTime();aL.innerHTML="<a name='"+aM+"'/>";var aK=document.documentElement;aK.insertBefore(aL,aK.firstChild);if(document.getElementById(aM)){aA.find.ID=function(aO,aP,aQ){if(typeof aP.getElementById!=="undefined"&&!aQ){var aN=aP.getElementById(aO[1]);return aN?aN.id===aO[1]||typeof aN.getAttributeNode!=="undefined"&&aN.getAttributeNode("id").nodeValue===aO[1]?[aN]:p:[]}};aA.filter.ID=function(aP,aN){var aO=typeof aP.getAttributeNode!=="undefined"&&aP.getAttributeNode("id");return aP.nodeType===1&&aO&&aO.nodeValue===aN}}
aK.removeChild(aL);aK=aL=null})();(function(){var aK=document.createElement("div");aK.appendChild(document.createComment(""));if(aK.getElementsByTagName("*").length>0){aA.find.TAG=function(aL,aP){var aO=aP.getElementsByTagName(aL[1]);if(aL[1]==="*"){var aN=[];for(var aM=0;aO[aM];aM++){if(aO[aM].nodeType===1){aN.push(aO[aM])}}
aO=aN}
return aO}}
aK.innerHTML="<a href='#'></a>";if(aK.firstChild&&typeof aK.firstChild.getAttribute!=="undefined"&&aK.firstChild.getAttribute("href")!=="#"){aA.attrHandle.href=function(aL){return aL.getAttribute("href",2)}}
aK=null})();if(document.querySelectorAll){(function(){var aK=au,aM=document.createElement("div");aM.innerHTML="<p class='TEST'></p>";if(aM.querySelectorAll&&aM.querySelectorAll(".TEST").length===0){return}
au=function(aQ,aP,aN,aO){aP=aP||document;if(!aO&&aP.nodeType===9&&!av(aP)){try{return aC(aP.querySelectorAll(aQ),aN)}catch(aR){}}
return aK(aQ,aP,aN,aO)};for(var aL in aK){au[aL]=aK[aL]}
aM=null})()}(function(){var aK=document.createElement("div");aK.innerHTML="<div class='test e'></div><div class='test'></div>";if(!aK.getElementsByClassName||aK.getElementsByClassName("e").length===0){return}
aK.lastChild.className="e";if(aK.getElementsByClassName("e").length===1){return}
aA.order.splice(1,0,"CLASS");aA.find.CLASS=function(aL,aM,aN){if(typeof aM.getElementsByClassName!=="undefined"&&!aN){return aM.getElementsByClassName(aL[1])}};aK=null})();function K(aL,aQ,aP,aT,aR,aS){for(var aN=0,aM=aT.length;aN<aM;aN++){var aK=aT[aN];if(aK){aK=aK[aL];var aO=false;while(aK){if(aK.sizcache===aP){aO=aT[aK.sizset];break}
if(aK.nodeType===1&&!aS){aK.sizcache=aP;aK.sizset=aN}
if(aK.nodeName.toLowerCase()===aQ){aO=aK;break}
aK=aK[aL]}
aT[aN]=aO}}}
function aI(aL,aQ,aP,aT,aR,aS){for(var aN=0,aM=aT.length;aN<aM;aN++){var aK=aT[aN];if(aK){aK=aK[aL];var aO=false;while(aK){if(aK.sizcache===aP){aO=aT[aK.sizset];break}
if(aK.nodeType===1){if(!aS){aK.sizcache=aP;aK.sizset=aN}
if(typeof aQ!=="string"){if(aK===aQ){aO=true;break}}else{if(au.filter(aQ,[aK]).length>0){aO=aK;break}}}
aK=aK[aL]}
aT[aN]=aO}}}
var aB=document.compareDocumentPosition?function(aL,aK){return aL.compareDocumentPosition(aK)&16}:function(aL,aK){return aL!==aK&&(aL.contains?aL.contains(aK):true)};var av=function(aK){var aL=(aK?aK.ownerDocument||aK:0).documentElement;return aL?aL.nodeName!=="HTML":false};var aH=function(aK,aR){var aN=[],aO="",aP,aM=aR.nodeType?[aR]:aR;while((aP=aA.match.PSEUDO.exec(aK))){aO+=aP[0];aK=aK.replace(aA.match.PSEUDO,"")}
aK=aA.relative[aK]?aK+"*":aK;for(var aQ=0,aL=aM.length;aQ<aL;aQ++){au(aK,aM[aQ],aN)}
return au.filter(aO,aN)};return au})();g.lang={code:"en",of:"of",loading:"loading",cancel:"Cancel",next:"Next",previous:"Previous",play:"Play",pause:"Pause",close:"Close",errors:{single:'You must install the <a href="{0}">{1}</a> browser plugin to view this content.',shared:'You must install both the <a href="{0}">{1}</a> and <a href="{2}">{3}</a> browser plugins to view this content.',either:'You must install either the <a href="{0}">{1}</a> or the <a href="{2}">{3}</a> browser plugin to view this content.'}};g.iframe=function(S,au){this.obj=S;this.id=au;var K=ag("sb-overlay");this.height=S.height?parseInt(S.height,10):K.offsetHeight;this.width=S.width?parseInt(S.width,10):K.offsetWidth};g.iframe.prototype={append:function(K,au){var S='<iframe id="'+this.id+'" name="'+this.id+'" height="100%" width="100%" frameborder="0" marginwidth="0" marginheight="0" style="visibility:hidden" onload="this.style.visibility=\'visible\'" scrolling="auto"';if(g.isIE){S+=' allowtransparency="true"';if(g.isIE6){S+=" src=\"javascript:false;document.write('');\""}}
S+="></iframe>";K.innerHTML=S},remove:function(){var K=ag(this.id);if(K){z(K);if(g.isGecko){delete T.frames[this.id]}}},onLoad:function(){var K=g.isIE?ag(this.id).contentWindow:T.frames[this.id];K.location.href=this.obj.content}};g.html=function(K,S){this.obj=K;this.id=S;this.height=K.height?parseInt(K.height,10):300;this.width=K.width?parseInt(K.width,10):500};g.html.prototype={append:function(K,S){var au=document.createElement("div");au.id=this.id;au.className="html";au.innerHTML=this.obj.content;K.appendChild(au)},remove:function(){var K=ag(this.id);if(K){z(K)}}};var al=false,A=[],H=["sb-nav-close","sb-nav-next","sb-nav-play","sb-nav-pause","sb-nav-previous"],F,ah,v,P=true;function ae(au,aE,aB,az,aF){var K=(aE=="opacity"),aA=K?g.setOpacity:function(aG,aH){aG.style[aE]=""+aH+"px"};if(az==0||(!K&&!g.options.animate)||(K&&!g.options.animateFade)){aA(au,aB);if(aF){aF()}
return}
var aC=parseFloat(g.getStyle(au,aE))||0;var aD=aB-aC;if(aD==0){if(aF){aF()}
return}
az*=1000;var av=X(),ay=g.ease,ax=av+az,aw;var S=setInterval(function(){aw=X();if(aw>=ax){clearInterval(S);S=null;aA(au,aB);if(aF){aF()}}else{aA(au,aC+ay((aw-av)/az)*aD)}},10)}
function I(){F.style.height=g.getWindowSize("Height")+"px";F.style.width=g.getWindowSize("Width")+"px"}
function ad(){F.style.top=document.documentElement.scrollTop+"px";F.style.left=document.documentElement.scrollLeft+"px"}
function y(K){if(K){ac(A,function(S,au){au[0].style.visibility=au[1]||""})}else{A=[];ac(g.options.troubleElements,function(au,S){ac(document.getElementsByTagName(S),function(av,aw){A.push([aw,aw.style.visibility]);aw.style.visibility="hidden"})})}}
function x(au,K){var S=ag("sb-nav-"+au);if(S){S.style.display=K?"":"none"}}
function n(K,ax){var aw=ag("sb-loading"),au=g.getCurrent().player,av=(au=="img"||au=="html");if(K){g.setOpacity(aw,0);aw.style.display="block";var S=function(){g.clearOpacity(aw);if(ax){ax()}};if(av){ae(aw,"opacity",1,g.options.fadeDuration,S)}else{S()}}else{var S=function(){aw.style.display="none";g.clearOpacity(aw);if(ax){ax()}};if(av){ae(aw,"opacity",0,g.options.fadeDuration,S)}else{S()}}}
function at(aC){var ax=g.getCurrent();ag("sb-title-inner").innerHTML=ax.title||"";var aD,az,S,aE,aA;if(g.options.displayNav){aD=true;var aB=g.gallery.length;if(aB>1){if(g.options.continuous){az=aA=true}else{az=(aB-1)>g.current;aA=g.current>0}}
if(g.options.slideshowDelay>0&&g.hasNext()){aE=!g.isPaused();S=!aE}}else{aD=az=S=aE=aA=false}
x("close",aD);x("next",az);x("play",S);x("pause",aE);x("previous",aA);var K="";if(g.options.displayCounter&&g.gallery.length>1){var aB=g.gallery.length;if(g.options.counterType=="skip"){var aw=0,av=aB,au=parseInt(g.options.counterLimit)||0;if(au<aB&&au>2){var ay=Math.floor(au/2);aw=g.current-ay;if(aw<0){aw+=aB}
av=g.current+(au-ay);if(av>aB){av-=aB}}
while(aw!=av){if(aw==aB){aw=0}
K+='<a onclick="Shadowbox.change('+aw+');"';if(aw==g.current){K+=' class="sb-counter-current"'}
K+=">"+(++aw)+"</a>"}}else{K=[g.current+1,g.lang.of,aB].join(" ")}}
ag("sb-counter").innerHTML=K;aC()}
function u(av){var K=ag("sb-title-inner"),au=ag("sb-info-inner"),S=0.35;K.style.visibility=au.style.visibility="";if(K.innerHTML!=""){ae(K,"marginTop",0,S)}
ae(au,"marginTop",0,S,av)}
function ab(au,aA){var ay=ag("sb-title"),K=ag("sb-info"),av=ay.offsetHeight,aw=K.offsetHeight,ax=ag("sb-title-inner"),az=ag("sb-info-inner"),S=(au?0.35:0);ae(ax,"marginTop",av,S);ae(az,"marginTop",aw*-1,S,function(){ax.style.visibility=az.style.visibility="hidden";aA()})}
function E(K,av,S,ax){var aw=ag("sb-wrapper-inner"),au=(S?g.options.resizeDuration:0);ae(v,"top",av,au);ae(aw,"height",K,au,ax)}
function t(K,av,S,aw){var au=(S?g.options.resizeDuration:0);ae(v,"left",av,au);ae(v,"width",K,au,aw)}
function R(aA,au){var aw=ag("sb-body-inner"),aA=parseInt(aA),au=parseInt(au),S=v.offsetHeight-aw.offsetHeight,K=v.offsetWidth-aw.offsetWidth,ay=ah.offsetHeight,az=ah.offsetWidth,ax=parseInt(g.options.viewportPadding)||20,av=(g.player&&g.options.handleOversize!="drag");return g.setDimensions(aA,au,ay,az,S,K,ax,av)}
var k={};k.markup='<div id="sb-container"><div id="sb-overlay"></div><div id="sb-wrapper"><div id="sb-title"><div id="sb-title-inner"></div></div><div id="sb-info"><div id="sb-info-inner"><div id="sb-counter"></div><div id="sb-nav"><a id="sb-nav-close" title="{close}" onclick="Shadowbox.close()"></a><a id="sb-nav-next" title="{next}" onclick="Shadowbox.next()"></a><a id="sb-nav-play" title="{play}" onclick="Shadowbox.play()"></a><a id="sb-nav-pause" title="{pause}" onclick="Shadowbox.pause()"></a><a id="sb-nav-previous" title="{previous}" onclick="Shadowbox.previous()"></a></div></div></div><div id="sb-wrapper-inner"><div id="sb-body"><div id="sb-body-inner"></div><div id="sb-loading"><div id="sb-loading-inner"><span>{loading}</span></div></div></div></div></div></div>';k.options={animSequence:"sync",counterLimit:10,counterType:"default",displayCounter:true,displayNav:true,fadeDuration:0.35,initialHeight:160,initialWidth:320,modal:false,overlayColor:"#fff",overlayOpacity:0.6,resizeDuration:0.35,showOverlay:true,troubleElements:["select","object","embed","canvas"]};k.init=function(){g.appendHTML(document.body,s(k.markup,g.lang));k.body=ag("sb-body-inner");F=ag("sb-container");ah=ag("sb-overlay");v=ag("sb-wrapper");if(!L){F.style.position="absolute"}
if(!ak){var au,K,S=/url\("(.*\.png)"\)/;ac(H,function(aw,ax){au=ag(ax);if(au){K=g.getStyle(au,"backgroundImage").match(S);if(K){au.style.backgroundImage="none";au.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,src="+K[1]+",sizingMethod=scale);"}}})}
var av;j(T,"resize",function(){if(av){clearTimeout(av);av=null}
if(w){av=setTimeout(k.onWindowResize,10)}})};k.onOpen=function(K,au){P=false;F.style.display="block";I();var S=R(g.options.initialHeight,g.options.initialWidth);E(S.innerHeight,S.top);t(S.width,S.left);if(g.options.showOverlay){ah.style.backgroundColor=g.options.overlayColor;g.setOpacity(ah,0);if(!g.options.modal){j(ah,"click",g.close)}
al=true}
if(!L){ad();j(T,"scroll",ad)}
y();F.style.visibility="visible";if(al){ae(ah,"opacity",g.options.overlayOpacity,g.options.fadeDuration,au)}else{au()}};k.onLoad=function(S,K){n(true);while(k.body.firstChild){z(k.body.firstChild)}
ab(S,function(){if(!w){return}
if(!S){v.style.visibility="visible"}
at(K)})};k.onReady=function(av){if(!w){return}
var S=g.player,au=R(S.height,S.width);var K=function(){u(av)};switch(g.options.animSequence){case"hw":E(au.innerHeight,au.top,true,function(){t(au.width,au.left,true,K)});break;case"wh":t(au.width,au.left,true,function(){E(au.innerHeight,au.top,true,K)});break;default:t(au.width,au.left,true);E(au.innerHeight,au.top,true,K)}};k.onShow=function(K){n(false,K);P=true};k.onClose=function(){if(!L){a(T,"scroll",ad)}
a(ah,"click",g.close);v.style.visibility="hidden";var K=function(){F.style.visibility="hidden";F.style.display="none";y(true)};if(al){ae(ah,"opacity",0,g.options.fadeDuration,K)}else{K()}};k.onPlay=function(){x("play",false);x("pause",true)};k.onPause=function(){x("pause",false);x("play",true)};k.onWindowResize=function(){if(!P){return}
I();var K=g.player,S=R(K.height,K.width);t(S.width,S.left);E(S.innerHeight,S.top);if(K.onWindowResize){K.onWindowResize()}};k.dynamicResize=function(w,h){if(!P){return}
I();g.player.width=w;g.player.height=h;var K=g.player,S=R(K.height,K.width);t(S.width,S.left);E(S.innerHeight,S.top);if(K.onWindowResize){K.onWindowResize()}};g.skin=k;T.Shadowbox=g})(window);

;
/**
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);;

(function(){var $=window.jQuery;jQuery.cookie=function(a,b,c){if(arguments.length>1&&String(b)!=="[object Object]"){c=jQuery.extend({},c);if(b===null||b===undefined){c.expires=-1}if(typeof c.expires==="number"){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}b=String(b);return document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};var f,g=c.raw?function(a){return a}:decodeURIComponent;return(f=(new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)")).exec(document.cookie))?g(f[1]):null};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(this==null){throw new TypeError('"this" is null or not defined');}
var o=Object(this);var len=o.length>>>0;if(len===0){return-1;}
var n=fromIndex|0;if(n>=len){return-1;}
k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in o&&o[k]===searchElement){return k;}
k++;}
return-1;};}
window.kwGetScripts=function(scripts,next,cache,timeout){if(!timeout)timeout=2000;cache=!!cache;var checkAllDone=function(){if(!(jQuery.isEmptyObject(scripts)))return;checkAllDone=function(){};if(next)next();}
$.each(scripts,function(k,v){var onsuccess=function(){onsuccess=function(){};delete scripts[k];checkAllDone();};var options={url:v,dataType:"script",cache:cache,type:"GET",success:function(){onsuccess();}}
jQuery.ajax(options);setTimeout(function(){onsuccess();},timeout);});}
window.getCachedScript=function(script,success){var options={url:script,dataType:"script",cache:true,type:"GET",success:success}
jQuery.ajax(options);}
window.locationHrefWithoutHash=function(){var ret=document.location.href.split("#")[0];if(window.filters)ret=window.filters.exec("locationHrefWithoutHash",ret);return ret;}
window.GeleSocial={version:2}
if(navigator.userAgent.indexOf("KwMobile")>=0){window.__gigAPIAdapterSettings={getAdapterName:function(){return"mobile";}};}
GeleSocial.settings={debug:false,test:false,socialPathBase:"/social",pageId:"",ignoreSocialLogged:null,statusChangeCallbacks:[],kw_cookie:"",socialDataUrl:null,openWindowProfiles:{"facebook-share":{width:640,height:400,center:1,createnew:0,scrollbars:0},"login":{width:700,height:570,center:1,createnew:0,scrollbars:1}},gigya:{sdk:'//cdns.gigya.com/js/gigya.js',conf:{"autoLogin":false,"connectWithoutLoginBehavior":"alwaysLogin","forceAuthentication":"true","shortURLs":"never","bypassCookiePolicy":"always","enabledProviders":"facebook,twitter,googleplus,linkedin"},timeout:15000,siteUIDNotRequired:false},shadowbox:{handleOversize:"none",width:700,height:570},ws:{},canLiveWithoutGigya:true,ssoMaster:false};GeleSocial.settings.gigya.conf.facebookInitParams={channelUrl:window.location.protocol+"//"+window.location.host+GeleSocial.settings.socialPathBase+"/common/channel_url.cache.php"}
if(GeleSocial.settings.debug||GeleSocial.settings.test)window.kwdebug=true;GeleSocial.status={gigya:{logged:false,sameUser:false,isSiteUID:false,isSiteLogged:false,preventAutologin:false,loaded:false,blocked:undefined,activeProviders:[],expiredProviders:[],realLoginProvider:"site"},autologin:false,autologinDone:false,logged:false,transitional:true,loaded:false,redisError:false,negativeCookie:false};GeleSocial.lastNotifiedStatus=jQuery.extend(true,{},GeleSocial.status);GeleSocial.getLogger=function(context){var ret={log:function(){},error:function(){}};if(window.common&&common.logging){ret=common.logging.getLogger("SOCIAL");}else if(window.console){var ret={};if(window.console.log.bind)
ret.log=window.console.log.bind(window.console,context);if(window.console.error.bind)
ret.error=window.console.error.bind(window.console,context);if(!ret.log)
ret.log=window.console.log;if(!ret.error)
ret.error=window.console.error;}
return ret;}
GeleSocial.initLogging=function(){if(window.common&&common.logging)common.logging.init();GeleSocial.logger=GeleSocial.getLogger("SOCIAL");};GeleSocial.initLogging();if(!window.filters)window.filters={__filters:$({}),add:function(name,filter){this.__filters.bind(name,function(ev,data){filter(data);});},one:function(name,filter){this.__filters.one(name,function(ev,data){filter(data);});},exec:function(name,val){var data={ret:val};this.__filters.trigger(name,data);return data.ret;}}
GeleSocial.ignoreRulesMatch=function(rules){if(rules){var loc=window.location.href;var match=false;jQuery.each(rules,function(i,rule){match=loc.match(rule);if(match)return false;});return match;}else return false;}
GeleSocial.settings.ignoreSocialLogged=function(){if(GeleSocial.status.gigya.preventAutologin)return true;var disableAutoLogin=GeleSocial.settings.disableAutoLogin;function compile(rules){var baseUrl=GeleSocial.ws.settings.BASE_URL;if(!baseUrl||!rules)return null;else{if(baseUrl[baseUrl.length-1]!="/"){baseUrl=baseUrl+"/";}
baseUrl=GeleSocial.utils.regExpQuote(baseUrl);}
var rules1=[];var hasAll=jQuery.grep(rules,function(a,i){return a=="__all__";}).length>0;if(hasAll){rules1.push("^.*$");}else{jQuery.each(rules,function(i,a){if(a=="__home__"){rules1.push("^"+baseUrl+"[^/]*$");}else{a=GeleSocial.utils.regExpQuote(a);rules1.push("^"+baseUrl+a+"([/?#].*)?$");}});}
rules=rules1;return rules;}
if(!disableAutoLogin&&GeleSocial.settings.disableAutoLoginRegexp){return GeleSocial.ignoreRulesMatch(GeleSocial.settings.disableAutoLoginRegexp);}else if(disableAutoLogin){disableAutoLogin=compile(disableAutoLogin);return GeleSocial.ignoreRulesMatch(disableAutoLogin);}else return false;}
GeleSocial.addInitCallback=function(callback){if(GeleSocial.status.gigya.blocked!==undefined)callback();else{GeleSocial.addStatusChangeCallback(function(last,current){if(last.gigya.blocked===undefined&&current.gigya.blocked!==undefined){callback();}});}}
GeleSocial.addFinalStatusCallback=function(callback){if(GeleSocial.status.transitional===false)callback();else{GeleSocial.addStatusChangeCallback(function(last,current){if(last.transitional&&!current.transitional){callback();}});}}
GeleSocial.setGigyaBlocked=function(autologin){if(GeleSocial.status.gigya.blocked!==undefined&&!autologin)return;GeleSocial.status.gigya.blocked=true;GeleSocial.logger.log("Gigya blocked");GeleSocial.ugcInit();}
GeleSocial.addStatusChangeListener=function(page,listener){var current=GeleSocial.status;current.page=page;if(listener.initialized&&current.initialized)listener.initialized(page);if(listener.downloaded&&current.gigya.blocked!==undefined)listener.downloaded(page);if(!current.transitional){if(current.logged&&listener.logged)listener.logged(page);else if(!current.logged&&listener.notlogged)listener.notlogged(page);if(listener.finalized)listener.finalized(page);}
var fastInit=GeleSocial.settings.fastInit;var onready=function(event){if(listener[event]){if(fastInit)listener[event](page);else{$(function(){listener[event](page);});}}}
GeleSocial.addStatusChangeCallback(function(last,current){if(last.initialized===undefined&&current.initialized){onready("initialized");}
if(last.gigya.blocked===undefined&&current.gigya.blocked!==undefined){onready("downloaded");}
if(last.transitional&&!current.transitional){if(current.logged)onready("logged");else if(!current.logged)onready("notlogged");onready("finalized");}});}
GeleSocial.addStatusChangeCallback=function(callback){if(GeleSocial.settings&&GeleSocial.settings.statusChangeCallbacks){GeleSocial.settings.statusChangeCallbacks.push(callback);}}
GeleSocial.notifyStatusChange=function(){if(GeleSocial.settings&&GeleSocial.settings.statusChangeCallbacks){jQuery(GeleSocial.settings.statusChangeCallbacks).each(function(i,statusChangeCallback){statusChangeCallback(GeleSocial.lastNotifiedStatus,GeleSocial.status);})
GeleSocial.lastNotifiedStatus=jQuery.extend(true,{},GeleSocial.status);}}
GeleSocial.interfaces={standard:{init:function(initializeGigya){var onGigyaServiceReady=function(){GeleSocial.interface.willAutologin(function(will){if(will){gigya.socialize.addEventHandlers({onLogin:function(ev){initializeGigya();}});}else{initializeGigya();}});};var onError=function(){GeleSocial.setGigyaBlocked();}
GeleSocial.getUser(function(){});GeleSocial.interface.loadGigya(onGigyaServiceReady,onError);},loadGigya:function(onGigyaServiceReady,onError){if(!window.gigya||!window.gigya.socialize){window.onGigyaServiceReady=function(serviceName){if(serviceName!="socialize")return;onGigyaServiceReady();}
var gigyaSrc=GeleSocial.settings.gigya.sdk+'?apikey='+escape(GeleSocial.settings.appId)+"&lang=it-IT";var timeout=GeleSocial.settings.gigya.timeout;if(GeleSocial.isIE(8))timeout=timeout*2;if(onError)setTimeout(function(){onError();},timeout);(function(d){var js;js=d.createElement('script');js.async=true;js.src=gigyaSrc;js.text=JSON.stringify(GeleSocial.settings.gigya.conf);d.getElementsByTagName('head')[0].appendChild(js);}(document));}else{window.onGigyaServiceReady("socialize");}},willAutologin:function(callback){var autologin=GeleSocial.settings.gigya.conf.autoLogin;if(!autologin)callback(false);var facebookLoaded=function(){facebookLoaded=function(){};if(!autologin||!window.FB)callback(false);else{var gigyaStatus=function(response){if(response.user&&response.user.isLoggedIn){callback(false);}else{callback(true);}}
var facebookStatus=function(response){var connected=response.status=="connected";if(!connected)callback(false);else{gigya.socialize.getUserInfo({callback:gigyaStatus});}}
FB.getLoginStatus(facebookStatus);}}
gigya.socialize.waitForService({},{service:"facebook",callback:facebookLoaded});setTimeout(facebookLoaded,10000);},getUser:function(callback,force){var getuser=arguments.callee;var cookie_name=GeleSocial.settings.kw_cookie;var cookie_val=GeleSocial.getCookie(cookie_name);if(force){delete getuser.user;}
if(!callback){if(getuser.user)return getuser.user
else return null;}else if(!cookie_val){callback(null);return null;}
if(getuser.user){callback(getuser.user);}else{if(getuser.callbacks){getuser.callbacks.bind("gelesocial.getuser",function(ev,data){callback(data);});}else{getuser.callbacks=$({});getuser.callbacks.bind("gelesocial.getuser",function(ev,data){callback(data);});var loadUser=null;var success=function(data){var missing=!data||!data.user;getuser.user=data;if(missing){GeleSocial.deleteCookie(cookie_name,null,null,"/");}else{getuser.user=data;}
getuser.callbacks.trigger("gelesocial.getuser",getuser.user);delete getuser.callbacks;}
var error=function(){getuser.user=null;GeleSocial.deleteCookie(cookie_name,null,null,"/");getuser.callbacks.trigger("gelesocial.getuser",getuser.user);delete getuser.callbacks;}
loadUser=function(cookie_val){var external=GeleSocial.settings.external;var dataType="json";if(external)dataType="script";var params={session:cookie_val};var success1=success;var error1=error;var baseUrlSocial=GeleSocial.settings.baseUrlSocial;if(external){params.format="js";var success1=undefined;success1=function(){if(!success1)return;success1=null;var user=undefined;if(GeleSocial.data&&GeleSocial.data.user){success(GeleSocial.data.user);}else{error();}}
error1=success1;}
$.ajax({url:baseUrlSocial+"getuser.php",data:params,dataType:dataType,success:success1,error:error1,cache:true});if(external){setTimeout(error1,3000);}}
loadUser(cookie_val);}}},getUserInfo:function(callback2){if(GeleSocial.settings.ignoreLoginStatus){callback2("timeout")}else{setTimeout(function(){callback2("timeout");},GeleSocial.settings.gigya.timeout);gigya.socialize.getUserInfo({},{includeAllIdentities:true,callback:callback2});}},showCommentsUI:function(gigyaCommentParams,otherParams){if(!window.gsPlugins)return;var containerID=gigyaCommentParams.containerID;if(GeleSocial.status.gigya.activeProviders)var providers=GeleSocial.status.gigya.activeProviders;else var providers="";var login=function(ev){var loginParams=undefined;if(otherParams){loginParams={};if(otherParams.origin)
loginParams["origin"]=otherParams.origin;if(otherParams.urlToken)
loginParams["urlToken"]=otherParams.urlToken;if(otherParams.forcelogin)
loginParams["forcelogin"]=otherParams.forcelogin;}
if(ev&&ev.type=="focus")$(ev.target).blur();else{if(RenderSocial.SSO_SERVICE_LOGIN=="lastampa"||RenderSocial.SSO_SERVICE_LOGIN=="ilsecoloxix")
{loginParams["forcelogin"]=true;}
GeleSocial.openLoginModal(undefined,undefined,loginParams);}
ev.stopPropagation();ev.preventDefault();return false;}
var onlySite=GeleSocial.status.gigya.isOnlySiteProvider;var commentBox=$("#"+containerID);var anonymous=GeleSocial.isAnonymousUser();var params={version:2,containerID:containerID,gsLinkParams:{ref:"fbc"},gsCountChars:900,gsCountWarning:true,width:'630',useSiteLogin:true,onSiteLoginClicked:login,enabledProviders:providers}
params=$.extend(true,params,gigyaCommentParams);var onLoad1=params.onLoad;params.onLoad=function(){if(onLoad1){try{onLoad1();}catch(e){}}
if(onlySite){commentBox.find(".gig-composebox-share").hide();}
if(anonymous){}
var notLogged=!GeleSocial.status.user||!GeleSocial.status.gigya.user||!GeleSocial.status.gigya.user.isLoggedIn||(!GeleSocial.settings.gigya.siteUIDNotRequired&&!GeleSocial.status.gigya.user.isSiteUID);if(notLogged){var postButton=commentBox.find(".gig-composebox-post");postButton.bind("mousedown",login);var textareas=commentBox.find("textarea,.gig-composebox-textarea,.gig-composebox-summary-input,.gig-composebox-rating-value");textareas.focus(login);textareas.bind("click",login);commentBox.delegate(".gig-comment-vote-posneg","mousedown",login);}}
if(window.gsPlugins.showCommentsUI)window.gsPlugins.showCommentsUI(params);},logOut:function(backurl,callback,autoLogout){if(GeleSocial.logOut._running)return;GeleSocial.logOut._running=true;var me=GeleSocial;if(!callback)callback=function(){var next=function(reload){if(autoLogout){if(reload){if(!GeleSocial.settings.autoLogout)GeleSocial.settings.autoLogout={};GeleSocial.settings.autoLogout.safeIframe=false;}
GeleSocial.startAutologout();}else{backurl=GeleSocial.logOutUrl(backurl);var parameters={};parameters['bckurl']=backurl;GeleSocial.ws.logout(parameters);}
GeleSocial.logOut._running=false;}
GeleSocial.checkOtherServices("autoLogout.moreCookies",next);}
if(!window.gigya||GeleSocial.status.gigya.blocked){callback();}else{gigya.socialize.getUserInfo({callback:function(res){if(res.user&&res.user.isLoggedIn){gigya.socialize.logout({forceProvidersLogout:false,callback:callback});}else{callback();}}});}},onAddConnection:function(){gigya.socialize.addConnection=function(){var params={};jQuery.each(arguments,function(i,a){params=jQuery.extend(true,params,a);})
if(params.provider){if(params.containerID&&gigya.socialize._closeComponent){gigya.socialize._closeComponent('0@gigya.socialize.plugins.minishare@'+params.containerID,true);}
GeleSocial.openAddConnectionWindow(params.provider);}}},onLogout:function(){gigya.socialize.addEventHandlers({onLogout:function(){GeleSocial.logOut();}});}}}
GeleSocial.interface=GeleSocial.interfaces.standard;if(!GeleSocial.gigya)GeleSocial.gigya={};GeleSocial.gigya.redirectTo=function(url1,error,backurlParams){var callback=function(res){if(res.user&&res.user.UID&&res.user.UIDSignature&&res.user.signatureTimestamp){var UID=res.user.UID;var UIDSignature=res.user.UIDSignature;var signatureTimestamp=res.user.signatureTimestamp;var newParams={"UID":UID,"UIDSignature":UIDSignature,"signatureTimestamp":signatureTimestamp};var getUrlParams=function(url){var vars={};var parts=url.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[unescape(key)]=unescape(value);});return vars;}
var urlParams=getUrlParams(url1);$.extend(urlParams,newParams);if(urlParams["backurl"]&&urlParams["backurl"].indexOf("/")==0)urlParams["backurl"]="http://"+document.domain+urlParams["backurl"];if(urlParams["errorpage"]&&urlParams["errorpage"].indexOf("/")==0)urlParams["errorpage"]="http://"+document.domain+urlParams["errorpage"];if(urlParams["backurl"]&&(typeof backurlParams=="object")&&Object.keys(backurlParams).length>0)urlParams["backurl"]+="&"+$.param(backurlParams);var baseUrl=url1.substring(0,url1.indexOf("?"));var form=$("<form action=\""+baseUrl+"\" method=\"POST\"></form>");jQuery.each(urlParams,function(k,v){form.append($("<input type=\"hidden\" name=\""+k+"\" value=\""+v+"\"></input>"));})
$("body").append(form);form.submit();}else if(error){error();}}
gigya.socialize.getUserInfo({includeAllIdentities:false,signIDs:true,callback:callback});};GeleSocial.gigya.showCommentsUI=function(params1,loginParams){if(!params1)params1={};if(!window.gigyaCommentParams)window.gigyaCommentParams={};var gigyaCommentParams=$.extend(true,{},window.gigyaCommentParams,params1);if(!gigyaCommentParams.containerID)gigyaCommentParams.containerID="gs-social-comments";GeleSocial.interface.showCommentsUI(gigyaCommentParams,loginParams);}
GeleSocial.openModal=function(iframeSrc,content,width,height){var sbsettings=$.extend({},this.settings.shadowbox);var settings={id:"login",width:sbsettings.width,height:sbsettings.height,center:1,createnew:0,scrollbars:1}
if(width)settings.width=width;if(height)settings.height=height;var ret=GeleSocial.openWindow(iframeSrc,settings);}
GeleSocial.openShadowbox=function(iframeSrc,content,width,height){if(!window.Shadowbox){GeleSocial.logger.log("Shadowbox non è incluso in pagina");if(iframeSrc)location.href=iframeSrc;}else{var settings=$.extend({},this.settings.shadowbox);var player='html';if(iframeSrc!==undefined&&iframeSrc!==null){player='iframe';content=iframeSrc;}
settings.content=content;settings.player=player;if(width)settings.width=width;if(height)settings.height=height;if(player=="iframe"&&window.Shadowbox.isOpen()){setTimeout(function(){var frame=$("#sb-player");frame[0].src=settings.content;frame.contents().find("body").html("");GeleSocial.resizeModal(settings.width,settings.height);},1000);}else{window.Shadowbox.open(settings);}}}
GeleSocial.trackingParam=function(element,paramName,addLinkPosition){if(window.trackLiveLinks)window.trackLiveLinks(element,paramName,addLinkPosition);else{$("a",element).live("mousedown",function(){var href=$(this).attr("href");if(href&&href.indexOf('http')==0&&href.indexOf(paramName)<0){if(href.indexOf('?')>0){href+="&";}else href+="?";var ref=paramName;if(addLinkPosition){var position1=$(element).find("a").index($(this));ref+="-"+(position1+1);}
href+="ref="+ref;$(this).attr("href",href);}});}}
GeleSocial.closeModal=function(){var name="login";if(GeleSocial.__openedWindows&&GeleSocial.__openedWindows[name]&&!GeleSocial.__openedWindows[name].closed){GeleSocial.__openedWindows[name].close();delete GeleSocial.__openedWindows[name];}
if(window.Shadowbox)window.Shadowbox.close();}
GeleSocial.changedContentModal=function(content){if(window.Shadowbox)
$('#'+window.Shadowbox.skin.body.id).html(content);}
GeleSocial.resizeModal=function(width,height){var name="login";if(GeleSocial.__openedWindows&&GeleSocial.__openedWindows[name]&&!GeleSocial.__openedWindows[name].closed){GeleSocial.__openedWindows[name].focus();ret=GeleSocial.__openedWindows[name];try{ret.resizeTo(width,height);}catch(e){}
ret.postMessage(JSON.stringify({"op":"redirectresize","width":width,"height":height}),"*");}
if(window.Shadowbox&&window.Shadowbox.player)window.Shadowbox.skin.dynamicResize(width,height);}
GeleSocial.showFormSubscription=function(externalSuccessBackUrl,externalFailBackUrl,parameters,here){if(this.settings.baseUrlSocial&&this.settings.funnelManagerPage){if(this.settings.loginParams){parameters=$.extend(true,{},this.settings.loginParams,parameters);}
if(parameters)parameters=jQuery.param(parameters)+"&";else parameters="";externalSuccessBackUrl=GeleSocial.loginUrl(externalSuccessBackUrl);if(!externalFailBackUrl)externalFailBackUrl=externalSuccessBackUrl;else externalFailBackUrl=GeleSocial.loginUrl(externalFailBackUrl);externalSuccessBackUrl=escape(externalSuccessBackUrl);externalFailBackUrl=escape(externalFailBackUrl+'?errMsg=ERROR_MSG_08');var url4redirect=this.settings.funnelManagerPage;url4redirect+=url4redirect.indexOf("?")<0?"?":"&";url4redirect+="externalSuccessBackUrl="+externalSuccessBackUrl+"&externalFailBackUrl="+externalFailBackUrl;if(parameters.length)url4redirect+="&"+parameters;if(GeleSocial.status.redisError||GeleSocial.status.gigya.blocked){GeleSocial.openMessageModal("gigya_blocked");}else{if(here)
window.location.href=url4redirect;else
GeleSocial.openModal(url4redirect,null,920,700);}}}
GeleSocial.showFormRegistration=function(backurl,optbackurl,parameters,here){if(this.settings.baseUrlSocial&&this.settings.registrationPage){if(this.settings.loginParams){parameters=$.extend(true,{},this.settings.loginParams,parameters);}
if(parameters)parameters=jQuery.param(parameters)+"&";else parameters="";backurl=GeleSocial.loginUrl(backurl);if(!optbackurl)optbackurl=backurl;else optbackurl=GeleSocial.loginUrl(optbackurl);backurl=escape(this.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=2&backUrl="+escape(backurl));optbackurl=escape(this.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=2&backUrl="+escape(optbackurl));var url4redirect=this.settings.registrationPage;url4redirect+=url4redirect.indexOf("?")<0?"?":"&";url4redirect+="backurl="+backurl+"&optbackurl="+optbackurl;if(parameters.length)url4redirect+="&"+parameters;if(GeleSocial.status.redisError||GeleSocial.status.gigya.blocked){GeleSocial.openMessageModal("gigya_blocked");}else{if(here)
window.location.href=url4redirect;else
GeleSocial.openModal(url4redirect,null,920,700);}}}
GeleSocial.showBenefits=function(backurl,parameters,here){if(this.settings.baseUrlSocial&&this.settings.benefitsPage){if(parameters)parameters=jQuery.param(parameters)+"&";else parameters="";backurl=GeleSocial.loginUrl(backurl);backurl=escape(this.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=2&backUrl="+escape(backurl));var url4redirect=this.settings.benefitsPage+"?"+parameters+"backurl="+backurl+"&ssoOnly=false";if(GeleSocial.status.redisError||GeleSocial.status.gigya.blocked){GeleSocial.openMessageModal("gigya_blocked");}else{if(here)
window.location.href=url4redirect;else
GeleSocial.openModal(url4redirect,null,920,700);}}}
GeleSocial.openWindow=function(url,profile){var is_string=typeof profile=="string";if((!is_string&&profile&&profile.id)||(GeleSocial.settings.openWindowProfiles&&GeleSocial.settings.openWindowProfiles[profile])){var settings;if(!is_string){settings=profile;profile=profile.id
delete settings.id;}
else settings=GeleSocial.settings.openWindowProfiles[profile];if(settings.center==1)
{settings.top=(screen.height-(settings.height+110))/2;settings.left=(screen.width-settings.width)/2;}
var parameters="";jQuery.each(settings,function(k,v){if(parameters.length>0)parameters+=",";if(v==0)v="no";else if(v==1)v="yes";else v=Math.floor(v);parameters+=k+"="+v;})
var name=profile;if(GeleSocial.__openedWindows&&GeleSocial.__openedWindows[name]&&!GeleSocial.__openedWindows[name].closed){GeleSocial.__openedWindows[name].focus();ret=GeleSocial.__openedWindows[name];try{GeleSocial.resizeModal(settings.width,settings.height);}catch(e){}
ret.location.href=url;}else{var open=function(){var ret=window.open(url,name,parameters);ret.focus();return ret;};if(console)console.log("opening url "+url+" name: "+name+" parameters: "+parameters);var ret=open();if(!GeleSocial.__openedWindows)GeleSocial.__openedWindows={};GeleSocial.__openedWindows[name]=ret;}
var ie_helper=$("iframe#ie_helper");if(ie_helper.length==0){var baseUrl=GeleSocial.settings.mainSiteBaseUrl?GeleSocial.settings.mainSiteBaseUrl:"/";var url=baseUrl+"social/common/pages/ie_helper.html";$("body").append('<iframe id="ie_helper" style="width:0px !important;height:0px !important;border:0px !important" src="'+url+'"></iframe>');}
return ret;}}
GeleSocial.openLoginModal=function(ssoOnly,backurl,parameters,here,replace,open){if(this.settings.baseUrlSocial&&this.settings.loginPage){if(GeleSocial.iOS())here=true;if(!parameters)parameters={};if(this.settings.loginParams){parameters=$.extend(true,{},this.settings.loginParams,parameters);}
if(GeleSocial.status.gigya.blocked===false){if(ssoOnly===undefined)ssoOnly=false;if(parameters.ssoOnly){ssoOnly=parameters.ssoOnly;}}else{ssoOnly=true;}
delete parameters.ssoOnly;if(this.settings.kwdnt)ssoOnly=false;var parameters1=parameters;var provider=parameters.provider?parameters.provider:null;var rememberme=parameters.rememberme?true:false;var forcelogin=parameters.forcelogin?true:false;delete parameters.provider;delete parameters.rememberme;delete parameters.forcelogin;parameters=jQuery.param(parameters);if(parameters.length>0){parameters+="&";}
var optbackurl=GeleSocial.settings.optbackurl?GeleSocial.settings.optbackurl:backurl;backurl=GeleSocial.loginUrl(backurl);optbackurl=GeleSocial.loginUrl(optbackurl);backurl=this.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=2&backUrl="+escape(backurl);optbackurl=this.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=2&backUrl="+escape(optbackurl);if(window.gele_token){url4redirect=backurl+"&SSID="+encodeURIComponent(window.gele_token);}else{if(provider){url4redirect=backurl;url4redirect+=url4redirect.indexOf("?")>=0?"&":"?";url4redirect+=parameters+"overwriteMClose=6&provider="+encodeURIComponent(provider);if(rememberme)url4redirect+="&rememberme=y";}else{var url4redirect=this.settings.loginPage;url4redirect+=url4redirect.indexOf("?")>=0?"&":"?";url4redirect+=parameters+"ssoOnly="+ssoOnly;var backurls="backurl="+encodeURIComponent(backurl)+"&optbackurl="+encodeURIComponent(optbackurl);if(this.settings.ssoDomain&&this.settings.ssoServiceLogin){url4redirect=this.settings.ssoDomain+"/login/SSO?op=login&service="+
encodeURIComponent(this.settings.ssoServiceLogin)+"&loginpage="+
encodeURIComponent(url4redirect)+"&"+backurls;if(parameters1.origin)url4redirect+="&origin="+encodeURIComponent(parameters1.origin);if(parameters1.urlToken)url4redirect+="&urlToken="+encodeURIComponent(parameters1.urlToken);if(forcelogin)url4redirect+="&forcelogin=y";}else{url4redirect+="&"+backurls;}}}
if(GeleSocial.status.redisError||(GeleSocial.status.gigya.blocked&&!GeleSocial.settings.canLiveWithoutGigya)){GeleSocial.openMessageModal("gigya_blocked");}else{if(here){if(!replace)
window.location.href=url4redirect;else
location.replace(url4redirect);}else{if(!open)
GeleSocial.openModal(url4redirect);else
window.open(url4redirect);}}}}
GeleSocial.openReauthModal=function(ssoOnly,backurl,parameters,here){if(!parameters)parameters={};var navid=null;if(GeleSocial.settings.kw_navid_cookie)navid=GeleSocial.getCookie(GeleSocial.settings.kw_navid_cookie);if(navid)parameters.navid=navid;GeleSocial.openLoginModal(ssoOnly,backurl,parameters,here);}
GeleSocial.openMessageModal=function(type,width,height,backurl,use_shadowbox){var errorUrl=this.settings.baseUrlSocial+'loader.php?mClose=5';if(type)errorUrl+="&type="+escape(type);if(backurl)errorUrl+="&backUrl="+escape(backurl);if(use_shadowbox)GeleSocial.openShadowbox(errorUrl,null,width,height);else GeleSocial.openModal(errorUrl,null,width,height);}
GeleSocial.openLoginHere=function(ssoOnly,backurl,parameters){GeleSocial.openLoginModal(ssoOnly,backurl,parameters,true);}
GeleSocial.openSendingComment=function(){GeleSocial.openMessageModal("sending_comment",700,300,undefined,true);}
GeleSocial.openCommentSent=function(){GeleSocial.openMessageModal("comment_sent",700,300,undefined,true);}
GeleSocial.showModifyConnectionsUI=function(params){var div=$(params.container);var loader=null;if(params.loader)loader=$(params.loader);var divOwner=document;if(div[0].ownerDocument)divOwner=div[0].ownerDocument;var bodyOwner=jQuery("body",divOwner);var htmlOwner=jQuery("html",divOwner);var backurl=params.backurl;var expired={};var active={};var enabledProviders=params.enabledProviders;if(!enabledProviders)enabledProviders=GeleSocial.settings.gigya.conf.enabledProviders.split(",");var activeProviders=GeleSocial.status.gigya.activeProviders;var expiredProviders=GeleSocial.status.gigya.expiredProviders;var allProviders=activeProviders.concat(expiredProviders);var socialProviders=jQuery.grep(allProviders,function(elem,index){return elem!=="site"&&jQuery.inArray(elem,enabledProviders)>=0;});jQuery.each(enabledProviders,function(i,a){active[a]=jQuery.inArray(a,activeProviders)>=0;expired[a]=jQuery.inArray(a,expiredProviders)>=0;});var close=function(error,backurl){try{if(!error){GeleSocial.openModal(backurl);}else{GeleSocial.openMessageModal();}}catch(e){if(window.opener)window.close();}};var removeConnection=function(provider){if(loader){try{var loader0=loader[0];loader0.style.width="100%";loader0.style.height="100%";loader0.style.position="fixed";loader0.style.left="0px";loader0.style.top="0px";loader0.style.display="block";}catch(e){}}
var data={"remove":provider}
$.ajax({type:'POST',url:GeleSocial.settings.baseUrlSocial+'modifyconnections.php',data:data,dataType:"json",success:function(data){if(!data||data.result!="ok"){close(true);}else{if(socialProviders.length==1||provider==GeleSocial.status.gigya.realLoginProvider){GeleSocial.startAutologin(backurl,"site",{"modal":true,"action":"removealias"});}else{var backurl1=GeleSocial.settings.baseUrlSocial+"loader.php?mClose=8&action=removealias&backUrl="+escape(backurl);close(false,backurl1);}}},error:function(){close(true);}});}
var div1=jQuery("<ul class='gs-gigya-logincontainers'></ul>",divOwner)
div.append(div1);jQuery.each(enabledProviders,function(i,a){var active1=active[a];var expired1=expired[a];var disconnected1=!active1&&!expired1;var cont1=jQuery("<li class='gs-gigya-logincontainer'></li>",divOwner);cont1.attr("id","gs-gigya-login-"+a);cont1.addClass("gs-gigya-login");if(active1){cont1.addClass("gs-gigya-login-active");}else if(expired1){cont1.addClass("gs-gigya-login-expired");}
var cont2=jQuery("<div class='gs-gigya-logincontainer2'></div>",divOwner);var loginUser=jQuery("<div class='gs-gigya-loginuser'></div>",divOwner);var loginLinks=jQuery("<div class='gs-gigya-loginlinks'></div>",divOwner);cont2.append(loginUser);cont2.append(loginLinks);cont1.append(cont2);var email=null;if(GeleSocial.status.gigya.user){var user=GeleSocial.status.gigya.user;if(user.identities&&user.identities[a]){var identity=user.identities[a];if(identity){if(identity.email&&identity.email.length>0)email=identity.email;else if(identity.nickname&&identity.nickname.length>0)email=identity.nickname;if(email&&GeleSocial.settings.test){loginUser.append(email);}}}}
var caption=jQuery("<a class='gs-gigya-login-a1' href='javascript:void(0)'></a>",divOwner);if(disconnected1){caption.html("Associa a "+a);}else if(active1){caption.html("Elimina associazione");}else if(expired1){caption.html("Rientra con "+a);}
loginLinks.append(caption);if(expired1){caption1=jQuery("<a class='gs-gigya-login-a2' href='javascript:void(0)'></a>",divOwner);caption1.html("Elimina associazione");loginLinks.append(" | ");loginLinks.append(caption1);}
div1.append(cont1);if(!active1){var addCapt=cont1;if(expired1)addCapt=caption;caption.click(function(){GeleSocial.openAddConnectionWindow(a,backurl);});if(expired1){caption1.click(function(){removeConnection(a);});}}else{caption.click(function(){removeConnection(a);});}});}
GeleSocial.openModifyConnectionsModal=function(width,height){if(!width||!height){width=500;height=350;}
var url4redirect=this.settings.baseUrlSocial+"modifyconnections.php";if(GeleSocial.settings.external){url4redirect=url4redirect+"?standalone=true&backurl="+encodeURIComponent(window.locationHrefWithoutHash());}
GeleSocial.openModal(url4redirect,null,width,height);}
GeleSocial.openLoginWindow=function(provider,backurl,parameters,isAdd){if(this.settings.loginParams){parameters=$.extend(true,{},this.settings.loginParams,parameters);}
if(parameters)
parameters=jQuery.param(parameters)+"&";else
parameters="";backurl=GeleSocial.loginUrl(backurl);wndUrl=GeleSocial.settings.baseUrlSocial+"loader.php?"+parameters+"mClose=6";if(isAdd){wndUrl+="&add=true";}
wndUrl+="&provider="+provider+"&backUrl="+escape(backurl);GeleSocial.openWindow(wndUrl,"login");}
GeleSocial.getLoginWindow=function(){return GeleSocial.__openedWindows&&GeleSocial.__openedWindows["login"]?GeleSocial.__openedWindows["login"]:null;}
GeleSocial.openAddConnectionWindow=function(provider,backurl,parameters){return GeleSocial.openLoginWindow(provider,backurl,parameters,true);}
GeleSocial.goToMemberCenter=function(backurl,here){backurl=GeleSocial.logOutUrl(backurl);backurl=GeleSocial.ws.logOutUrl(backurl,true);backurl=GeleSocial.settings.ssoDomain+"/membercenter/membercenter2Servlet?op=sfuupduserprofile&backurl="+escape(backurl)
if(here)GeleSocial.openLoginHere(undefined,backurl,{"forward":"true"});else GeleSocial.openLoginModal(undefined,backurl,{"forward":"true"});}
GeleSocial.sendChangePassword=function(confirm){var me=this;var send=function(){var url=me.settings.baseUrlSocial+"setpassword.php?invia=email";var success=function(){GeleSocial.openModal(me.settings.baseUrlSocial+"loader.php?mClose=5&type=changepwd_sent",null,800,300);};var error=function(){GeleSocial.openModal(me.settings.baseUrlSocial+"loader.php?mClose=5",null,800,300);};$.ajax({url:url,dataType:'json',success:function(data){if(data&&data["result"]=="ok"){success();}else error();},error:error});};if(confirm){GeleSocial.confirm("Confermi di voler cambiare la password?",function(answer){if(answer){send();}});}else{send();}}
GeleSocial.alert=function(message){if(window.dhtmlx){window.dhtmlx.message(message);}else{alert(message);}}
GeleSocial.confirm=function(message,callback){if(window.dhtmlx){dhtmlx.confirm({type:"confirm",text:message,cancel:"Annulla",callback:callback});}else{callback(confirm(message));}}
GeleSocial.Barrier=function(){var me=this;this.finalCallback=null;this.finalized=false;this.numCallbacks=0;this.addCallback=function(){me.numCallbacks++;}
this.completed=function(){me.numCallbacks--;if(me.finalized&&me.finalCallback&&me.numCallbacks==0)me.finalCallback();}
this.wait=function(callback){if(me.numCallbacks==0)callback();else{me.finalized=true;me.finalCallback=callback;}}}
GeleSocial.MessageBox=function(messagebox){var me=this;this.messagebox=$(messagebox);this.message=this.messagebox.find(".gs-message");this.setVisible=function(visible){if(visible)me.messagebox.addClass("gs-visible");else{me.messagebox.removeClass("gs-visible");me.setError(false);me.setLoading(false);}}
this.setError=function(error){if(error)me.messagebox.addClass("gs-error");else me.messagebox.removeClass("gs-error");}
this.setMessage=function(html){me.message.html(html);}
this.setLoading=function(loading){if(loading){me.messagebox.addClass("gs-loading");}else{me.messagebox.removeClass("gs-loading");}}}
GeleSocial.receiveMessages=function(){var onMessage=function(e){var data=null;try{data=JSON.parse(e.originalEvent.data);}catch(e){}
if(data&&data.op){data._source=e.originalEvent.source;window.filters.exec("postMessage."+data.op,data);}}
$(window).bind("message",onMessage);}
GeleSocial.receiveMessages();window.filters.add("postMessage.GeleSocial.redirect",function(data){var source=data.ret._source;if(!source)source=GeleSocial.getLoginWindow();if(source&&source.postMessage){source.postMessage('window_close',"*");}
if(window.xdRedirect)window.xdRedirect(data.ret.data.backurl);});window.filters.add("postMessage.GeleSocial.autoLogin.end",function(data){var data1=data.ret;if(data1.args){GeleSocial.autoLogin(data1.args[0],data1.args[1]);}});window.xdRedirect=function(backurl){location.href=backurl;}
GeleSocial.init=function(settings){if(!GeleSocial.utils.isNull(settings)){GeleSocial.settings=$.extend(true,GeleSocial.settings,settings);}
if(window.filters)filters.exec("GeleSocial.settings",GeleSocial.settings);if(window.gsSettings){GeleSocial.settings=$.extend(true,GeleSocial.settings,window.gsSettings);}
if(GeleSocial.settings.appId&&window.__gigAPIAdapterSettings){window.__gigAPIAdapterSettings.getAPIKey=function(){return GeleSocial.settings.appId;};}
var ssoMasterReady=GeleSocial.settings.ssoMaster&&window.SSO&&(window.SSOConf&&window.SSOConf.appId||GeleSocial.settings.ssoServiceLogin);if(!ssoMasterReady)GeleSocial.settings.ssoMaster=false;if(!GeleSocial.settings.disableEverything&&(!GeleSocial.settings.ssoMaster||ssoMasterReady)){var start=function(){start=function(){};var barrier=new GeleSocial.Barrier();if(GeleSocial.settings.ssoMaster){if(!window.SSOConf)window.SSOConf={targetDomain:"prod"};if(GeleSocial.settings.test)window.SSOConf.targetDomain="test";if(GeleSocial.settings.ssoServiceLogin&&!window.SSOConf.appId)window.SSOConf.appId=GeleSocial.settings.ssoServiceLogin;SSO.injectFrame();}
if(GeleSocial.settings.external&&GeleSocial.settings.mainSiteBaseUrlSocial){GeleSocial.settings.baseUrlSocial=GeleSocial.settings.mainSiteBaseUrlSocial;}else if(GeleSocial.settings.external){GeleSocial.settings.external=false;}
if(!GeleSocial.utils.isNull(GeleSocial.settings.ws)){GeleSocial.settings.ws.BASE_URL=GeleSocial.settings.baseUrlSocial;GeleSocial.ws.init(GeleSocial.settings.ws)}
var callback1=function(){GeleSocial.logger.log("GeleSocial.init");GeleSocial.status.initialized=true;GeleSocial.notifyStatusChange();GeleSocial.checkSocialStatus();};GeleSocial.dependencies.commonDependecies(barrier);GeleSocial.dependencies.siteDependecies(barrier);barrier.wait(callback1);}
if(window.events)events.on("body.start",function(){start()});var kwait=window.kwait||[];kwait.push(["body.start",function(){start()}]);$(document).ready(function(){start()});}}
GeleSocial.isIE=function(version){var is_ie=($.browser&&$.browser.msie)||document.documentMode;if(is_ie&&version){if($.browser){is_ie=parseInt($.browser.version)<=version;}else if(document.documentMode){is_ie=document.documentMode<=version;}}
return is_ie;}
GeleSocial.iOS=function(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("ipad")>=0||ua.indexOf("ios")>=0||ua.indexOf("iphone")>=0;}
GeleSocial.checkSocialStatus=function(){var me=this;try{var initializeGigya=function(){if(me.status.gigya.blocked!==undefined)return;me.status.gigya.blocked=false;try{GeleSocial.logger.log("Gigya initialized");GeleSocial.notifyStatusChange();if(GeleSocial.interface.onAddConnection)GeleSocial.interface.onAddConnection();if(GeleSocial.interface.onLogout)GeleSocial.interface.onLogout();GeleSocial.getUser(function(user){if(user){GeleSocial.settings.gigya.conf.autoLogin=false;}
GeleSocial.getLoginStatus(user);});}catch(e){GeleSocial.logger.error(e);}};var dnt=window.kwdnt===-1||GeleSocial.settings.ssoOnly===true;if(dnt){GeleSocial.settings.kwdnt=true;GeleSocial.setGigyaBlocked();}
else GeleSocial.interface.init(initializeGigya);}catch(e){GeleSocial.logger.log("ATTENZIONE! L'SDK NON È STATO CARICATO CORRETTAMENTE!!");}}
GeleSocial.withSocialData=function(callback){if(!GeleSocial.utils.isNull(GeleSocial.settings.socialDataUrl)){$.ajax({url:GeleSocial.settings.socialDataUrl,dataType:'json',success:function(data){if(data){for(k in data){window[k]=data[k];}
callback();}}});}else{callback();}}
GeleSocial.withShareStats=function(pageId,callback,update){var stats=GeleSocial.withShareStats.__stats;if(stats)callback(stats);else{if(!pageId||!GeleSocial.settings.baseUrlSocial)callback({});else{var url=GeleSocial.settings.baseUrlSocial+"ws/facebook/sharestats.cache.php?page="+pageId;if(update)url+="&update=true";var error=function(){GeleSocial.withShareStats.__stats={};callback(GeleSocial.withShareStats.__stats);};var success=function(data){if(data)callback(data);else error();};$.ajax({url:url,dataType:'json',success:success,error:error});}}}
GeleSocial.dependencies={}
GeleSocial.dependencies.loadDependecies=function(dependencies,barrier){var completed=function(){barrier.completed();}
if(dependencies&&dependencies instanceof Array){jQuery.each(dependencies,function(i,dep){barrier.addCallback();});jQuery.each(dependencies,function(i,dep){if(!dep)return true;var src=null;var existing=false;if(dep instanceof Array){src=dep[0];existing=dep[1]();}else{src=dep;}
var script=$('script[src="'+src+'"]');if(!existing&&script.length==0){window.getCachedScript(src,completed);}else{completed();}});}}
GeleSocial.dependencies.commonDependecies=function(barrier){var add=function(){barrier.addCallback();}
var complete=function(){barrier.completed();}
filters.exec("dependencies.commonDependecies",{add:add,complete:complete});var repstatic=GeleSocial.settings.test&&"//test.repstatic.it"||"//www.repstatic.it";var commonDependencies=[[repstatic+'/cless/common/social/stable/js/json2.min.js',function(){return window.JSON;}],[repstatic+'/cless/common/social/stable/js/crypto-md5-2.5.3.js',function(){return window.Crypto&&window.Crypto.MD5;}],[repstatic+'/cless/common/social/stable/js/url.js',function(){return!!window.URLEdit;}]];var mainSiteBaseUrl=GeleSocial.settings.mainSiteBaseUrl;var external=GeleSocial.settings.external;if(external&&mainSiteBaseUrl){for(var i=0;i<commonDependencies.length;i++){var dep=commonDependencies[i];if(dep.constructor===Array){if(dep[0].indexOf(repstatic)==0)continue;dep[0]=mainSiteBaseUrl+dep[0].slice(1);}else{if(dep.indexOf(repstatic)==0)continue;commonDependencies[i]=mainSiteBaseUrl+commonDependencies[i].slice(1);}}}
GeleSocial.dependencies.loadDependecies(commonDependencies,barrier);}
GeleSocial.dependencies.siteDependecies=function(barrier){GeleSocial.dependencies.loadDependecies(GeleSocial.settings.siteDependencies,barrier);}
GeleSocial.getLoginProviderPhoto=function(){return GeleSocial.getUserThumb();}
GeleSocial.getUserThumb=function(){var user=GeleSocial.status.user;var ret=null;if(user&&user.thumbnailURL)ret=user.thumbnailURL;return ret;}
GeleSocial.getUserPhoto=function(){var user=GeleSocial.status.user;var ret=null;if(user&&user.photoURL)ret=user.photoURL;return ret;}
GeleSocial.getUserNick=function(){var user=GeleSocial.status.user;var ret=null;if(user&&user.nickname)ret=user.nickname;return ret;}
GeleSocial.isAnonymousUser=function(){var user=GeleSocial.getUserNick();return(user&&user.match(/^utente[0-9]+$/));}
GeleSocial.checkOtherServices=function(filterName,next,ssid){var moreCookies={};moreCookies=window.filters.exec(filterName,moreCookies);var reload=moreCookies.__reload;delete moreCookies.__reload;if(jQuery.isEmptyObject(moreCookies))next();else{if(!ssid){window.kwGetScripts(moreCookies,function(){next(reload);});}else{var onssid=function(ssid){onssid=function(){};if(ssid){for(var k in moreCookies){var v=moreCookies[k];v+=v.indexOf("?")>=0?"&":"?";v+=jQuery.param({"SSID":ssid});moreCookies[k]=v;}
window.kwGetScripts(moreCookies,function(){next(reload);});}else{next();}}
if(ssid===true){SSO.checkStatusChange(null,function(data){onssid(data.SSID);});setTimeout(function(){onssid();},2000);}else{onssid(ssid);}}}}
GeleSocial.temporaryStatusAvailable=function(params){if(!params)params={};var me=this;var autologin=me.status.autologin&&!me.status.autologinDone;var autologout=false;autologin=window.filters.exec("GeleSocial.autoLogin",autologin);if(me.status.autologinDone)autologin=false;if(me.settings.ssoMaster&&autologin&&!params.ssid){autologout=true;}
if(me.settings.ssoMaster&&!params.ssid&&!me.status.logged&&me.status.gigya.logged&&!me.status.autologinDone){autologin=true;autologout=true;}
var checkotherLogins=GeleSocial.status.logged||autologin;var checkotherLogouts=!checkotherLogins;var next=function(reload){if(reload){if(!autologin){window.top.location.reload();return;}else{if(!GeleSocial.settings.autoLogin)GeleSocial.settings.autoLogin={};GeleSocial.settings.autoLogin.safeIframe=false;}}
if(autologin){if(autologout)GeleSocial.logOut(undefined,undefined,true);else GeleSocial.startAutologin(undefined,"site",undefined,params.ssid);}else{GeleSocial.readSocialData();}
GeleSocial.notifyStatusChange();}
if(!GeleSocial.settings.ssoMaster)next();else{if(checkotherLogins){GeleSocial.checkOtherServices("autoLogin.moreCookies",next,!params.ssid?true:params.ssid);}else{if(checkotherLogouts)GeleSocial.checkOtherServices("autoLogout.moreCookies",next);}}}
GeleSocial.checkSSOStatus=function(noAutologin){var me=this;var hashId=null;var autologin=false;if(me.status.logged&&me.status.gigya.logged){hashId=me.status.user.user;}else if(me.status.logged&&!me.status.gigya.logged){autologin=true;}
var autologin=window.filters.exec("GeleSocial.autoLogin",autologin);if(autologin){hashId=null;me.status.autologin=true;}
var onStatusChange=function(data){onStatusChange=function(){};if(data.op=="logout"&&!noAutologin){GeleSocial.logOut(undefined,undefined,true);}else{var ssid=null;if((data.op=="login"||data.op=="changeuser")&&!noAutologin){if(data.SSID){ssid=data.SSID;me.status.autologin=true;}}
if(data.TPCBlocked){me.status.autologin=false;me.settings.ssoMaster=false;}
GeleSocial.temporaryStatusAvailable({ssid:ssid});}};SSO.checkStatusChange(hashId,onStatusChange);setTimeout(function(){onStatusChange({op:"sameuser"})},5000);}
GeleSocial.getLoginStatus=function(user){var me=this;var userInfo=undefined;var callback1=null;var callback=function(response){callback1=null;response=userInfo;try{if(response){var response1=null;if(response.user)response1=response.user;else response1=response;}
if(response=="timeout"){GeleSocial.status.gigya.blocked=true;GeleSocial.logger.log("GeleSocial getUserInfo timeout");}else if(response){if(user&&!user.rememberme&&!GeleSocial.getCookieSession()){GeleSocial.logOut(undefined,undefined,true);return;}
if(response.user!=null&&response.user.isLoggedIn&&(!response.user.isConnected||(!GeleSocial.settings.gigya.siteUIDNotRequired&&!response.user.isSiteUID))){GeleSocial.logOut(undefined,function(){});response.user={};}
me.status.gigya.response=response;if(response.user&&response.user.providers&&response.user.identities&&response.user.providers.length>0){var activeProviders=[];var expiredProviders=[];jQuery.each(response.user.providers,function(i,a){var ident=response.user.identities[a];if(ident&&!ident.isExpiredSession)activeProviders.push(a);else expiredProviders.push(a);});me.status.gigya.activeProviders=activeProviders;me.status.gigya.expiredProviders=expiredProviders;}
if(response.user&&response.user.identities&&response.user.identities["site"]){var thumbnailURL=response.user.identities["site"].thumbnailURL;var realProvider=null;jQuery.each(response.user.identities,function(k,v){if(k!="site"&&(v.thumbnailURL==thumbnailURL||v.photoURL==thumbnailURL)){realProvider=k;}});if(realProvider)me.status.gigya.realLoginProvider=realProvider;else if(thumbnailURL&&thumbnailURL.indexOf("provider=site")<0){me.status.autologin=true;me.status.autologin=window.filters.exec("autoLogin.isMigrate",me.status.autologin);}}
me.status.gigya.logged=response.user!=null&&response.user.isLoggedIn;me.status.gigya.isOnlySiteProvider=me.status.gigya.activeProviders.length==1&&me.status.gigya.activeProviders[0]=="site";me.status.gigya.user=response.user;}
GeleSocial.checkStatus(user);filters.exec("checkStatus");if(me.status.logged&&location.href.indexOf("kwautologin=true")>=0){window.filters.exec("GeleSocial.kwAutologin");var backurl=window.locationHrefWithoutHash();backurl=backurl.replace(/(&|\?)kwautologin=true/,"$1");GeleSocial.settings.backurl=backurl;if(!GeleSocial.settings.autoLogin)GeleSocial.settings.autoLogin={};GeleSocial.settings.autoLogin.safeIframe=false;GeleSocial.status.autologin=true;}
var noAutologin=GeleSocial.settings.ignoreSocialLogged&&GeleSocial.settings.ignoreSocialLogged()||GeleSocial.status.autologinDone;if(GeleSocial.settings.ssoMaster){GeleSocial.checkSSOStatus(noAutologin);}else{if(!me.status.logged&&me.status.gigya.logged&&!noAutologin){me.status.autologin=true;}
GeleSocial.temporaryStatusAvailable();}}catch(e){GeleSocial.logger.log("errore: "+e);}};var callback1=callback;var callback2=function(response){if(user===undefined||userInfo===undefined)return;if(callback1)callback1(response);};GeleSocial.interface.getUserInfo(function(response){userInfo=response;callback2();});if(user===undefined)GeleSocial.interface.getUser(function(response){user=response;callback2();});}
GeleSocial.ugcInit=function(){var me=this;GeleSocial.interface.getUser(function(response){GeleSocial.checkStatus(response);if(GeleSocial.settings.ssoMaster){GeleSocial.checkSSOStatus();}else{GeleSocial.status.autologin=false;GeleSocial.temporaryStatusAvailable();}});}
GeleSocial.addCookieListener=function(listener){if(!this._cookieListeners)this._cookieListeners=[];this._cookieListeners.push(listener);}
GeleSocial.startAutologin=function(bckUrl1,provider,params,ssid){window.filters.exec("GeleSocial.startAutologin");var baseUrl=this.settings.baseUrlSocial+"loader.php";if(this.settings.loginParams){if(!params)params={};params=$.extend(true,{},this.settings.loginParams,params);}
var safeIframe=false;safeIframe=window.filters.exec("autoLogin.safeIframe",safeIframe);if(!safeIframe){bckUrl=GeleSocial.loginUrl(bckUrl1);}else{var bckUrl=baseUrl+"?mClose=4";if(params)bckUrl+="&"+$.param(params);if(bckUrl1)bckUrl+="&backUrl="+encodeURIComponent(bckUrl1);bckUrl=GeleSocial.loginUrl(bckUrl);}
var error=function(){GeleSocial.autoLogin(bckUrl1);}
var startA=function(provider){var url4redirect=baseUrl+"?mClose=6&autologin=true";if(params)url4redirect+="&"+$.param(params);if(provider=="site"&&ssid){url4redirect+="&SSID="+escape(ssid);}
if(provider)url4redirect+="&provider="+provider;url4redirect+="&backUrl="+escape(bckUrl);if(!safeIframe){if(params&&params.modal){GeleSocial.closeModal();}
location.href=url4redirect;}else{$("body").append("<iframe src=\""+url4redirect+"\" name=\"iframe\" width=\"0\" height=\"0\" scrolling=\"No\" frameborder=\"0\" id=\"iframe\" ></iframe>");}
if(!bckUrl1)setTimeout(error,GeleSocial.settings.gigya.timeout);}
startA(provider);}
window.filters.add("autoLogin.safeIframe",function(data){if(GeleSocial.settings.autoLogin&&GeleSocial.settings.autoLogin.safeIframe){data.ret=true;}});GeleSocial.startAutologout=function(bckUrl1,params){GeleSocial.resetUser();var baseUrl=this.settings.baseUrlSocial;if(!bckUrl1)bckUrl1=GeleSocial.defaultBackUrl("logout");var goAway=bckUrl1!=window.locationHrefWithoutHash();var safeIframe=false;safeIframe=window.filters.exec("autoLogout.safeIframe",safeIframe);if(!safeIframe){var bckUrl=GeleSocial.logOutUrl(bckUrl1);}else{var bckUrl=baseUrl+"loader.php?mClose=4";if(params)bckUrl+="&"+$.param(params);if(goAway)bckUrl+="&backUrl="+encodeURIComponent(bckUrl1);bckUrl=GeleSocial.logOutUrl(bckUrl);}
bckUrl=GeleSocial.ws.logOutUrl(bckUrl,true);if(!safeIframe)location.href=bckUrl;else{var error=function(){GeleSocial.autoLogin();}
$("body").append("<iframe src=\""+bckUrl+"\" name=\"iframe\" width=\"0\" height=\"0\" scrolling=\"No\" frameborder=\"0\" id=\"iframe\" ></iframe>");}}
window.filters.add("autoLogout.safeIframe",function(data){if(GeleSocial.settings.autoLogout&&GeleSocial.settings.autoLogout.safeIframe){data.ret=true;}});GeleSocial.refreshSession=function(cb){var cookie=GeleSocial.getCookie(GeleSocial.settings.kw_cookie);if(!cookie){if(cb)cb();return;}
$.ajax({data:{"session":cookie,"nobckurl":"init","autologin":"true"},url:GeleSocial.settings.baseUrlSocial+"logout.php",success:cb,error:cb})};GeleSocial.autoLogin=function(backurl,modal){GeleSocial.autoLogin=function(){};GeleSocial.getUser(function(){},true);var callback=function(){if(backurl){if(!modal){window.location.href=backurl;}else{GeleSocial.openModal(backurl);}
return;}
var me=window.GeleSocial;if(me.status.autologinDone)return;me.status.autologinDone=true;if(GeleSocial.settings.kwdnt)GeleSocial.setGigyaBlocked(true);else GeleSocial.getLoginStatus();}
var barrier=new GeleSocial.Barrier();var add=function(){barrier.addCallback();}
var complete=function(){barrier.completed();}
add();GeleSocial.getUser(function(){complete();});filters.exec("autoLogin.reloadUser",{add:add,complete:complete});barrier.wait(callback);}
GeleSocial.readSocialData=function(){var me=this;var hasSocialData=false;var hasRedis=!GeleSocial.ws.settings.preloadRedis||!GeleSocial.canReadBoxData();var myCallback=function(){if(!hasSocialData||!hasRedis)return;me.status.transitional=false;GeleSocial.notifyStatusChange();if(GeleSocial.status.logged)$("body").addClass("logged");}
GeleSocial.withSocialData(function(){hasSocialData=true;myCallback();});if(!hasRedis)GeleSocial.getPageCookies(undefined,function(){hasRedis=true;myCallback();});}
GeleSocial.checkIgnoreLogged=function(){var me=this;if(me.settings.ignoreLogged||me.status.ignoreLogged){me.status.logged=false;me.status.gigya.preventAutologin=true;}}
GeleSocial.resetUser=function(){var me=GeleSocial;me.status.logged=false;me.status.user=undefined;me.status.gigya.logged=false;me.status.gigya.user=undefined;}
GeleSocial.checkStatus=function(user){var me=this;if(user&&user.user){me.status.logged=true;me.status.user=user;}
if(GeleSocial.ws.settings.CHECK_REDIS&&!GeleSocial.utils.isNull(me.status.user)){var errorCode=GeleSocial.checkRedisError();if(errorCode){if(errorCode==600){me.status.redisError=true;}else{me.status.ignoreLogged=true;}}}
GeleSocial.checkIgnoreLogged();if(me.status.gigya.user&&me.status.gigya.user.UID&&me.status.user&&me.status.user["user"]){var user=me.status.user["user"];var user1=Crypto.MD5(me.status.gigya.user.UID);if(user1==user){me.status.gigya.sameUser=true;}}
me.status.loaded=true;}
GeleSocial.defaultBackUrl=function(action){var backurl;if(GeleSocial.settings.backurl)backurl=GeleSocial.settings.backurl;if(action&&action=="login"&&GeleSocial.settings.backurlLogin)backurl=GeleSocial.settings.backurlLogin;else if(action&&action=="logout"&&GeleSocial.settings.backurlLogout)backurl=GeleSocial.settings.backurlLogout;else if(!backurl)backurl=window.locationHrefWithoutHash();return backurl;}
GeleSocial.loginUrl=function(backurl){if(!backurl){backurl=GeleSocial.defaultBackUrl("login");}
return window.filters.exec("loginUrl.return",backurl);}
GeleSocial.loginUrl.addReturnFilter=function(filter){window.filters.add("loginUrl.return",filter)};GeleSocial.logOutUrl=function(backurl){if(!backurl){backurl=GeleSocial.defaultBackUrl("logout");}
return window.filters.exec("logOutUrl.return",backurl);}
GeleSocial.logOutUrl.addReturnFilter=function(filter){window.filters.add("logOutUrl.return",filter)};GeleSocial.logOut=function(backurl,callback,autoLogout){GeleSocial.interface.logOut(backurl,callback,autoLogout);}
GeleSocial.getUser=function(callback,force){var ret=null;var cb1=function(user){ret=user;if(callback)callback(user);}
GeleSocial.interface.getUser(cb1,force);return ret;}
GeleSocial.isLogged=function(){var me=this;return me.status.logged;}
GeleSocial.isLoggedSocial=function(){var me=this;return me.status.gigya.logged&&me.status.gigya.sameUser;}
GeleSocial.checkRedisError=function(){var res=GeleSocial.getPageCookies()
if(res["error_code"]){return res["error_code"];}else{return false;}}
GeleSocial.canReadBoxData=function(){return GeleSocial.isLogged();}
GeleSocial.getCookie=function(pageKey){var cookieValue=$.cookie(pageKey);return cookieValue;}
GeleSocial.getCookieSession=function(){var cookie_name=GeleSocial.settings.kw_cookie+"-SESSION";return GeleSocial.getCookie(cookie_name)=="true";}
GeleSocial.setCookie=function(pageKey,value,days,domain,path){try{var params={};if(!GeleSocial.utils.isNull(days)&&(typeof days==="number"))
$.extend(params,{expires:days});if(!GeleSocial.utils.isNull(domain))
$.extend(params,{domain:domain});if(!GeleSocial.utils.isNull(path))
$.extend(params,{path:path});return $.cookie(pageKey,value,params);}catch(e){GeleSocial.logger.log("ATTENZIONE! COOKIE NON SALVATO!");}}
GeleSocial.deleteCookie=function(name,expires,domain,path){$.cookie(name,"",{expires:-1,domain:domain,path:path});}
GeleSocial.local={};GeleSocial.local.getPageCookies=function(cb){if(!GeleSocial.settings.pageId||!window.localStorage){cb({});return{};}
var id=GeleSocial.settings.pageId;var ret=window.localStorage.getItem("GeleSocial."+id);try{ret=JSON.parse(ret);}catch(e){ret={};}
if(!ret)ret={};if(cb)cb(ret);return ret;}
GeleSocial.local.deletePageCookies=function(){if(!window.localStorage){GeleSocial.openLoginModal();return;}
if(!GeleSocial.settings.pageId){return;}
var id=GeleSocial.settings.pageId;window.localStorage.removeItem("GeleSocial."+id);}
GeleSocial.local.setPageCookies=function(values){if(!window.localStorage){GeleSocial.openLoginModal();return;}
if(!GeleSocial.settings.pageId){return;}
var id=GeleSocial.settings.pageId;try{values=JSON.stringify(values);}catch(e){values=JSON.stringify({});}
window.localStorage.setItem("GeleSocial."+id,values);}
GeleSocial.local.deleteBoxCookie=function(box){var cookies={};var boxKey=GeleSocial.ws.getBoxKey(box);GeleSocial.local.getPageCookies(function(cookies1){cookies=cookies1;});delete cookies[boxKey];GeleSocial.local.setPageCookies(cookies);}
GeleSocial.local.getBoxCookie=function(box,success){var boxKey=GeleSocial.ws.getBoxKey(box);var ret=GeleSocial.local.getPageCookies(function(cookies){if(success)success(cookies&&cookies[boxKey]||{});});return ret&&ret[boxKey]||{};}
GeleSocial.local.setBoxCookie=function(box,values){var boxKey=GeleSocial.ws.getBoxKey(box);var cookies={};var ret=GeleSocial.local.getPageCookies(function(cookies1){cookies=cookies1;});cookies[boxKey]=values;GeleSocial.local.setPageCookies(cookies);}
GeleSocial.getPageCookies=function(force,success){force=(!GeleSocial.utils.isNull(force))?force:false;if(!force&&this._pageCookies){if(success)success(this._pageCookies);return this._pageCookies;}else{var ret={};if(this.canReadBoxData()){var parameters={};parameters['page']=this.settings.pageId;GeleSocial.ws.redis(parameters,function(ret){if(!GeleSocial.utils.isNull(ret)&&!GeleSocial.utils.isNull(ret['boxes'])){ret=ret['boxes'];}
var local=GeleSocial.local.getPageCookies();for(var k in local)if(!(k in ret))ret[k]=local[k];GeleSocial._pageCookies=ret;if(success)success(GeleSocial._pageCookies);});}else{ret=GeleSocial.local.getPageCookies(success);}
return ret;}}
GeleSocial.deleteBoxCookie=function(box){var boxKey=GeleSocial.ws.getBoxKey(box);if(boxKey!=null){var ret=null;if(this.canReadBoxData()){var parameters={};parameters['page']=this.settings.pageId;parameters['delete']=1;parameters['box']=boxKey;delete this.getPageCookies()[boxKey];ret=GeleSocial.ws.redisPost(parameters);}else{ret=GeleSocial.local.deleteBoxCookie(box);}
if(this._cookieListeners){jQuery.each(this._cookieListeners,function(i,a){if(a&&a.onCookieDeleted)a.onCookieDeleted(boxKey);});}
return ret;}}
GeleSocial.deletePageCookies=function(){if(this.canReadBoxData()){var parameters={};parameters['page']=this.settings.pageId;parameters['delete']=1;var _this=this;var pageCookies=jQuery.extend({},GeleSocial.getPageCookies());delete this._pageCookies;var ret=GeleSocial.ws.redisPost(parameters);jQuery.each(pageCookies,function(k,v){if(_this._cookieListeners){jQuery.each(_this._cookieListeners,function(i,a){if(a&&a.onCookieDeleted)a.onCookieDeleted(k);});}});return ret;}else{GeleSocial.local.deletePageCookies();}}
GeleSocial.getBoxCookie=function(box,force,success){force=(!GeleSocial.utils.isNull(force))?force:false;var boxKey=GeleSocial.ws.getBoxKey(box);var transform=function(data){data=data[boxKey];if(data===undefined)data={};return data;}
var success1=function(data){data=transform(data);if(success){if(!data||$.isEmptyObject(data))GeleSocial.local.getBoxCookie(box,success);else success(data);}}
var ret=this.getPageCookies(force,success1);ret=transform(ret);if(!ret)ret=GeleSocial.local.getBoxCookie(box,success);return ret;}
GeleSocial.setBoxCookie=function(box,values){var boxKey=GeleSocial.ws.getBoxKey(box);if(boxKey!=null){GeleSocial.logger.log(this.canReadBoxData());if(this.canReadBoxData()==true){GeleSocial.logger.log("setBoxCookie - canReadBoxData=true");if(!GeleSocial.utils.isNull(values)){var parameters={};parameters['page']=this.settings.pageId;parameters['box']=boxKey;this.getPageCookies()[boxKey]=values;GeleSocial.ws.redisPost(parameters,values);}else{this.deleteBoxCookie(boxKey);}}else{GeleSocial.local.setBoxCookie(box,values);this.getPageCookies()[boxKey]=values;}
if(this._cookieListeners){jQuery.each(this._cookieListeners,function(i,a){if(a&&a.onCookieSet)a.onCookieSet(boxKey,values);});}}}
GeleSocial.render=function(parameters,f){if(!GeleSocial.utils.isNull(f)&&!GeleSocial.utils.isNull(parameters)&&$.isFunction(f))
f(parameters);}
GeleSocial.render.FB_ACTIVITYFEED_PLUGIN="fb:activity";GeleSocial.render.FB_LIKE_PLUGIN="fb:like";GeleSocial.render.FB_SEND_PLUGIN="fb:send";GeleSocial.render.FB_LIKE_BOX_PLUGIN="fb:like-box";GeleSocial.render.FB_LOGIN_PLUGIN="fb:login-button";GeleSocial.render.FB_RECOMMENDATION_PLUGIN="fb:recommendations";GeleSocial.render.FB_FACEPILE_PLUGIN="fb:facepile";GeleSocial.render.FB_COMMENTS_PLUGIN="fb:comments";GeleSocial.render.pluginString=function(type,parameters,content){var parametersString=this._buildSocialPluginParameters(parameters);if(GeleSocial.utils.isNull(content))content='';return'<'+type+' '+parametersString+'>'+content+'</'+type+'>';}
GeleSocial.render.plugin=function(type,id,parameters,content,logged){if(!GeleSocial.utils.isNull(id)&&$(id).length!=0){$(id).hide();var pluginString=this.pluginString(type,parameters,content);$(id).html(pluginString);if(!GeleSocial.utils.isNull(logged)&&!logged){$(id).addClass("fb-plugin");$(id).show();}else{$(id).addClass("fb-plugin-logged");}}}
GeleSocial.render.activityFeedString=function(parameters,content){return this.pluginString(this.FB_ACTIVITYFEED_PLUGIN,parameters,content);}
GeleSocial.render.loginString=function(parameters,content){return this.pluginString(this.FB_LOGIN_PLUGIN,parameters,content);}
GeleSocial.render.sendButtonString=function(parameters){return this.pluginString(this.FB_SEND_PLUGIN,parameters,'');}
GeleSocial.render.likeButtonString=function(parameters){return this.pluginString(this.FB_LIKE_PLUGIN,parameters,'');}
GeleSocial.render.likeBoxString=function(parameters){return this.pluginString(this.FB_LIKE_BOX_PLUGIN,parameters,'');}
GeleSocial.render.recommendationsString=function(parameters){return this.pluginString(this.FB_RECOMMENDATION_PLUGIN,parameters,'');}
GeleSocial.render.facePileString=function(parameters){return this.pluginString(this.FB_FACEPILE_PLUGIN,parameters,'');}
GeleSocial.render.activityFeed=function(id,parameters,logged){GeleSocial.render.plugin(this.FB_ACTIVITYFEED_PLUGIN,id,parameters,'',logged);}
GeleSocial.render.recommendations=function(id,parameters,logged){return this.plugin(this.FB_RECOMMENDATION_PLUGIN,id,parameters,'',logged);}
GeleSocial.render.likeButton=function(id,parameters,logged){GeleSocial.render.plugin(this.FB_LIKE_PLUGIN,id,parameters,'',logged);}
GeleSocial.render.loginButton=function(id,parameters,content,logged){GeleSocial.render.plugin(this.FB_LOGIN_PLUGIN,id,parameters,content,logged);}
GeleSocial.render.facePile=function(id,parameters,logged){GeleSocial.render.plugin(this.FB_FACEPILE_PLUGIN,id,parameters,'',logged);}
GeleSocial.render.comments=function(id,parameters,logged){GeleSocial.render.plugin(this.FB_COMMENTS_PLUGIN,id,parameters,'',logged);}
GeleSocial.render._buildSocialPluginParameters=function(parameters){parametersString="";if(!GeleSocial.utils.isNull(parameters)){$.each(parameters,function(key,value){parametersString+=key+'="'+value+'" ';});}
return parametersString;}
GeleSocial.ws={}
GeleSocial.ws.settings={BASE_URL:"",REDIS:"redis.php",LOGOUT:"logout.php"};GeleSocial.ws.TYPE_JSON="json"
GeleSocial.ws.init=function(settings){if(!GeleSocial.utils.isNull(settings)){this.settings=$.extend(this.settings,settings);}}
GeleSocial.ws.buildParametersPost=function(values){var me=this;var string="";var oLength=GeleSocial.utils.getObjectLength(values);if(typeof values!='undefined'&&values!=null){var index=0;var ret=[];$.each(values,function(key,value){ret.push([key,value]);});string=JSON.stringify(ret);}
return string;}
GeleSocial.ws.getParameterPost=function(string){var me=this;var map={};if(!GeleSocial.utils.isEmptyString(string)){GeleSocial.logger.log(string);try{var val=JSON.parse(string).params;for(var i=0;i<val.length;i++){var val1=val[i];if(val1.length==2){var key=val1[0];var value=val1[1];if(!GeleSocial.utils.isNull(key))map[key]=value;}}}catch(e){}}
return map;}
GeleSocial.ws.getBoxKey=function(boxName){if(!GeleSocial.utils.isEmptyString(boxName)){var key=boxName.toLowerCase();key=key.replace(" ","_");key=key.replace("__","_");return key;}
return null;}
GeleSocial.ws.jsonpCall=function(service,f,params){if(!GeleSocial.utils.isNull(f)&&!GeleSocial.utils.isNull(params)&&!GeleSocial.utils.isNull(params)){var parameters={};if(!GeleSocial.utils.isNull(params)){parameters=$.extend(parameters,params);}
$.getJSON(this.settings.BASE_URL+service+"?jsoncallback=?",parameters,function(data){f(data);});}}
GeleSocial.ws.comments={};GeleSocial.ws.comments.renderTopCommentedBox=function(selector,wsParams){if($(selector).length==0){return;}
var wsUrl=GeleSocial.settings.baseUrlSocial+"boxes/comments/top-commented.cache.php";if(wsParams===undefined){wsParams={};}
$.ajax({url:wsUrl,data:wsParams,dataType:"html",success:function(response){$(selector).empty().append(response);}});}
GeleSocial.ugc={};GeleSocial.ugc.renderForm=function(params){var document=document;if(params.containerDocument)document=params.containerDocument;var containerID=params.containerID;if(!containerID)return;var container=$("#"+containerID,document);if(container.length==0)return;var logged=GeleSocial.isLogged();if(!logged&&params.ugcParams.commentiSSO!==false){if(params.notlogged)params.notlogged(container);return;}
var renderForm1=function(){var ugcParams=params.ugcParams;var commentUrl=GeleSocial.settings.baseUrlSocial+"comment.php";var data={tipo:"commento"};if(params.tipo)data.tipo=params.tipo;var obbligatoriOgg={"commento":["commento"],"upload":["titolo","commento","immagine"]};if(params.obbligatori)jQuery.extend(obbligatoriOgg,params.obbligatori);if(data.tipo&&obbligatoriOgg[data.tipo]){obbligatori=obbligatoriOgg[data.tipo];}else{obbligatori=obbligatoriOgg["commento"];}
data.idarticolo=ugcParams.idarticolo;data.brand=ugcParams.brand;if(ugcParams.title)data.threadtitolo=ugcParams.title;if(ugcParams.desc)data.threaddesc=ugcParams.desc;if(ugcParams.origin)data.threadarturl=ugcParams.origin;if(ugcParams.commentiSSO===false&&ugcParams.nickname)data.nickname=ugcParams.nickname;if(!data.idarticolo||!data.brand)return;if(params.logged){params.logged(container);}
var form=container.find("form");var title=form.find('*[name="titolo"]').last();var immagine=form.find('*[name="immagine"]').last();var comment=form.find('*[name="commento"]').last();var tag=form.find('*[name="tag"]').last();var fields={"titolo":title,"commento":comment,"immagine":immagine,"tag":tag};var submit=form.find('input[type="submit"]');form.find('*[name="submit"]').attr("name","submit2");var boxContaCaratteri=null;var updateText=null;var contaCaratteri=function(maxChars){if(!params.contaCaratteri.containerID)return;boxContaCaratteri=container.find("#"+params.contaCaratteri.containerID);updateText=function(){var text=comment.val();var len=text.length;var diff=maxChars-len;if(diff>=0){boxContaCaratteri.html('Caratteri disponibili: <strong>'+diff+'</strong>');}else{boxContaCaratteri.html("<font color='#991010'>Attenzione! Hai superato il limite di <strong>"+maxChars+"</strong>&nbsp;&nbsp;caratteri</font>");}
if(len>maxChars)comment.val(text.substring(0,maxChars));};updateText();comment.keyup(updateText);}
if(comment.length>0&&params.contaCaratteri){$.ajax({type:'GET',url:commentUrl,data:{"idarticolo":data.idarticolo,"brand":data.brand},dataType:"json",success:function(data){if(data.lunghezzatesto){contaCaratteri(data.lunghezzatesto);}}});}
if(window.gsPlugins&&params.socialShare)window.gsPlugins.comments.enrichForm(form,params.socialShare);var clear=function(inputs){$.each(inputs,function(i,input){try{$(input).val("");$(input).removeAttr("disabled");}catch(e){}});if(boxContaCaratteri){boxContaCaratteri.html('');updateText();}}
var clearErrors=function(inputs){$.each(inputs,function(i,input){try{$(input).removeClass("gs-error");$(input).removeAttr("data-error");}catch(e){}});form.find(".gs-error-label").remove();}
var success1=function(){GeleSocial.openCommentSent();}
var error1=function(){GeleSocial.openMessageModal(undefined,800,300,undefined,true);}
var loading=function(){GeleSocial.openSendingComment();}
var messageBox=container.find(".gs-message-box");if(messageBox.length>0){messageBox=new GeleSocial.MessageBox(messageBox);success1=function(){messageBox.setLoading(false);messageBox.setError(false);messageBox.setVisible(true);messageBox.setMessage("Contributo pubblicato correttamente")
setTimeout(function(){messageBox.setVisible(false);},2000);}
error1=function(data){messageBox.setLoading(false);messageBox.setError(true);messageBox.setVisible(true);var message="Siamo spiacenti, si è verificato un errore";if(data&&data['error_code']=="error_posting_message"){message="Errore nella pubblicazione";if(data['error_msg']!="error_posting_message")message=data['error_msg'];}else if(data&&data['error_code']=="error_validating"){message=data['error_msg'];}
messageBox.setMessage(message);setTimeout(function(){messageBox.setVisible(false);},2000);}
loading=function(){messageBox.setLoading(true);messageBox.setVisible(true);messageBox.setMessage("Invio in corso...");}}
var success=function(){submit.removeAttr('disabled');success1();clear(fields);}
var error=function(data){submit.removeAttr('disabled');error1(data);GeleSocial.logger.error("errore post commento:");GeleSocial.logger.error("data="+data);}
var validate=function(fields,data1){var error=false;if(obbligatori){$.each(obbligatori,function(i,fname){var value=null;var field=fields[fname];if(data1[fname])value=data1[fname];else if(field)value=field.val();if(value)value=$.trim(value);if(value.length==0){error=true;if(field){field.attr("data-error","Campo obbligatorio");field.addClass("gs-error");}}});}
return error;}
var checkPrepend=function(fields,prepend,data){if(!prepend)return;jQuery.each(fields,function(fname,field){if(prepend[fname]){var value=$.trim(field.val());var value1=prepend[fname];if(value.length>0){value1+=" "+value;}
data[fname]=value1;field.attr("disabled","disabled");}});}
var onsubmit=function(ev){var data1=jQuery.extend({},data);clearErrors(fields);checkPrepend(fields,params.prepend,data1);var validateError=validate(fields,data1);if(validateError){if(params.validationError)params.validationError(form);submit.removeAttr('disabled');return false;}
loading();GeleSocial.utils.noCSRF(data1);var submitParams={type:'POST',url:commentUrl,data:data1,dataType:"json",success:function(data){if(data&&data.error===false){GeleSocial.logger.log("Risultato post commento:");GeleSocial.logger.log(data);success();}else{error(data);}},error:error};jQuery(form).ajaxSubmit(submitParams);return false;}
form.submit(onsubmit);}
var formDependencies=[[GeleSocial.settings.socialPathBase+'/common/js/jquery.plugin/jquery.form.js',function(){return $.fn.ajaxForm;}]];var barrier=new GeleSocial.Barrier();GeleSocial.dependencies.loadDependecies(formDependencies,barrier);barrier.wait(renderForm1);}
GeleSocial.ws.logOutUrl=function(backUrl,autologout){var baseUrl=this.settings.BASE_URL;var external=GeleSocial.settings.external;if(!baseUrl)baseUrl=GeleSocial.settings.baseUrlSocial;var cookie_name=GeleSocial.settings.kw_cookie;var cookie_val=GeleSocial.getCookie(cookie_name);var ret=baseUrl+this.settings.LOGOUT+"?";if(cookie_val)ret+="session="+encodeURIComponent(cookie_val)+"&";ret+="bckurl="+encodeURIComponent(backUrl);if(autologout)ret+="&autologout=true";return ret;}
GeleSocial.ws.logout=function(parameters){if(parameters&&parameters['bckurl']){var backUrl=parameters['bckurl'];var logoutUrl=GeleSocial.ws.logOutUrl(backUrl,parameters.autologout);if(!GeleSocial.settings.backurlIframe)
window.top.location.href=logoutUrl;else
location.href=logoutUrl;}}
GeleSocial.ws.redis=function(parameters,callback){var dataRet=null
if(!GeleSocial.utils.isNull(parameters)){parameters.domain=location.protocol+"//"+location.hostname;if(location.port)parameters.domain+=":"+location.port;$.ajax({url:this.settings.BASE_URL+this.settings.REDIS,async:true,data:parameters,dataType:'json',xhrFields:{withCredentials:true},success:function(data){if(GeleSocial.ws.isJsonError(data)){if(data["error_code"]==200){dataRet={"boxes":{}}}else{GeleSocial.logger.log(data['error_msg']);dataRet=data;}}else{GeleSocial.logger.log(data);dataRet=data;}
if(callback)callback(dataRet);}});}
return dataRet;}
GeleSocial.ws.redisPost=function(parameters,values){var dataRet=false;if(!GeleSocial.utils.isNull(values)&&GeleSocial.utils.getObjectLength(values)>0){valuesString=this.buildParametersPost(values);parameters['params']=valuesString;}
if(!GeleSocial.utils.isNull(parameters)){if(!GeleSocial.utils.isNull(GeleSocial.settings.kw_cookie)&&!GeleSocial.utils.isNull($.cookie(GeleSocial.settings.kw_cookie))){GeleSocial.utils.noCSRF(parameters);parameters.domain=location.protocol+"//"+location.hostname;if(location.port)parameters.domain+=":"+location.port;$.ajax({type:"POST",url:this.settings.BASE_URL+this.settings.REDIS,data:parameters,xhrFields:{withCredentials:true},success:function(data){dataRet=GeleSocial.ws.isJsonError(data);}});}}
return dataRet;}
GeleSocial.ws.isJsonError=function(json){if(!GeleSocial.utils.isNull(json)&&json['error']=="true"){return true;}else if(GeleSocial.utils.isNull(json)){return true;}
return false;}
GeleSocial.getOrigin=function(){var protocol="http://";var string=protocol;var url=location.href;var indexProtocol=url.indexOf(protocol);if(indexProtocol!=-1){var protocolLength=protocol.length;var cleanUrl=url.substring(indexProtocol+protocolLength,url.length);var d=cleanUrl.split("/",2);i=0;$.each(d,function(index){string+=d[index];if(i<d.length-1)string+="/";i++;});}else{string=url;}
return string;}
GeleSocial.utils={}
GeleSocial.utils.isNull=function(v){return!(!typeof(v)!='undefined'&&v!=null&&v!="null");}
GeleSocial.utils.isObjectNull=function(v){return GeleSocial.utils.getObjectLength(v)==0;}
GeleSocial.utils.getObjectLength=function(obj){var size=0,key;for(key in obj){size++;}
return size;}
GeleSocial.utils.isEmptyString=function(v){return!(!GeleSocial.utils.isNull(v)&&$.trim(v)!="");}
GeleSocial.utils.regExpQuote=function(str){return str.replace(/([.?*+^$[\]\\(){}-])/g,"\\$1");}
GeleSocial.utils.noCSRF=function(parameters){parameters[GeleSocial.settings.kw_cookie]=$.cookie(GeleSocial.settings.kw_cookie);}
if(window.Shadowbox)window.Shadowbox.init({skipSetup:true});$.extend({GeleSocial:function(settings){GeleSocial.init(settings);}});window.Counter=function(sec,url,options){this.seconds=sec+1;this.url=url;this.defOptions={time:1000,finalTime:3000,finalValue:0,step:-1,messageId:"#message",timeId:"#seconds",messageRedirect:"Redirect in corso..."}
this.options=$.extend(this.defOptions,options);this.isLastItem=function(){if(this.options.step>0){return this.seconds<=this.options.finalValue;}else{return this.seconds>=this.options.finalValue;}}
this.countdown=function(){this.seconds=this.seconds+this.options.step;if(this.isLastItem()){$(this.options.timeId).html(this.seconds);setTimeout(function(thisObj){thisObj.countdown();},this.options.time,this);}else{$(this.options.messageId).html(this.options.messageRedirect);setTimeout("location.href=\""+this.url+"\"",this.options.finalTime);}}}})();;
(function(){window.RenderSocial=function(){}
var RenderSocial=window.RenderSocial;RenderSocial.APP_ID="2_f2dVDjSaZJfKNEEXrNo2D5Ddq9SOrxbbavtbRsi9p9rVZlG6PcIXdATccwuSQsc5";RenderSocial.COOKIE_NAME="KWSOCIAL";RenderSocial.COOKIE_DOMAIN=".repubblica.it";RenderSocial.NAVID_COOKIE_NAME="navid";RenderSocial.BASEURL=location.protocol+"//"+document.domain+"/";RenderSocial.BASEURL_SOCIAL=location.protocol+"//"+document.domain+"/social/sites/repubblica/nazionale/";RenderSocial.MAIN_SITE_BASEURL="https://www.repubblica.it/";RenderSocial.MAIN_SITE_BASEURL_SOCIAL="https://www.repubblica.it/social/sites/repubblica/nazionale/";RenderSocial.PROFILE_PAGE="https://quotidiano.repubblica.it/edicola/profilo/profiloutente.jsp";RenderSocial.LOGIN_PAGE="https://quotidiano.repubblica.it/edicola/funnel/login.jsp";RenderSocial.SSO_DOMAIN="https://login.kataweb.it";RenderSocial.SSO_SERVICE_LOGIN="repubblica.it";RenderSocial.REGISTRATION_PAGE="https://login.kataweb.it/registrazione/repubblica.it/privato.jsp";RenderSocial.FUNNEL_TOKEN_LOGIN="repnzfree";RenderSocial.FUNNEL_TOKEN_REGISTRATION="repnzfreereg";RenderSocial.FUNNEL_TOKEN_SUBSCRIPTION="repnz1wweb";RenderSocial.FUNNEL_PRODUCT_ID="REP_SIT_1W.0";RenderSocial.FUNNEL_MANAGER_PAGE="https://quotidiano.repubblica.it/edicola/manager";RenderSocial.FUNNEL_MANAGER_ERROR="https://quotidiano.repubblica.it/edicola/errore.jsp";RenderSocial.FUNNEL_ORIGIN_PREFIX="RIT_";RenderSocial.WT_ORIGIN_URL=encodeURIComponent((window.location.host+window.location.pathname).replace(/\./g,'_'));RenderSocial.LOGIN_FORWARD=(typeof window.loginForward!="undefined")?window.loginForward:false;window.gsPluginsConf=window.gsPluginsConf||{};window.gsPluginsConf.gsFacebookAppId="182234715127717";RenderSocial.boxCookieName={"repubblica_oroscopo":"Oroscopo","repubblica_borsa":"Borsa","repubblica_sport_squadra":"Squadra","box-meteo-sidebar":"Meteo","adagio_box_locali":"Edizioni Locali"};RenderSocial.REDIS_PAGE_ID="repubblica_social";RenderSocial.SOCIAL_DIV=".render-social";RenderSocial.BREAKING_NEWS_ID="breaking-news";RenderSocial.USER_ACCESS_ID="user-access";RenderSocial.STATUS_BAR_CLASS="status-bar";RenderSocial.SHOWHIDE_OFF_CLASS="showhide-off";RenderSocial.TOOLBAR_SOCIAL_ID="toolbar-social";RenderSocial.TOOLBAR_SOCIAL_BOXES_CLASS="arrow";RenderSocial.TOOLBAR_SOCIAL_CONTAINER_CLASS=".from-generic-box";RenderSocial.TOOLBAR_SHOWHIDE_CLASS="toolbar-showhide";RenderSocial.RECOMMENDATIONS_DETAIL_ID="reccomandations-detail-box";RenderSocial.TOP_COMMENTED_SELECTOR="#gs-top-commented-box";RenderSocial.TOP_COMMENTED_PARAMS={tpl:'default'};RenderSocial.FRIENDS_ACTIVITY="https://quotidiano.repubblica.it/edicola/profilo/profiloutente.jsp";RenderSocial.SOCIAL_DATA="https://www.repubblica.it/social/sites/repubblica/nazionale/social_data.cache.php";RenderSocial.BREAKING_NEWS="https://www.repubblica.it/__zona/ultimora.html";RenderSocial.SSO_DOMAIN="https://login.kataweb.it";RenderSocial.SSO_SERVICE_LOGIN="repubblica.it";RenderSocial.REGISTRATION_PAGE="https://login.kataweb.it/registrazione/repubblica.it/privato.jsp";RenderSocial.CUSTOM_CENTER_DIV_ID="content-center";RenderSocial.DISABLE_AUTO_LOGIN=[];RenderSocial.DISABLE_BOXES=false;RenderSocial.disableBoxes=function(){if(!RenderSocial.DISABLE_BOXES)return false;else{if(RenderSocial._hasToDisableBoxes===undefined){RenderSocial._hasToDisableBoxes=GeleSocial.ignoreRulesMatch(["^.*$"]);}
return RenderSocial._hasToDisableBoxes;}}
RenderSocial.getCommonSettings=function(){var settings={appId:RenderSocial.APP_ID,pageId:RenderSocial.REDIS_PAGE_ID,kw_cookie:RenderSocial.COOKIE_NAME,kw_navid_cookie:RenderSocial.NAVID_COOKIE_NAME,baseUrlSocial:RenderSocial.BASEURL_SOCIAL,mainSiteBaseUrl:RenderSocial.MAIN_SITE_BASEURL,mainSiteBaseUrlSocial:RenderSocial.MAIN_SITE_BASEURL_SOCIAL,profilePage:RenderSocial.PROFILE_PAGE,loginPage:RenderSocial.LOGIN_PAGE,registrationPage:RenderSocial.REGISTRATION_PAGE,ssoDomain:RenderSocial.SSO_DOMAIN,ssoServiceLogin:RenderSocial.SSO_SERVICE_LOGIN,ssoServiceRegistration:RenderSocial.SSO_SERVICE_REGISTRATION,ssoMaster:true,autoLogin:{safeIframe:true},autoLogout:{safeIframe:true}};return settings;}
RenderSocial.init=function(page){if(window.GeleSocial){GeleSocial.addStatusChangeListener(page,RenderSocial.statusChangeCallback);var settings=RenderSocial.getCommonSettings();settings.external=true;GeleSocial.init(settings);}}
RenderSocial.renderGigyaComments=function(){if(window.gigyaCommentParams&&(window.gigyaCommentParams.category||window.gigyaCommentParams.categoryID)){if(!gigyaCommentParams.categoryID)gigyaCommentParams.categoryID=gigyaCommentParams.category;delete gigyaCommentParams.category;if(!gigyaCommentParams.width)gigyaCommentParams.width=642;if(gigyaCommentParams.gsNoModerationText===undefined)gigyaCommentParams.gsNoModerationText=true;GeleSocial.gigya.showCommentsUI(null,{"origin":RenderSocial.FUNNEL_ORIGIN_PREFIX+"Comm","urlToken":RenderSocial.FUNNEL_TOKEN_LOGIN});}}
RenderSocial.tooltip={};RenderSocial.tooltip.edizioniLocali=function(){if(typeof guiders!='undefined'){guiders.createGuider({attachTo:".edizionilocali",buttons:[{name:"Chiudi finestra",onclick:guiders.hideAll}],description:"",id:"locali",position:3,title:"Scegli la città di tuo interesse",width:400});}}
RenderSocial.tooltip.calcio=function(){if(typeof guiders!='undefined'){guiders.createGuider({attachTo:".calcio",buttons:[{name:"Chiudi finestra",onclick:guiders.hideAll}],description:"",id:"calcio",position:3,title:"Scegli la tua squadra preferita",width:400});}}
RenderSocial.tooltip.meteo=function(){if(typeof guiders!='undefined'){guiders.createGuider({attachTo:".meteo",buttons:[{name:"Chiudi finestra",onclick:guiders.hideAll}],description:"",id:"meteo",position:3,title:"Scegli la località di tuo interesse",width:400});}}
RenderSocial.tooltip.oroscopo=function(){if(typeof guiders!='undefined'){guiders.createGuider({attachTo:".oroscopo",buttons:[{name:"Chiudi finestra",onclick:guiders.hideAll}],description:"",id:"oroscopo",position:3,title:"Scegli il segno zodiacale",width:400});}}
RenderSocial.renderProfilePlugs=function(){var logged=GeleSocial.isLogged();var html='<ul class="logfb-boxes">\
            <!-- meteo-->\
            <ul class="box meteo" id="meteo-plug">\
                <li class="title">\
                    <dl class="clearfix">\
                        <dt><a title="" href="http://meteo.repubblica.it/">Meteo</a></dt>\
                        <dd><a title="Cambia città" href="javascript:void(0);">[Cambia città]</a></dd>\
                    </dl>\
                </li>\
                <li>\
                    <p class="benefit">Inserisci il comune di cui vuoi le previsioni meteo\
                        <a rel="shadowbox;height=700;width=900" class="plug_link set_box" href="javascript:void(0)">Scegli la città</a>\
                    </p>\
                </li>\
            </ul>\
            <div id="meteo-container">\
            </div>\
            <!-- oroscopo-->\
            <ul id="oroscopo-plug" class="box oroscopo">\
                <li class="title">\
                    <dl class="clearfix">\
                        <dt><a title="" href="http://oroscopo.seidimoda.repubblica.it/">Oroscopo</a></dt>\
                        <dd><a title="scegli il tuo segno zodiacale" href="javascript:void(0);">[Scegli segno]</a></dd>\
                    </dl>\
                </li>\
                <li>\
                    <p class="benefit">\
                        Scegli un segno per iniziare ogni giorno con il tuo oroscopo\
                        <a rel="shadowbox;height=700;width=900" class="plug_link set_box" href="javascript:void(0)">Scegli un segno</a>\
                    </p>\
                </li>\
            </ul>\
            <div id="oroscopo-container">\
            </div>\
        </ul>';html=$(html);html.find("#locali-plug li.title dd").hide();html.find("#sport-plug li.title dd").hide();html.find("#meteo-plug li.title dd").hide();html.find("#oroscopo-plug li.title dd").hide();$(RenderSocial.SOCIAL_DIV).append(html);$("a.plug_link").live("click",function(){if(typeof RenderSocial.FUNNEL_TOKEN_LOGIN!='undefined'&&typeof RenderSocial.FUNNEL_ORIGIN_PREFIX!='undefined')
GeleSocial.openLoginModal(undefined,undefined,{"forward":false,"origin":RenderSocial.FUNNEL_ORIGIN_PREFIX+"SLIM","urlToken":RenderSocial.FUNNEL_TOKEN_LOGIN});else
GeleSocial.openLoginModal();});}
RenderSocial.enableProfilePlugs=function(){$("a.plug_link").die();var html=$(RenderSocial.SOCIAL_DIV);html.find("#meteo-plug li.title dd, #meteo-plug p.benefit a.plug_link").click(function(){RenderSocial.renderBoxes.showBoxPreferenceSelection("meteo",html.find("#meteo-container"),html.find("#meteo-plug"));});html.find("#meteo-plug p.benefit a.plug_link").html("Cambia città");html.find("#oroscopo-plug li.title dd, #oroscopo-plug p.benefit a.plug_link").click(function(){RenderSocial.renderBoxes.showBoxPreferenceSelection("oroscopo",html.find("#oroscopo-container"),html.find("#oroscopo-plug"));});html.find("#oroscopo-plug p.benefit a.plug_link").html("Scegli segno");html.find("#meteo-plug li.title dd").show();html.find("#oroscopo-plug li.title dd").show();RenderSocial.tooltip.oroscopo();RenderSocial.tooltip.meteo();}
RenderSocial.renderUserProfile=function(){var uName=GeleSocial.getUserNick();var socialThumb=GeleSocial.getUserThumb();var html='<dl class="avatar clearfix"><dt><img src=\"'+socialThumb+'\" alt=\"\" height=\"50\" width=\"50\" \/></dt>';html+='<dd class="user">Ciao '+uName+'!</dd>';if(!GeleSocial.status.gigya.blocked)html+='<dd><a href="javascript:GeleSocial.openModifyConnectionsModal(800,600)" title="Gestisci le connessioni ai social network">Gestione Connessioni</a></dd>';html+='<dd class="links">\
        <div class="clear"></div>\
        <a href="javascript:GeleSocial.goToMemberCenter()">Dati personali</a> | <a href="javascript:GeleSocial.sendChangePassword(true)">Modifica la password</a> | <a href="javascript:GeleSocial.logOut()"><strong>Esci</strong></a></dd>';$(RenderSocial.SOCIAL_DIV).prepend(html);$("ul.logged-ugc").css("display","block");$(RenderSocial.PP_LOGIN_2_APPROVE_DIV).css("display","block");}
RenderSocial.renderAccount=function(slim){GeleSocial.addFinalStatusCallback(function(){var cont_float=(slim)?'-float':'';var cont=$("#account-data-container"+cont_float).length>0?$("#account-data-container"+cont_float):$(".account-data-container"+cont_float);var autoclose=function(menu){$("body").on("click",function(ev){if($(ev.target).closest(menu).length==0){menu.removeClass("open");}});}
if(GeleSocial.status.logged){var uName=GeleSocial.getUserNick();var socialThumb=GeleSocial.getUserThumb();var logged=$('<span class="header-logged-label"></span>');logged.prepend(uName);cont.append(logged);var img=$('<img class="header-logged-img">');img.attr("src",socialThumb);img.css("width","20px");cont.append(img);var menu=$('<span class="header-logged-link"><a class="header-logged-profile" href="'+GeleSocial.settings.profilePage+'">PROFILO</a><a class="header-logged-logout" href="javascript:GeleSocial.logOut()">ESCI</a></span>');cont.append(menu);cont.on("click",function(){cont.toggleClass("open");});autoclose(cont);}else{var account=$('<span class="rep-icon-user"></span>');cont.append(account);var login=$('<span class="header-login-label"></span>');login.prepend("Accedi");cont.prepend(login);cont.on("click",function(){GeleSocial.openLoginModal(undefined,undefined,{"forward":RenderSocial.LOGIN_FORWARD,"origin":RenderSocial.FUNNEL_ORIGIN_PREFIX+"SLIM","urlToken":RenderSocial.FUNNEL_TOKEN_LOGIN},false,false,true);});}});RenderSocial.renderGigyaComments();}
RenderSocial.pages={"home-2016-v1":{finalized:function(){RenderSocial.renderAccount();}},"shared-header-2019":{finalized:function(){RenderSocial.renderAccount();}},"profile":{logged:function(){$(RenderSocial.SOCIAL_DIV).append('<ul class="box promo">\
    <li>Problemi tecnici? <a href="https://help.kataweb.it/assistenza/social/repubblica/richiesta.php" onclick="window.open(this.href);return false" >Contattaci</a></li>\
    </ul>');RenderSocial.renderUserProfile();displayLoggedBoxProfile();},notlogged:function(){displayNotLoggedBoxProfile();}}};RenderSocial.statusChangeCallback={downloaded:function(page){if(RenderSocial.pages[page]&&RenderSocial.pages[page].loaded){RenderSocial.pages[page].loaded(page);}},finalized:function(page){if(RenderSocial.pages.finalized)RenderSocial.pages.finalized(page);if(RenderSocial.pages[page]&&RenderSocial.pages[page].finalized){RenderSocial.pages[page].finalized(page);}},logged:function(page){if(RenderSocial.pages.logged)RenderSocial.pages.logged(page);if(RenderSocial.pages[page]&&RenderSocial.pages[page].logged){RenderSocial.pages[page].logged(page);}},notlogged:function(page){if(RenderSocial.pages.notlogged)RenderSocial.pages.notlogged(page);if(RenderSocial.pages[page]&&RenderSocial.pages[page].notlogged){RenderSocial.pages[page].notlogged(page);}}};var page="shared-header-2019";if(window.socialPage)page=socialPage;RenderSocial.init(page);})();;

(function($){$.bookmark=function(){version:'0.1'};$.bookmark.BUTTON_ID_ADD='bookmark-add';$.bookmark.BUTTON_ID_DELETE='bookmark-delete';$.bookmark.BUTTON_CONTAINER_ID='bookmark-container';$.bookmark.BUTTON_LABEL_ADD='Lo leggo dopo';$.bookmark.BUTTON_LABEL_DELETE='Cancella dai preferiti';$.bookmark.BUTTON_ADD_TEMPLATE='<a href="javascript:void(0)" class="'+$.bookmark.BUTTON_ID_ADD+'"></a>'
$.bookmark.BUTTON_DELETE_TEMPLATE='<a href="javascript:void(0)" class="'+$.bookmark.BUTTON_ID_DELETE+'"></a>'
$.bookmark.ARTICLES_MAX_LIMIT=30;$.bookmark.COOKIE_NAME='bookmark-elements';$.bookmark.SUMMARY_MAX_LENGHT=140;$.bookmark.FILED_OG_TITLE='og:title';$.bookmark.FILED_OG_URL='og:url';$.bookmark.FILED_OG_IMAGE='og:image';$.bookmark.FILED_OG_DESCRIPTION='og:description';$.bookmark.FILED_PUB_DATE='datait';$.bookmark.FILED_AUTHOR='firma';$.bookmark.FILED_AUTHOR_DEFAULT='';$.bookmark.FILED_TIMESTAMP='timestamp';$.bookmark.ACTION_MSG_ADD_NEW='L\'articolo e\' stato aggiunto con successo';$.bookmark.ACTION_MSG_ADD_ERROR='Si e\' verificato un errore nel salvataggio dell\'articolo';$.bookmark.ACTION_MSG_LIMIT_MAX='Hai raggiunto il limite massimo di articoli salvati. Prima di aggiungere un nuovo articolo e\' necessario cancellarne qualcuno dal tuo archivio';$.bookmark.ACTION_MSG_ALREADY_EXIST='L\'articolo e\' gia\' presente nel tuo archivio';$.bookmark.ACTION_MSG_DELETE='L\'articolo e\' stato cancellato con successo';$.bookmark.ACTION_MSG_DELETE_ERROR='Si e\' verificato un errore nella cancellazione dell\'articolo';$.bookmark.ACTION_MSG_ALREADY_DELETE='L\'articolo e\' gia\' stato cancellato dal tuo archivio';$.bookmark.ACTION_MSG_CONFIRM_DELETE="Sei sicuro di voler cancellare l'articolo?";$.bookmark.CUSTOM_PAGE_UL_ID='box_archive';$.bookmark.CUSTOM_PAGE_UL_CLASS='box archive';$.bookmark.CUSTOM_PAGE_HTML_CONTAINER='<!-- start bookmark --><ul class="'+$.bookmark.CUSTOM_PAGE_UL_CLASS+'" id="'+$.bookmark.CUSTOM_PAGE_UL_ID+'"></ul><div class="clear"></div><!-- end bookmark -->';$.bookmark.CUSTOM_PAGE_MAX_ITEMS=5;$.bookmark.CUSTOM_PAGE_PATTERN_PRINT='print-';$.bookmark.CUSTOM_PAGE_CLASS_PRINT='print';$.bookmark.CUSTOM_PAGE_PATTERN_DELETE='delete-';$.bookmark.CUSTOM_PAGE_CLASS_DELETE='delete';$.bookmark.CUSTOM_PAGE_POPUP_ID='bookmark-popup';$.bookmark.CUSTOM_PAGE_POPUP_CLOSE_ID='bookmark-popup-close';$.bookmark.CUSTOM_PAGE_POPUP_CLOSE_CLASS='chiudi';$.bookmark.CUSTOM_PAGE_POPUP_WIDTH=800;$.bookmark.CUSTOM_PAGE_POPUP_HEIGHT=700;$.bookmark.CUSTOM_PAGE_POPUP_URL=RenderSocial.BASEURL_SOCIAL+"print.php?u=";$.bookmark.CUSTOM_PAGE_ARTICLES_LIST_ID='bookmark-list';$.bookmark.STATUS_BAR_ARTICLES_LIST_MAX=3;$.bookmark.STATUS_BAR_EMPTY_ARTICLES="<em>Qui troverai la lista degli ultimi articoli che hai deciso di salvare</em>";$.bookmark.ARTICLE_CONTENT_WS_URL="content.json";$.bookmark.SHARE_CONTAINER_CLASS='content-share';$.bookmark.SHARE_OVERLAY_EFFECT_TIME=1000;$.bookmark.SHARE_OVERLAY_CLASS='gs-share-bookmark-container';$.bookmark.TABLE_SORTER_ID='myTable';$.bookmark.TABLE_SORTER_WIDGET='zebra';$.bookmark.MONTHS=new Array('gennaio','febbraio','marzo','aprile','maggio','giugno','luglio','agosto','settembre','ottobre','novembre','dicembre');$(function(){if($.tablesorter){$.tablesorter.addParser({id:'gs_date',is:function(s){return false;},format:function(s){var ret="1970-01-01";s=s.toLowerCase();s=s.split(" ");if(s.length<3)return ret;var month=$.bookmark.MONTHS.indexOf(s[1])+1;if(month>0){if(month<10)month="0"+month;ret=s[2]+"-"+month+"-"+s[0];}
return ret;},type:'text'});}});var settings={debug:true};var allNodes={};$.fn.bookmark=function(param){if(!param)param={};if(!window.GeleSocial)return;$.bookmark.log("init");var node=$(this);node.unbind("click");var url=$("meta[property=\""+$.bookmark.FILED_OG_URL+"\"]").attr("content");if(window.GeleSocial&&!GeleSocial.status.logged){node.each(function(i,node1){node1=$(node1);$.bookmark.setLabelAdd(function(){GeleSocial.openLoginModal();},node1,param);});}else{$.bookmark.cookie.getBoxCookie(false,function(articles){if(!$.bookmark.utils.isNull(url)&&!$.bookmark.utils.isNull(articles)){node.each(function(i,node1){node1=$(node1);var url1=url;var data={}
try{data=JSON.parse(node1.attr("data-bookmark"))}
catch(e){}
var url2=node1.attr("data-url");if(url2)url1=url2;if(data.gsUrl)url1=data.gsUrl;if(!allNodes[url1])allNodes[url1]=$([]);allNodes[url1]=allNodes[url1].add(node1);if($.bookmark.articlesAlreadyExists(articles,url1)){$.bookmark.log("articolo presente");$.bookmark.setLabelDelete(url1,node1,param);}else{$.bookmark.log("articolo nuovo");$.bookmark.setLabelAdd(undefined,node1,param);}});}});}}
$.bookmark.articlesAlreadyExists=function(articles,url){var ret=false;if(!$.bookmark.utils.isNull(articles)&&!$.bookmark.utils.isObjectNull(articles.values)){$.each(articles.values,function(i,e){if(!ret&&e[$.bookmark.FILED_OG_URL]==url)
ret=true;});}
return ret;}
$.bookmark.setLabelDelete=function(url,node,param){if(!node)node=$("#"+$.bookmark.BUTTON_CONTAINER_ID);node.html($.bookmark.BUTTON_DELETE_TEMPLATE);if(param.text!==false){node.find("a").html($.bookmark.BUTTON_LABEL_DELETE);}
node.addClass("cancel");node.unbind("click");node.click(function(){$.bookmark.deleteItem(url,node,param);});}
$.bookmark.setLabelAdd=function(click,node,param){if(!param)param={};if(!node)node=$("#"+$.bookmark.BUTTON_CONTAINER_ID);node.html($.bookmark.BUTTON_ADD_TEMPLATE);if(param.text!==false){node.find("a").html($.bookmark.BUTTON_LABEL_ADD);}
node.removeClass("cancel");if(click===undefined){click=function(){$.bookmark.addItem(node,param);}}
node.unbind("click");node.click(click);}
$.bookmark.addItem=function(node,param){$.bookmark.log("add function");$.bookmark.cookie.getBoxCookie(true,function(articles){try{var tot=(!$.bookmark.utils.isNull(articles)&&!$.bookmark.utils.isObjectNull(articles.values))?articles.values.length:0;if(tot<$.bookmark.ARTICLES_MAX_LIMIT){$.bookmark.log("tot articoli salvati:"+tot);var ondata=function(){var ts=$.bookmark.utils.timestamp();title=title.replace(' - Repubblica.it','');author=(!$.bookmark.utils.isEmptyString(author))?author.replace("di ",""):$.bookmark.FILED_AUTHOR_DEFAULT;author=$.bookmark.utils.ucwords(author.toLowerCase());$.bookmark.log("articolo url:"+url);if(!$.bookmark.articlesAlreadyExists(articles,url)){$.bookmark.log("articolo da salvare non presente");var article={};article[$.bookmark.FILED_OG_TITLE]=title;article[$.bookmark.FILED_OG_URL]=url;article[$.bookmark.FILED_OG_IMAGE]=image;article[$.bookmark.FILED_OG_DESCRIPTION]=desc;article[$.bookmark.FILED_AUTHOR]=author;article[$.bookmark.FILED_PUB_DATE]=date;article[$.bookmark.FILED_TIMESTAMP]=ts;articles.values.push(article);$.bookmark.cookie.setBoxCookie(articles);}else{}
if(allNodes[url]){allNodes[url].each(function(i,node1){node1=$(node1);$.bookmark.setLabelDelete(url,node1,param);});}else $.bookmark.setLabelDelete(url,node,param);}
var title=$("meta[property=\""+$.bookmark.FILED_OG_TITLE+"\"]").attr("content");var url=$("meta[property=\""+$.bookmark.FILED_OG_URL+"\"]").attr("content");var image=$("meta[property=\""+$.bookmark.FILED_OG_IMAGE+"\"]").attr("content");var desc=$("meta[property=\""+$.bookmark.FILED_OG_DESCRIPTION+"\"]").attr("content");var date=$("meta[name=\""+$.bookmark.FILED_PUB_DATE+"\"]").attr("content");var author=$("meta[name=\""+$.bookmark.FILED_AUTHOR+"\"]").attr("content");var data_b=node.attr("data-bookmark");var data_u=node.attr("data-url");if(data_b||data_u){if(data_u){data={gsUrl:data_u};}
if(data_b){var data={}
try{data=JSON.parse(data_b)}
catch(e){}}
title=data.gsTitle;url=data.gsUrl;image=data.gsImage;desc=data.gsDescription;date=data.gsDate;author=data.gsAuthor;if(window.kwmeta&&!(title&&url&&image&&desc)){kwmeta.load(url,function(d){title=d.title;image=d.image;desc=d.description;ondata();});}else{ondata();}}else ondata();}else{$.bookmark.alerting($.bookmark.ACTION_MSG_LIMIT_MAX);}}catch(e){$.bookmark.alerting($.bookmark.ACTION_MSG_ADD_ERROR);}});}
$.bookmark.deleteItem=function(url,node,param,success){$.bookmark.log("delete function");$.bookmark.cookie.getBoxCookie(true,function(articles){try{if($.bookmark.articlesAlreadyExists(articles,url)){var articlesMerged=new Array();$.each(articles.values,function(i,e){if(e[$.bookmark.FILED_OG_URL]!=url)
articlesMerged.push(e);});$.bookmark.log("merged");$.bookmark.debug(articlesMerged);$.bookmark.debug(articlesMerged);var ret={"values":articlesMerged};$.bookmark.cookie.setBoxCookie(ret);}else{}
if(allNodes[url]){allNodes[url].each(function(i,node1){node1=$(node1);$.bookmark.setLabelAdd(undefined,node1,param);});}else $.bookmark.setLabelAdd(undefined,node,param);}catch(e){$.bookmark.alerting($.bookmark.ACTION_MSG_DELETE_ERROR);}
if(success)success();});}
$.bookmark.statusbar={};$.bookmark.statusbar.getListArticles=function(){return"";}
$.bookmark.custompage={};$.bookmark.custompage.renderBoxArticles=function(limit){$.bookmark.log("custompage render funcion");$("#"+RenderSocial.CUSTOM_CENTER_DIV_ID).append($.bookmark.CUSTOM_PAGE_HTML_CONTAINER);$.bookmark.custompage.renderListArticles();}
$.bookmark.custompage.renderBoxListArticles=function(limit){$.bookmark.log("custompage render funcion");$("#"+RenderSocial.CUSTOM_CENTER_DIV_ID).html($.bookmark.CUSTOM_PAGE_HTML_CONTAINER);$.bookmark.custompage.renderListArticles();}
$.bookmark.custompage.getLinksShare=function(index,title,url){urlEncoded=encodeURIComponent(url);titleEncoded=encodeURIComponent(title);var html='<div class="'+$.bookmark.SHARE_CONTAINER_CLASS+' clearfix">';html+='<a class="share" href="javascript:void(0)">Condividi</a>';html+='<div class="'+$.bookmark.SHARE_OVERLAY_CLASS+' initial">';html+='</div>';html+='</div>';return html;}
$.bookmark.custompage.renderListArticles=function(){var CUSTOM_PAGE_UL_ID=$('#'+$.bookmark.CUSTOM_PAGE_UL_ID);CUSTOM_PAGE_UL_ID.empty();CUSTOM_PAGE_UL_ID.append($('<li class="title"><dl><dt>Lo leggo dopo</dt></dl></li>'));$.bookmark.cookie.getBoxCookie(false,function(articles){var length=articles.values.length;if(length>0){var limit=(!$.bookmark.utils.isNull(bmPrintAll)&&bmPrintAll)?length:$.bookmark.CUSTOM_PAGE_MAX_ITEMS;var html='<li class="nobg">';html+='<em>Sono presenti <strong>'+articles.values.length+'</strong> articoli salvati su un massimo di '+$.bookmark.ARTICLES_MAX_LIMIT+'</em>';html+='</li>';CUSTOM_PAGE_UL_ID.append($(html));var html='<li>';html='<table cellspacing="0" cellpadding="0" border="0" class="tablesorter" id="'+$.bookmark.TABLE_SORTER_ID+'">';html+='<thead><tr><th width="450" class="header">Titolo</th><th class="header headerSortUp">Data salvataggio</th><th>Utility</th></tr></thead>';html+='<tbody>';html+='</tbody>';html+='</table>';html+='</li>';var table=$(html);CUSTOM_PAGE_UL_ID.append(table);var tbody=table.find("tbody");var sorted=articles.values.sort($.bookmark.utils.sort);var css='odd';var renderShares=function(container,url,title,desc,image){id=$.bookmark.SHARE_OVERLAY_CLASS+"-"+Math.floor((Math.random()*1000000000));container.attr("id",id);var conf={containerID:id,gsUrl:url,gsTitle:title,gsDescription:desc,gsImage:image,gsOrderButtons:["twitter-tweet","google-plusone","facebook-like"]};if(window.gsPlugins)window.gsPlugins.showShareBarUI(conf);}
$.each(sorted,function(i,e){if(i<limit){var title=e[$.bookmark.FILED_OG_TITLE];var url=e[$.bookmark.FILED_OG_URL];var image=e[$.bookmark.FILED_OG_IMAGE];var desc=e[$.bookmark.FILED_OG_DESCRIPTION];if(desc)desc=desc.substring(0,$.bookmark.SUMMARY_MAX_LENGHT)+"...";else desc="";var author=e[$.bookmark.FILED_AUTHOR];var dp=e[$.bookmark.FILED_PUB_DATE];var ts=parseInt(e[$.bookmark.FILED_TIMESTAMP]);var dt=new Date(ts);var day=(dt.getDate()<10)?"0"+dt.getDate():dt.getDate();var months=$.bookmark.MONTHS;var month=months[dt.getMonth()];var ds=day+' '+month+' '+dt.getFullYear();var share=$.bookmark.custompage.getLinksShare(i,title,url);css=(i%2)?'even':'odd';var html='<tr class="'+css+'">';html+='<td><a class="link-bold" href="'+url+'"><strong>'+title+'</strong></a><br />'+desc+'</td>';html+='<td>'+ds+'</td>';html+='<td>'+share;html+='<a href="javascript:void(0)" class="'+$.bookmark.CUSTOM_PAGE_CLASS_PRINT+'" id="'+$.bookmark.CUSTOM_PAGE_PATTERN_PRINT+i+'">Stampa</a>';html+='<a href="javascript:void(0)" class="'+$.bookmark.CUSTOM_PAGE_CLASS_DELETE+'" id="'+$.bookmark.CUSTOM_PAGE_PATTERN_DELETE+i+'">Cancella</a>';;html+='</td>';html+='</tr>';var row=$(html);tbody.append(row);var container=row.find('.'+$.bookmark.SHARE_OVERLAY_CLASS);renderShares(container,url,title,desc,image);var shareclick1=function(){container.removeClass("initial");container.fadeToggle($.bookmark.SHARE_OVERLAY_EFFECT_TIME);}
row.find('.'+$.bookmark.SHARE_CONTAINER_CLASS).click(shareclick1);}});if($.bookmark.utils.isNull(bmPrintAll)||!bmPrintAll)
CUSTOM_PAGE_UL_ID.append($('<li class="right"><a href="archive.php">Vedi tutti</a></li>'));$("."+$.bookmark.CUSTOM_PAGE_CLASS_PRINT).click(function(){var index=$(this).attr("id").replace($.bookmark.CUSTOM_PAGE_PATTERN_PRINT,'');var art=sorted[index];var url=art[$.bookmark.FILED_OG_URL];$.bookmark.custompage.getContent(url);});$("."+$.bookmark.CUSTOM_PAGE_CLASS_DELETE).click(function(){var index=$(this).attr("id").replace($.bookmark.CUSTOM_PAGE_PATTERN_DELETE,'');var art=sorted[index];$.bookmark.custompage.deleteConfirm(art[$.bookmark.FILED_OG_URL]);});$("#"+$.bookmark.TABLE_SORTER_ID).tablesorter({sortList:[[1,1]],widgets:[$.bookmark.TABLE_SORTER_WIDGET],headers:{1:{sorter:'gs_date'},2:{sorter:false}}});}else{var html='<li><em>Nessun articolo salvato. Per salvare una notizia clicca sul tasto <strong>presente nella pagina dell\'articolo</strong>: <div class="archive-button">Lo leggo dopo</div></em></li>';CUSTOM_PAGE_UL_ID.append($(html));}
if($.neodata)$.neodata.utils.fixLayoutBox();else $("#content-form").remove();});}
$.bookmark.custompage.deleteConfirm=function(url){GeleSocial.confirm($.bookmark.ACTION_MSG_CONFIRM_DELETE,function(answer){if(answer){$.bookmark.deleteItem(url,undefined,undefined,function(){$.bookmark.custompage.renderListArticles();});}});}
$.bookmark.custompage.getContent=function(url){$.bookmark.debug("custompage.getContent function");GeleSocial.openModal($.bookmark.CUSTOM_PAGE_POPUP_URL+url,null,$.bookmark.CUSTOM_PAGE_POPUP_WIDTH,$.bookmark.CUSTOM_PAGE_POPUP_HEIGHT);}
$.bookmark.custompage.renderDetailArticle=function(){}
$.bookmark.render={};$.bookmark.render=function(parameters,func){if(!$.bookmark.utils.isNull(func)&&!$.bookmark.utils.isNull(parameters)&&$.isFunction(func))
func(parameters);}
$.bookmark.alerting={};$.bookmark.alerting=function(msg){GeleSocial.alert(msg);}
$.bookmark.cookie={}
$.bookmark.cookie.getBoxCookie=function(force,success){force=(!$.bookmark.utils.isNull(force))?force:false;var transform=function(cookie){var ret={"values":new Array()};$.bookmark.debug(cookie);if(!$.bookmark.utils.isNull(cookie)&&!$.bookmark.utils.isNull(cookie.values)){var v=cookie.values;if(v){if(typeof v!="string"){var json=v;}else{var json=window.JSON.parse(unescape(v));}
ret={"values":json};}}
return ret;}
var success1=function(cookie){if(cookie&&success){success(transform(cookie));}}
var cookie=GeleSocial.getBoxCookie($.bookmark.COOKIE_NAME,force,success1);if(cookie)return transform(cookie);}
$.bookmark.cookie.setBoxCookie=function(v){$.bookmark.log("setBoxCookie function");var ret=new Array();$.bookmark.debug(v);if(!$.bookmark.utils.isNull(v)&&!$.bookmark.utils.isNull(v.values)&&!$.bookmark.utils.isObjectNull(v.values)){$.bookmark.log("setCookieValueIntoString");ret=v.values;}
$.bookmark.debug(ret);GeleSocial.setBoxCookie($.bookmark.COOKIE_NAME,{"values":ret});}
$.bookmark.logger=GeleSocial.getLogger("SOCIAL BOOKMARK");$.bookmark.log=$.bookmark.logger.log;$.bookmark.debug=$.bookmark.logger.log;$.bookmark.utils={}
$.bookmark.utils.isNull=function(v){return!(!typeof(v)!='undefined'&&v!=null&&v!="null");}
$.bookmark.utils.isObjectNull=function(v){return $.bookmark.utils.getObjectLength(v)==0;}
$.bookmark.utils.getObjectLength=function(obj){var size=0,key;for(key in obj){size++;}
return size;}
$.bookmark.utils.isEmptyString=function(v){return GeleSocial.utils.isEmptyString(v);}
$.bookmark.utils.stripslashesSingleQuote=function(v){return v.replace(/\\\'/g,'\'');}
$.bookmark.utils.stripslashesQuote=function(v){return v.replace(/\\\"/g,'\"');}
$.bookmark.utils.trim=function(v){return v.replace(/^\s+|\s+$/g,"");}
$.bookmark.utils.timestamp=function(){var d=new Date();return d.getTime();}
$.bookmark.utils.ucwords=function(str){return(str+'').replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase();});}
$.bookmark.utils.sort=function(a,b){return a[$.bookmark.FILED_TIMESTAMP]>b[$.bookmark.FILED_TIMESTAMP]?-1:1;}})(jQuery);;

(function(){var $=window.$;if(!$)$=window.jQuery;if(!window.gsPluginsConf)window.gsPluginsConf={};if(!window.gsPlugins){if(!String.prototype.supplant){String.prototype.supplant=function(o){return this.replace(/\{([^{}]*)\}/g,function(a,b){var r=o[b];return typeof r==='string'||typeof r==='number'?r:a;});};}
window.gsBarrier=function(){var me=this;this.finalCallback=null;this.numCallbacks=0;this.addCallback=function(){me.numCallbacks++;}
this.completed=function(){me.numCallbacks--;if(me.finalCallback&&me.numCallbacks==0){var finalC=me.finalCallback;delete me.finalCallback;try{finalC();}catch(e){}}}
this.wait=function(callback){if(me.numCallbacks==0)callback();else me.finalCallback=callback;}}
if(!window.common)window.common={};if(!window.common.util)window.common.util={};if(!window.common.util.progressiveload){window.common.util.progressiveload=function progressiveload(callback){if(!progressiveload.callbacks){progressiveload.callbacks=$({});period=100;domloaded=false;var progressive=function prepare(){if(!domloaded){progressiveload.callbacks.trigger("progressiveload.pass",domloaded);setTimeout(progressive,period);}}
$(function(){domloaded=true;progressiveload.callbacks.trigger("progressiveload.pass",domloaded);});if(period)setTimeout(progressive,period);}
progressiveload.callbacks.bind("progressiveload.pass",callback);}}
var renderBlocked=function(defaultConf,localConf){var commonFunc=function(conf){}
var perIdFunc=function(conf1){if(conf1.containerID&&conf1.gsKwdntBlockedId){var id=conf1.gsKwdntBlockedId;var elid=id.replace(/\//g,"-");$("#"+conf1.containerID).append('<div id="kwdnt-blocked-div-'+elid+'"></div>'+'<script>window.kwdntBlocked && kwdntBlocked("'+id+'")</script>');}}
this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);};var gsPluginsBlocked={showCommentsUI:function(localConf){renderBlocked.call(this,{gsKwdntBlockedId:"social/comments"},localConf);},showShareBarUI:function(localConf){renderBlocked.call(this,{},localConf);}}
window.gsPlugins={DEFAULT_CONF_SHAREBAR:{containerID:'gs-social-sharebuttons',gsMinimizeWidth:true,showEmailButton:true,emailProviders:'none',moreDisabledProviders:'facebook,twitter',gsDisableButtons:'google-plusone,googleplus,gs-customtpl-googleplus',gsCommentsAnchor:"#commenta",gsVia:'repubblica',gsClosePage:"https://www.repubblica.it/static/js/common/gs/close.html",gsCustomTemplate:function(data){var conf=data.conf;var share_text=$('<span class="share-text"></span>');var share_count=$('<span class="share-count"></span>');var defaultTemplate=$('<a class="share" href="javascript:void(0)"></a>');var countRight=!conf.layout||conf.layout=="horizontal";if(conf.showCounts){countRight=conf.showCounts=="right";}
if(countRight){defaultTemplate.append(share_text);}else{defaultTemplate.append(share_text);}
if(!data.type){defaultTemplate.addClass("gs-link");defaultTemplate.find(".share-count").addClass("gs-count");var ret=$('<div class="gig-button-container gs-custom"></div>');ret.append(defaultTemplate);var gs_custom=ret.add(ret.find(".gs-custom"));var layout=conf&&conf.layout&&conf.layout=="vertical"?"vertical":"horizontal";gs_custom.addClass('gig-button-container-'+layout);gs_custom.addClass('gs-custom-'+data.provider);}else{defaultTemplate.attr("data-onclick","$onClick");if(data.type!="gigya_count")defaultTemplate.find(".share-count").remove();else defaultTemplate.find(".share-count").text("$count");ret=defaultTemplate;}
return ret;},shareButtons:[{provider:'twitter-tweet',via:'repubblica'},{provider:'facebook-like',action:'recommend'},{provider:'share',tooltip:'Condividi'},{provider:'email',tooltip:'Invia per email'}],facebookDialogType:"feed",emailBody:"Ciao!<br /><br />Volevo segnalarti questa pagina:<br />$URL$<br /><br />$userMsg$<br />"},DEFAULT_CONF_REACTIONS:{containerID:'gs-social-reactions',showCounts:'top',cancelReactions:true,multipleReactions:false,showSuccessMessage:true},DEFAULT_CONF_POLLS:{containerID:'gs-social-poll',layout:'vertical',showCounts:'none',countType:'percentage',cancelReactions:false,multipleReactions:false,showSuccessMessage:false,gsIconImgUp:'https://www.repubblica.it/static/images/common/gs/polls/checkbox.png',gsIconImgDown:'https://www.repubblica.it/static/images/common/gs/polls/checkbox_selected.png',gsHeaderText:'<span class="gs-social-poll-header-text" style="font-size:1.3em; font-weight:bold">Grazie per aver votato!</span>',gsBodyText:'condividilo su:',gsNoButtonBorders:true},DEFAULT_CONF_COMMENTS:{containerID:'gs-social-comments',gsUserMessage:'Ha commentato ',disabledProviders:'messenger,blogger,wordpress',privacy:'public',deviceType:'auto',gsCountChars:1000,gsCountWarning:false,gsTextButton:"Commenta",gsReadOnlyText:true},DEFAULT_CONF_CHAT:{containerID:"gs-social-chat",width:300,height:450},DEFAULT_CONF_FOLLOWBAR:{containerID:'gs-social-follow',iconSize:32,buttons:[{provider:'facebook',title:'Seguici su Facebook',actionURL:'http://www.facebook.com/Repubblica',action:'dialog'},{provider:'twitter',title:'Seguici su Twitter',followUsers:'repubblica',action:'dialog'}]},DEFAULT_CONF_PRINT:{containerID:'gs-social-sharebuttons'},DEFAULT_CONF_ACTIVITYFEED:{containerID:'gs-social-activity-feed'},DEFAULT_CONF_RATING:{containerID:"gs-social-rating",linkedCommentsUI:"gs-social-comments"},__events:$({}),__shareButtons:[],preinit:function(){var me=this;this._checkDefaultCSS();this._checkMetaConfiguration();this.__checkFBEvents();if(window.gigya&&window.gsPluginsConf.gsShareCount){window.gigya.socialize.getProviderShareCounts=function(conf,conf1){conf=$.extend(conf,conf1);var url=conf.URL;var cb=function(data){data={shareCounts:data};if(conf.callback)conf.callback(data);};window.gsPlugins._getShareCounts({gsUrl:url,gsShareCount:gsPluginsConf.gsShareCount},cb);}}
this.shareBarrier=new window.gsBarrier();if(window.gsPluginsConf.shareButtons)this.showGlobalConfPlugins(this.showShareBarUI,window.gsPluginsConf.shareButtons);this.lazyPopups.init();this.inplace.init();window.gsPlugins.shareBarrier.wait(function(){if(window.gsPluginsConf.print){me.showGlobalConfPlugins(me.showPrintUI,window.gsPluginsConf.print);}
window.gsPluginsConf.print=null;me.__finalized=true;me.__events.trigger("gs-plugins.finalized");})
if(window.gsPluginsConf.callbacks){if(gsPluginsConf.callbacks.init){this.addInitCallback(gsPluginsConf.callbacks.init);}
if(gsPluginsConf.callbacks.final){this.addFinalCallback(gsPluginsConf.callbacks.final);}}
this.__initialized=true;this.__events.trigger("gs-plugins.init");},init:function(){if(window.gsPluginsConf.reactions)this.showGlobalConfPlugins(this.showReactionsBarUI,window.gsPluginsConf.reactions);if(window.gsPluginsConf.polls)this.showGlobalConfPlugins(this.showPollUI,window.gsPluginsConf.polls);if(window.gsPluginsConf.comments)this.showGlobalConfPlugins(this.showCommentsUI,window.gsPluginsConf.comments);if(window.gsPluginsConf.chat)this.showGlobalConfPlugins(this.showChatUI,window.gsPluginsConf.chat);if(window.gsPluginsConf.follow)this.showGlobalConfPlugins(this.showFollowBarUI,window.gsPluginsConf.follow);if(window.gsPluginsConf.activityfeed)this.showGlobalConfPlugins(this.showFeedUI,window.gsPluginsConf.activityfeed);if(window.gsPluginsConf.rating)this.showGlobalConfPlugins(this.showRatingUI,window.gsPluginsConf.rating);},__checkFBEvents:function(){if(window.FB&&window.FB.Event){FB.Event.subscribe("edge.create",function(url,el){gsPlugins.__events.trigger("gs-plugins.facebook.like",[url,el]);});FB.Event.subscribe("edge.remove",function(url,el){gsPlugins.__events.trigger("gs-plugins.facebook.unlike",[url,el]);});}},_checkMetaConfiguration:function(){var twitter_site=$("meta[name='twitter:site']").attr("content");if(twitter_site&&twitter_site.length>0){this.DEFAULT_CONF_SHAREBAR.gsVia=twitter_site.replace(/@/g,"");}},load:function(){var gsPluginsInit=function(){window.gsPlugins.preinit();window.gsPlugins.init();}
var checkFinalCallback=function(){if(!window.GeleSocial||!GeleSocial.addFinalStatusCallback||window.GeleSocial.settings.disableEverything)gsPluginsInit();else{GeleSocial.addInitCallback(function(){window.gsPlugins.preinit();});GeleSocial.addFinalStatusCallback(function(){window.gsPlugins.init();});}}
var kwdnt_blocked=window.kwdnt===-1;var load=window.jQuery&&!kwdnt_blocked&&window.kwSocialDisable!==true;if(!load){if(window.jQuery&&kwdnt_blocked){window.gsPlugins=$.extend(window.gsPlugins,gsPluginsBlocked);checkFinalCallback();}
return;}
if(window.gsPluginsConf.apikey&&(!window.GeleSocial||!window.GeleSocial.version||!window.GeleSocial.settings||window.GeleSocial.version<2||window.GeleSocial.settings.disableEverything)){var globalConf='{\
              "shortURLs": "never"\
     ,enabledProviders: "facebook,twitter,linkedIn"\
          }';if(window.gsPluginsConf.globalConf)globalConf=window.gsPluginsConf.globalConf;var apikey=window.gsPluginsConf.apikey;window.onGigyaServiceReady=function(serviceName){if(serviceName!="socialize")return;checkFinalCallback();}
jQuery(document).ready(function(){(function(d){var js;js=d.createElement('script');js.async=true;var cdn=location.protocol=="https:"&&"cdns"||"cdn";js.src='//'+cdn+'.gigya.com/js/gigya.js?apikey='+apikey+'&lang=it-it';js.text=globalConf;d.getElementsByTagName('head')[0].appendChild(js);}(document));});}else{checkFinalCallback();}},addInitCallback:function(callbacks){this.addCallback("gs-plugins.init",callbacks,"__initialized");},addFinalCallback:function(callbacks){this.addCallback("gs-plugins.finalized",callbacks,"__finalized");},addFacebookCallback:function(callbacks){this.addCallback("gs-plugins.facebook.load",callbacks,"__facebook_loaded");},addCallback:function(event,callbacks,check){if(!(callbacks instanceof Array)){callbacks=[callbacks];}
for(var i=0;i<callbacks.length;i++){try{if(!check||this[check]===undefined){this.__events.bind(event,callbacks[i]);}else{callbacks[i]();}}catch(e){}}},_checkDefaultCSS:function(){var css=$("#gs-plugins-css");if(css.length==0){var print_icon='https://www.repubblica.it/static/images/common/gs/sprite.png';if(window.gsPluginsConf.printIconUrl){print_icon=window.gsPluginsConf.printIconUrl;}
var default_css='.gig-counter {font-size: inherit !important;}\
    .gig-share-bar-container.layout-default {width: auto !important;}\
    .gs-print { color: #333333; font-size: 11px; line-height: 20px; padding-left: 24px;  white-space: nowrap; height: 20px; text-indent: 0;}\
    .gs-print.default-icon { background:transparent url("'+print_icon+'") no-repeat 0 0;}\
    .gs-print-text {padding-right: 24px;}\
    .gs-social-popup-balloon {width: 0px; height: 0px; overflow: hidden;}\
    .gs-social-popup-balloon.open { width: auto; height: auto; overflow: visible;}\
    .gs-social-popup-balloon .gig-share-bar-container,.gs-social-popup-balloon .gs-print {width: 0px; height: 0px; overflow: hidden;}\
    .gs-social-popup-balloon.loaded .gig-share-bar-container, .gs-social-popup-balloon.loaded .gs-print{ width: auto; height: auto; overflow: visible;}\
    .gs-social-comments-userprofile .gig-comment-img,.gs-social-comments-userprofile .gig-comment-username {cursor: pointer;}\
    .gs-followbar * {box-sizing: content-box;}\
    .gs-followbar-default .gs-followbar-cell {margin-right: 5px;}\
    .gs-followbar-cell {position:relative; display: inline-block; left:0px; top: 0px;}\
    .gs-followbar-cell .gs-social-popup-balloon { position: absolute; top: 100%;left: 0px; margin-top: 10px; margin-left: 0px !important; z-index: 9999999; background: white; width: 0px; height: 0px; overflow: hidden; }\
    .gs-followbar-cell .gs-social-popup-balloon.open {min-width: 14px; min-height: 11px; padding: 10px; width: auto; height: auto; overflow: visible; background: white; border: 1px solid #ccc;}\
    .gs-followbar-cell .gs-social-popup-balloon-facebook.open {width: 300px; height: 214px; left: -150px;}\
    .gs-followbar-cell .gs-social-popup-balloon-twitter.open {width: 250px; height: 20px; left: -125px;}\
    .gs-followbar-cell .gs-social-popup-balloon.notloaded.open { background: url(//www.repstatic.it/cless-mobile/main/nazionale/2016-v1/img/loading.gif);background-repeat: no-repeat; background-color: white; background-position: 50%; background-size: 15px;}\
    .gs-followbar-cell .gs-social-popup-balloon.notloaded.open * {width: 0px; height: 0px; overflow: hidden;}\
    .gs-followbar-cell .gs-social-popup-balloon.open:before { content: ""; display: block; position: absolute; top: -10px; left: 10px; width: 0px; height: 0px; border-width: 0 6px 10px 6px; border-color: transparent transparent #ccc transparent;  border-style: solid; z-index: 99999991;}\
    .gs-followbar-cell .gs-social-popup-balloon.open:after { content: ""; display: block; position: absolute; top: -9px; left: 10px; width: 0px; height: 0px; border-width: 0 6px 10px 6px; border-color: transparent transparent white transparent;  border-style: solid; z-index: 99999992;}\
    .gs-followbar-cell .gs-social-popup-balloon-facebook.open:before, .gs-followbar-cell .gs-social-popup-balloon-facebook.open:after { left: 160px; }\
    .gs-followbar-cell .gs-social-popup-balloon-twitter.open:before, .gs-followbar-cell .gs-social-popup-balloon-twitter.open:after { left: 135px; }\
    .gs-followbar-small .gs-followbar-cell .gs-social-popup-balloon-facebook.open:before, .gs-followbar-small  .gs-followbar-cell .gs-social-popup-balloon-facebook.open:after { left: 155px; }\
    .gs-followbar-small .gs-followbar-cell .gs-social-popup-balloon-twitter.open:before, .gs-followbar-small  .gs-followbar-cell .gs-social-popup-balloon-twitter.open:after { left: 130px; }';var t=$("head").children().first().html().replace(/\s+/g,'');if(t!=default_css.replace(/\s+/g,''))
$("head").prepend('<style type="text/css">'+default_css+'</style>');}},__applyTheme:function(conf){if(conf.gsOrderButtons){var arr1=conf.gsOrderButtons;if(!(arr1 instanceof Array))arr1=arr1.split(",");$("#"+conf.containerID).addClass("gs-custom-cols-"+arr1.length);}
var givenT=conf.gsCustomTemplate;if(!conf.buttonTemplate)conf.buttonTemplate=givenT({conf:conf,type:"gigya"})[0].outerHTML;if(!conf.buttonWithCountTemplate)conf.buttonWithCountTemplate=givenT({conf:conf,type:"gigya_count"})[0].outerHTML;if(conf.buttonTemplate)conf.buttonTemplate=conf.buttonTemplate.replace("data-onclick","onclick");if(conf.buttonWithCountTemplate)conf.buttonWithCountTemplate=conf.buttonWithCountTemplate.replace("data-onclick","onclick");var theme=conf.gsTheme?conf.gsTheme:{"id":"default"};if(!theme.id)theme={"id":theme};var themeID="gs-custom-theme-"+theme.id;$("#"+conf.containerID).addClass(themeID);var style=$("#"+themeID);if(style.length==0&&theme.id!="none"){var base_static="//www.repstatic.it";if(conf.gsTest)base_static="//test.repstatic.it";if(!theme.url)theme.url=base_static+"/cless/common/stable/css/shared-social-buttons/theme/"+theme.id+"/"+theme.id+".css?v=1";var style='<link id ="'+themeID+'" rel="stylesheet"  href="'+theme.url+'" type="text/css" media="all" />';style=$(style);$("head").prepend(style);}},showGlobalConfPlugins:function(showFunc,pluginConf){if(pluginConf instanceof Array){jQuery.each(pluginConf,function(i,a){showFunc.apply(window.gsPlugins,[a]);})}else{showFunc.apply(window.gsPlugins,[pluginConf]);}},withMultipleContainer:function(defaultConf,localConf,commonFunc,perIdFunc){if(!localConf)localConf={};var conf=jQuery.extend(true,{},defaultConf);if(!localConf.gsOverwrite)conf=jQuery.extend(true,conf,localConf);else conf=jQuery.extend(true,{},localConf);commonFunc(conf);var containerID=conf.containerID;containerID=containerID.split(',');for(var i=0;i<containerID.length;i++){containerID[i]=jQuery.trim(containerID[i]);}
jQuery.each(containerID,function(i,a){var conf1=jQuery.extend(true,{},conf);conf1.containerID=a;if(conf1.gsStandalone&&!gsPlugins.__initialized){gsPlugins._checkDefaultCSS();gsPlugins._checkMetaConfiguration();perIdFunc(conf1);}else{gsPlugins.addInitCallback(function(){perIdFunc(conf1);});}});},__unescapeHTMLEntities:function(t){if(t&&t.constructor===String&&t.length){var div=document.createElement("div");div.innerHTML=t;t=div.innerText;}
return t;},__escapeHTMLEntities:function(t){if(t&&t.constructor===String&&t.length){var div=document.createElement("div");div.innerText=t;t=div.innerHTML;}
return t;},_getTitle:function(conf){var ret=$("meta[property=\"og:title\"]").attr("content");if(conf.gsTitle){ret=conf.gsTitle;}
if(ret){ret=ret.replace(/&quot;/g,"\"");var lidx=ret.length;while(lidx>=0){lidx=ret.lastIndexOf(" - ");if(lidx>=0)ret=ret.substring(0,lidx);}}
ret=this.__unescapeHTMLEntities(ret);return ret;},_getDescription:function(conf){var ret=$("meta[property=\"og:description\"]").attr("content");if(conf.gsDescription){ret=conf.gsDescription;}
ret=this.__unescapeHTMLEntities(ret);return ret;},_getImage:function(conf){var ret=$("meta[property=\"og:image\"]").attr("content");if(conf.gsImage){ret=conf.gsImage;}
ret=this.__escapeHTMLEntities(ret);return ret;},_getGsUrl:function(){return $('meta[name="gs:url"]').last().attr("content");},_getUrl:function(conf,checkParams,checkShortLink,button){var ret=$("meta[property=\"og:url\"]").attr("content");if(conf&&conf.gsUrl){ret=conf.gsUrl;}
if(checkParams){if(checkShortLink){var shortlink=this._getShortLink(conf);if(shortlink)ret=shortlink;}
if(ret)ret=this._checkLinkParams(ret,conf,button);}
if(!ret&&window.top===window&&window.console&&console.error){console.error("manca il meta og:url");}
ret=this.__escapeHTMLEntities(ret);if(ret&&ret.match(/^\/\//))ret=location.protocol+ret;return ret;},_getCountableProviders:function(conf){if(conf&&conf.gsShareCount&&conf.gsShareCount=="client")return["comments"];return["facebook","linkedin","pinterest","comments"]},_isCountableProvider:function(p,conf){var coun=gsPlugins._getCountableProviders(conf);return coun.indexOf(p)>=0;},_getCommentsCount:function(conf,button,cb){if(!button.categoryID||!button.streamID||!cb){return;}
this.addInitCallback(function(){if(window.gigya&&gigya.comments){gigya.comments.getStreamInfo({categoryID:button.categoryID,streamID:button.streamID,callback:function(res){if(res&&res.streamInfo){var count=res.streamInfo.approvedCommentCount||0;cb({comments:count});}}});}});},_getShareCounts:function(conf,cb){var url=window.gsPlugins._getUrl(conf);if(conf.gsShareCount){var hasCount=false;var count=undefined;if(gsPlugins.count){count=gsPlugins.count.getCount("gs-share-count",url);hasCount=count!==undefined;}
if(conf.gsShareCount=="client"&&!hasCount){$.ajax({url:"//graph.facebook.com/?ids="+encodeURIComponent(url),success:function(res){var c1={facebook:0};if(res.shares)c1.facebook=res.shares;else if(res[url]&&res[url].shares)c1.facebook=res[url].shares;else if(res[url]&&res[url].share&&res[url].share.share_count)c1.facebook=res[url].share.share_count;else if(res[url]&&res[url].engagement){if(res[url].engagement.share_count)
c1.facebook+=res[url].engagement.share_count;if(res[url].engagement.comment_count)
c1.facebook+=res[url].engagement.comment_count;if(res[url].engagement.reaction_count)
c1.facebook+=res[url].engagement.reaction_count;}
cb(c1);},error:function(){cb({});}});}else{if(hasCount){var res={"facebook":count};cb(res);}else{var success=function(){if(window.gsPlugins&&window.gsPlugins.count&&window.gsPlugins.count.data){var res={};var data={};if(gsPlugins.count.data["gs-sharebar-count"]&&gsPlugins.count.data["gs-sharebar-count"][url]){var data=gsPlugins.count.data["gs-sharebar-count"][url];}
var countable=gsPlugins._getCountableProviders();for(var i=0;i<countable.length;i++){var count1=countable[i];if(data[count1]&&data[count1].total_count)res[count1]=data[count1].total_count;else res[count1]=0;}
cb(res);}}
$.ajax({url:conf.gsShareCount,data:{page:"sharebar",output:"jsonp",depth:0,urls:url},dataType:'script',cache:true,success:success});}}}else{if(!window.gigya||!window.gigya.socialize)cb({});else{gigya.socialize.getProviderShareCounts({"URL":url,"enabledProviders":gsPlugins._getCountableProviders(),"callback":function(res){if(res.shareCounts)cb(res.shareCounts);else cb({});}});};}},_printCount:function(count_num,kiloSuffix,megaSuffix){var printNum=function(count_num1){var count_num2=Math.round(count_num1*10);var count_text=count_num2 / 10;if(count_num2%10==0)count_text=Math.floor(count_num2 / 10);count_text=count_text.toString().replace(/\./g,",");return count_text;}
if(!kiloSuffix)kiloSuffix="K";if(!megaSuffix)megaSuffix="M";var count_text=count_num;var count_num1=count_num;var count_num_k=null;if(count_num1>=1100){count_num1=count_num1 / 1000;count_text=printNum(count_num1);count_text=count_text+kiloSuffix;count_num_k=count_num1;}
if(count_num_k&&count_num_k>=1000){count_num1=count_num1 / 1000;count_text=printNum(count_num1);count_text=count_text+megaSuffix;}
return count_text;},_getVia:function(button){var ret=button.via||button.gsVia||$("meta[name='twitter:site']").attr("content");if(ret&&ret.indexOf("@")==0)ret=ret.substring(1);return ret;},_getShortLink:function(conf){var ret=$("head link[rel='shortlink']").attr("href");ret=conf&&conf.gsShortlink||ret;return ret;},_urlToId:function(url){return escape(url).replace(/[%\/:]/gi,"-");},_checkCID:function(conf,pluginId){if(!conf.cid&&window.location.hostname){var cid=window.location.hostname;if(pluginId)cid+="-"+pluginId;conf.cid=cid;}},__prepareArray:function(arr){if(arr.split){var arr1=arr.split(',');}else{var arr1=arr;}
jQuery.each(arr1,function(i,a){arr1[i]=jQuery.trim(a);});return arr1;},__checkDisableButtons:function(conf,attrName){if(conf.gsDisableButtons){var gsDisableButtons1=this.__prepareArray(conf.gsDisableButtons);var buttons=[];jQuery.each(conf[attrName],function(i,a){if(jQuery.inArray(a.provider,gsDisableButtons1)<0&&jQuery.inArray(a.id,gsDisableButtons1)<0)buttons.push(a);})
conf[attrName]=buttons;}},__checkOrderButtons:function(conf,attrName){if(conf.gsOrderButtons){var gsOrderButtons1=this.__prepareArray(conf.gsOrderButtons);var buttons=[];jQuery.each(gsOrderButtons1,function(i,a){var buttons1=jQuery.grep(conf[attrName],function(b,j){return b.provider==a||b.id==a;});jQuery.each(buttons1,function(k,c){buttons.push(c);});})
conf[attrName]=buttons;}},__checkButtons:function(conf,buttonsConf,attrName){var gsButtons=conf[buttonsConf];if(gsButtons&&(gsButtons instanceof Array)){var buttons=[];var conf1=conf[attrName];jQuery.each(gsButtons,function(i,conf2){if(!conf2||!conf2.provider)return;var conf3=jQuery.grep(conf1,function(b,j){return b.provider==conf2.provider&&b.type&&conf2.type&&b.type==conf2.type;});if(conf3.length==0){conf3=jQuery.grep(conf1,function(b,j){return b.provider==conf2.provider;});}
if(conf3.length==0){conf1.push(conf2);}else{conf3=conf3[conf3.length-1];jQuery.extend(conf3,conf2);}});}},__checkCustomUserAction:function(conf,a,overrides){if(conf.userAction&&(a.gsTitle||a.gsDescription||a.gsImage||overrides.title||overrides.desc||overrides.image)){a.userAction=conf.userAction.clone();if(a.gsTitle||overrides.title)a.userAction.title=a.gsTitle||overrides.title;if(a.gsDescription||overrides.desc)a.userAction.description=a.gsDescription||overrides.desc;if(a.gsImage||overrides.image)a.userAction.image=a.gsImage||overrides.image;}},__checkTwitterTitle:function(title,url,via){var maxLen=140;if(via)maxLen-=6+via.length;if(url)maxLen-=1+23;if(title.length>maxLen)title=title.slice(0,maxLen-1)+"\u2026";return title;},__checkFinal:function(conf,a){if(a.provider=="twitter-tweet"||a.provider=="twitter"){if(conf.gsVia){a.via=conf.gsVia;}
if(conf.userAction&&conf.userAction.title){var title=this.__checkTwitterTitle(conf.userAction.title,a.url,a.via);title=title.replace(/\"/g,"&quot;");conf.userAction.setTitle(title);}
if(a.userAction&&a.userAction.title){var title=this.__checkTwitterTitle(a.userAction.title,a.url,a.via);title=title.replace(/\"/g,"&quot;");a.userAction.setTitle(title);}}},_checkLinkParams:function(url,conf,button){var canAddParams=button&&button.provider&&(button.provider!="facebook-like"&&button.provider!="facebook-share");if(url&&canAddParams){var linkParams="";if(conf.gsLinkParams){var separator="?";if(url.search("\\?")!=-1){separator="&";}
linkParams=separator+$.param(conf.gsLinkParams).replace(/\+/g,"%20");}
url+=linkParams;}
if(canAddParams&&button.provider=="gs-native-facebook"&&button.type=="like"){if(button.gsLinkParams&&button.gsLinkParams.ref&&!button.ref){button.ref=button.gsLinkParams.ref;}}
return url;},_getUserAction:function(conf){if(!window.gigya||!window.gigya.socialize)return null;var userActionTitle=window.gsPlugins._getTitle(conf);var userActionDescription=window.gsPlugins._getDescription(conf);var userActionUrl=window.gsPlugins._getUrl(conf,true);var userActionImage=window.gsPlugins._getImage(conf);var act=new gigya.socialize.UserAction();if(userActionTitle)act.setTitle(userActionTitle);if(userActionDescription)act.setDescription(userActionDescription);if(userActionUrl)act.setLinkBack(userActionUrl);if(userActionImage){var item={type:'image',src:userActionImage};if(userActionUrl)item.href=userActionUrl;act.addMediaItem(item);}
if(conf.gsUserMessage){act.setUserMessage(conf.gsUserMessage);}
return act;},_getProviderOverrides:function(button){var provider=button.provider;if(provider=="twitter"||provider=="twitter-tweet"){var t1=$("meta[name='twitter:title']").attr("content");var t_text=$("meta[name='gs:twitter:text']").attr("content");if(t_text)t1=t_text;var d1=$("meta[name='twitter:description']").attr("content");var i1=$("meta[name='twitter:image']").attr("content");var u1=gsPlugins._getShortLink(button);return{title:t1,desc:d1,image:i1,url:u1};}else if(provider=="whatsapp"){var u1=gsPlugins._getShortLink(button);var og_title=window.gsPlugins._getTitle(button);var t1=undefined;if(!og_title)t1=window.gsPlugins.native.whatsapp.default_title;return{title:t1,url:u1};}else{return{};}},_getReactionIdFromText:function(text){text=text.toLowerCase();text=text.replace(/[^a-z0-9]+/g,"-");text=text.replace(/(^(\-)+?)|((\-)+?$)/g,"");return text;},_configureEachReaction:function(conf){$.each(conf.reactions,function(i,reaction){if(conf.gsIconImgUp&&!reaction.iconImgUp)reaction.iconImgUp=conf.gsIconImgUp;if(conf.gsIconImgDown&&!reaction.iconImgDown)reaction.iconImgDown=conf.gsIconImgDown;if(conf.gsHeaderText&&!reaction.headerText)reaction.headerText=conf.gsHeaderText;if(conf.gsBodyText&&!reaction.bodyText)reaction.bodyText=conf.gsBodyText;if(!reaction.ID&&reaction.text)reaction.ID=window.gsPlugins._getReactionIdFromText(reaction.text);if(conf.gsNoButtonBorders!==undefined&&reaction.noButtonBorders===undefined)reaction.noButtonBorders=conf.gsNoButtonBorders;});},_downloadTemplate:function(container,id,url,params,cache){if(container.length>0&&url){if(cache&&cache[id]){container.html(cache[id]);}else{var success=function(html){if(cache)cache[id]=html;container.html(html);}
$.ajax({url:url,data:params,cache:true,dataType:'html',success:success})}}},_downloadReactionTemplate:function(conf1,container,templateUrl,cache){var params={"barID":conf1.barID};var buttonIDs="";var buttonTexts="";$.each(conf1.reactions,function(i,reaction){if(buttonIDs.length>0)buttonIDs+=","
if(buttonTexts.length>0)buttonTexts+=",";buttonIDs+=reaction.ID;buttonTexts+=reaction.text;})
params.buttonIDs=buttonIDs;params.buttonTexts=buttonTexts;this._downloadTemplate(container,conf1.barID,templateUrl,params,cache);},_showShareBarUIPrepareButtons:function(conf){var gsButtons=function(conf){var og_url=window.gsPlugins._getUrl(conf);jQuery.each(conf.shareButtons,function(i,a){var merge1=$.extend({},conf,a);var url=window.gsPlugins._getUrl(merge1,true,false,a);var shortlink=window.gsPlugins._getUrl(merge1,true,true);var overrides=window.gsPlugins._getProviderOverrides(a);gsPlugins.__checkCustomUserAction(conf,a,overrides);if((a.provider=="comments")&&!a.streamID)a.streamID=og_url;if(overrides.url)a.url=overrides.url;if(!a.url&&url)a.url=url;if(!a.countURL&&og_url)a.countURL=og_url;gsPlugins.__checkFinal(conf,a);});}
var checkDefaultRefParams=function(){jQuery.each(conf.shareButtons,function(i,a){if(a.gsLinkParams&&a.gsLinkParams.ref)return true;var providers=["facebook","gs-native-facebook","gs-customtpl-facebook","twitter","twitter-tweet","gs-native-twitter","gs-customtpl-twitter","whatsapp"];var providerTypes=["fb","fb","fb","tw","tw","tw","tw","wa"];var idx=providers.indexOf(a.provider);if(idx>=0){if(a.provider=="gs-native-facebook"&&a.type!="like"&&a.type!="share")return true;var islike=a.provider=="gs-native-facebook"&&a.type=="like";var ismobile=navigator.userAgent.match(/(android|iphone|ipad)/ig);var actionType=islike?"lk":"sh";var providerType=providerTypes[idx];var platformType=ismobile?"m":"w";if(!a.gsLinkParams)a.gsLinkParams={};a.gsLinkParams.ref=actionType+providerType+platformType;}});}
if(conf.gsButtons){window.gsPlugins.__checkButtons(conf,"gsButtons","shareButtons");}
if(conf.gsDisableButtons){window.gsPlugins.__checkDisableButtons(conf,"shareButtons");}
if(conf.gsOrderButtons){window.gsPlugins.__checkOrderButtons(conf,"shareButtons");}
gsButtons(conf);},showShareBarUI:function(localConf){if(window.kwmeta&&localConf&&localConf.gsLoadMeta&&localConf.gsUrl){var loadM=localConf.gsLoadMeta;delete localConf.gsLoadMeta;var url=localConf.gsUrl;var me=this;kwmeta.load(url,function(d){loadM(localConf,d,function(){me.showShareBarUI(localConf);});})
return;}
this._checkMetaConfiguration();var gsMinimizeWidth=function(conf){var container=$('#'+conf.containerID);container.find('.gig-button-container-twitter-tweet').css('padding-right','12px');container.find('.gig-button-container-facebook-like').css('padding-right','12px');container.find('.gig-button-container-share').css('padding-right','12px');if(conf.layout!="vertical"){container.find('.gig-share-bar-container').addClass('layout-default');}}
var hasCustomCount=false;var hasCustomButtons=false;var gsCustomButtons=function(conf){var custom=[];var standard=[];var comments=[];var cont=$(document.getElementById(conf.containerID));var morebuttons=window.gsPlugins.morebuttons;for(var i=0;i<conf.shareButtons.length;i++){var share1=conf.shareButtons[i];if(share1.provider=="gs-more"){if(morebuttons){morebuttons.toGSCustom(conf,share1);}else{continue;}}
if(share1.provider=="gs-whatsapp")share1.provider="gs-native-whatsapp";if(share1.provider&&share1.provider.indexOf("gs-native-")==0){window.gsPlugins.native.toGSCustom(conf,share1);}
if(share1.provider&&share1.provider.indexOf("gs-customtpl-")==0){hasCustomButtons=true;var realP=share1.provider.substring("gs-customtpl-".length);var hasCustomCount=hasCustomCount||gsPlugins._isCountableProvider(realP,conf);window.gsPlugins.customTemplate.toGSCustom(conf,share1);}
if(share1.provider=="comments"){comments.push([i,share1]);}
if(share1.provider&&share1.provider.indexOf("gs-custom")==0){custom.push([i,share1]);}else{standard.push(share1);}}
if((hasCustomButtons&&conf.gsTheme!==false)||(!hasCustomButtons&&conf.gsTheme)){gsPlugins.__applyTheme(conf);}
var onLoad1=conf.onLoad;var checkCustomButtons=function(ev){var is_vertical=conf.layout=="vertical";var tr=cont.find("tr").first();var td=tr.children("td").first();var onlyPersonal=false;if(tr.length==0&&td.length==0){onlyPersonal=true;var td=cont.find(".gs-sharebar-cell").first();if(td.length==0){td=$('<div class="gs-sharebar-cell"></div>');to_append=$('<div class="gs-sharebar"></div>');cont.append(to_append);}}
if(onlyPersonal){var to_append=cont.find(".gs-sharebar");var children=to_append.children();if(!is_vertical){td.css({"float":"left"});}}else{if(is_vertical){var to_append=tr.parent();var children=to_append.children();}else{var to_append=tr;var children=tr.children();}}
for(var i=0;i<custom.length;i++){var td1=td.clone().empty();var share1=custom[i];var shareConf=share1[1];if(shareConf.template){var ret=shareConf.template(conf);if(ret&&ret.length>0){ret.addClass("gig-button-container");ret.addClass("gig-button-container-"+shareConf.provider);if(shareConf.gsStyle){ret.css(shareConf.gsStyle);}
td1.append(ret);}else continue;}
var new_el=td1[0];if(!onlyPersonal&&is_vertical){var tr1=tr.clone().empty();tr1.append(new_el);new_el=tr1[0];}
var el_at_index=children[share1[0]];if(el_at_index){$(el_at_index).before(new_el);}else{to_append.append(new_el);}
if(ret.children().length>0&&ret.children()[0].initGsCustom)ret.children()[0].initGsCustom();children.splice(share1[0],0,new_el);}}
var printZeroComments=function(cont,selectorContainer,selectorSpan){var container=cont.parent().find(selectorContainer);if(container.length>0){for(var i=0;i<container.length;i++){var container1=$(container[i]);var span=container1.find(selectorSpan);for(var j=0;j<span.length;j++){var span1=$(span[j]);var text=$.trim(span1.text());if(text.length==0){span1.html("0");container1.addClass("zero-comments");}}}}}
conf.onLoad=function(ev){if(custom.length>0){checkCustomButtons(ev);if(hasCustomCount&&conf.showCounts!="none"){window.gsPlugins._getShareCounts(conf,function(counts){for(var p in counts){var cou1=cont.find(".gs-custom-"+p+" .gs-count");if(cou1.length>0){cou1.html(window.gsPlugins._printCount(counts[p],conf.gsKiloSuffix,conf.gsMegaSuffix));}}});var comments1=cont.find(".gs-custom-comments .gs-count");if(comments1.length>0){for(var i=0;i<custom.length;i++){var custom1=custom[i][1];if(custom1.provider=="gs-custom-customtpl-comments"){window.gsPlugins._getCommentsCount(conf,custom1,function(counts){comments1.html(window.gsPlugins._printCount(counts.comments,conf.gsKiloSuffix,conf.gsMegaSuffix));});}}}}else{cont.find(".gs-count").hide();}}
cont.find(".gig-button-container").each(function(i,a){var classes=$(a).attr("class").trim().split(/\s+/)
classes=$.grep(classes,function(b,j){return b.indexOf("gig-button-container-")==0;});classes=$.map(classes,function(b,j){return b+"-td";});$(a).parent("td").addClass(classes.join(" "));});if(comments&&comments.length>0&&conf.gsPrintZeroComments&&conf.containerID){if(conf.gsPrintZeroComments===true)conf.gsPrintZeroComments={};if(!conf.gsPrintZeroComments.containerSelector)conf.gsPrintZeroComments.containerSelector="#"+conf.containerID;if(!conf.gsPrintZeroComments.spanSelector)conf.gsPrintZeroComments.spanSelector="span[id*='count-value']";printZeroComments(cont,conf.gsPrintZeroComments.containerSelector,conf.gsPrintZeroComments.spanSelector);}
if(onLoad1)onLoad1(ev);}
conf.shareButtons=standard;}
var commonFunc=function(conf){var act=window.gsPlugins._getUserAction(conf);conf.userAction=act;gsPlugins._showShareBarUIPrepareButtons(conf);}
var perIdFunc=function(conf1){if(!window.gsPlugins._getUrl(conf1))return;var container=$(document.getElementById(conf1.containerID));var onLoad1=conf1.onLoad;conf1.onLoad=function(){if(conf1.gsMinimizeWidth){gsMinimizeWidth(conf1);}
if(window.gsPlugins.shareBarrier&&container.length>0)window.gsPlugins.shareBarrier.completed();if(onLoad1)onLoad1();setTimeout(function(){container.closest(".gs-sharebuttons").removeClass("hidden");},1000);}
var onShareButtonClicked1=conf1.onShareButtonClicked;conf1.onShareButtonClicked=function(event){if(event.shareItem['provider']=='comments'){window.location.href=conf1.gsCommentsAnchor;}
if(onShareButtonClicked1)onShareButtonClicked1(event);}
if(conf1.gsActivity!==undefined){var onSendDone1=conf1.onSendDone;conf1.onSendDone=function(data){if(window.gigya&&conf1.userAction){var userActionActivity=conf1.userAction.clone();userActionActivity.setActionName("ha consigliato");var confPublish={userAction:userActionActivity,scope:"internal",privacy:"public"};if(conf1.gsActivity.feedID){confPublish.feedID=conf1.gsActivity.feedID;}
else{confPublish.feedID=window.location.hostname.replace(/\./gi,"-");}
gigya.socialize.publishUserAction(confPublish);}
if(onSendDone1)onSendDone1();}}
window.gsPlugins._checkCID(conf1,"share");if(window.gsPlugins.shareBarrier&&container.length>0){window.gsPlugins.shareBarrier.addCallback();}
gsCustomButtons(conf1);if(!conf1.tags)conf1.tags="";if(conf1.gsAfterConf){conf1.gsAfterConf();}
gsPlugins.__shareButtons.push(conf1);if(!conf1.__gsCommentsButtonCall){if(conf1.gsStandalone&&window.gigyaCommentParams&&conf1.gsOrderButtons)gsPlugins._checkCommentButtons();else $(function(){gsPlugins._checkCommentButtons();});}
if(window.gigya&&gigya.socialize&&container.length>0){if(conf1.shareButtons&&conf1.shareButtons.length>0){gigya.socialize.showShareBarUI(conf1);}else if(conf1.onLoad)conf1.onLoad();}else if(conf1.gsStandalone&&container.length>0){if(conf1.onLoad)conf1.onLoad();}}
var defaultConf=window.gsPlugins.DEFAULT_CONF_SHAREBAR;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showReactionsBarUI:function(localConf){var commonFunc=function(conf){var userActionUrl=window.gsPlugins._getUrl(conf);var act=window.gsPlugins._getUserAction(conf);conf.userAction=act;if(!conf.barID&&userActionUrl){conf.barID=window.gsPlugins._urlToId(userActionUrl);}
window.gsPlugins._configureEachReaction(conf);}
var perIdFunc=function(conf1){if(!window.gsPlugins._getUrl(conf1))return;window.gsPlugins._checkCID(conf1,"reactions");if(conf1.gsAfterConf){conf1.gsAfterConf();}
if(window.gigya&&conf1.reactions.length&&conf1.reactions.length>0)gigya.socialize.showReactionsBarUI(conf1);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_REACTIONS;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showPollUI:function(localConf){var resultsByBarId={};var countByBarId={};var commonFunc=function(conf){var userActionUrl=window.gsPlugins._getUrl(conf);var act=window.gsPlugins._getUserAction(conf);conf.userAction=act;window.gsPlugins._configureEachReaction(conf);}
var barIDRegExp=new RegExp("^[a-z0-9\\-]+?\\-[0-9]{8}$");var checkBarID=function(barID){var ret=true;ret&=barID&&barIDRegExp.test(barID);return ret;}
var perIdFunc=function(conf1){if(!window.gsPlugins._getUrl(conf1))return;var container=$("#"+conf1.containerID);var containerResults=$("#"+conf1.containerID+"-results");var containerCount=$("#"+conf1.containerID+"-count");window.gsPlugins._checkCID(conf1,"polls");if(window.gigya&&conf1.barID&&checkBarID(conf1.barID)&&conf1.reactions.length&&conf1.reactions.length>0){if(conf1.gsAfterConf){conf1.gsAfterConf();}
if(container.length>0)gigya.socialize.showReactionsBarUI(conf1);if(conf1.gsResultTemplate)window.gsPlugins._downloadReactionTemplate(conf1,containerResults,conf1.gsResultTemplate,resultsByBarId);if(conf1.gsCountTemplate)window.gsPlugins._downloadReactionTemplate(conf1,containerCount,conf1.gsCountTemplate,countByBarId);}}
var defaultConf=window.gsPlugins.DEFAULT_CONF_POLLS;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showRatingUI:function(localConf){if(!window.gigya)return;var commonFunc=function(conf){var url=window.gsPlugins._getUrl(conf);if(!conf.streamID&&url){conf.streamID=url;}}
var perIdFunc=function(conf1){if(window.gigya&&conf1.categoryID&&conf1.streamID)gigya.comments.showRatingUI(conf1);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_RATING;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},_checkCommentButtons:function(conf1){if(!conf1||!conf1.categoryID||conf1.streamID){if(window.gigyaCommentParams){var categoryID=gigyaCommentParams.category||gigyaCommentParams.categoryID;var streamID=gigyaCommentParams.streamID||this._getUrl();if(categoryID&&streamID){conf1={categoryID:categoryID,streamID:streamID};}}}
var sharebuttons=window.gsPlugins.__shareButtons;if(sharebuttons&&conf1&&conf1.categoryID&&conf1.streamID){for(var i=0;i<sharebuttons.length;i++){var sb=sharebuttons[i];if(sb.containerID&&sb.gsCommentsButton){var commBConf=$.extend(true,{},sb.gsCommentsButton);var commsBID=sb.containerID+"-comments";if(commBConf.containerID)commsBID=commBConf.containerID;else commBConf.containerID=commsBID;commBConf.gsStandalone=sb.gsStandalone;commBConf.__gsCommentsButtonCall=true;if(!commBConf.layout)commBConf.layout=sb.layout;var not_comments=sb.gsButtons===undefined||$.grep(sb.gsButtons,function(a,i){return!!a&&(a.provider=="comments"||a.providers=="gs-customtpl-comments");}).length==0;var comms=$("#"+commsBID);if(not_comments&&comms.length>0){var buttonN=sb.gsStandalone?"gs-customtpl-comments":"comments";if(!commBConf.gsButtons)commBConf.gsButtons=[{"provider":buttonN}];$(commBConf.gsButtons).each(function(i,b){if(b.provider==buttonN){b.categoryID=conf1.categoryID;b.streamID=conf1.streamID;}});if(!commBConf.gsOrderButtons)commBConf.gsOrderButtons=buttonN;gsPlugins.showShareBarUI(commBConf);delete sb.gsCommentsButton;}}}}},showCommentsUI:function(localConf){var commonFunc=function(conf){var url=window.gsPlugins._getUrl(conf);if(!conf.streamID&&url){conf.streamID=url;}
if(!conf.streamURL&&url){conf.streamURL=url;}
var act=window.gsPlugins._getUserAction(conf);conf.userAction=act;}
var perIdFunc=function(conf1){if(!window.gsPlugins._getUrl(conf1))return;window.gsPlugins._checkCID(conf1,"comments");if(conf1.feedID!=undefined){conf1.scope="both"
conf1.userAction.setActionName("ha commentato");if(conf1.feedID==""){conf1.feedID=window.location.hostname.replace(/\./gi,"-");}}
var onLogin=function(){setTimeout(function(){window.gsPlugins._show_comments_button(conf1);},0);}
var container=$("#"+conf1.containerID);if(conf1.gsUserProfileLink){container.delegate(".gig-comment-img,.gig-comment-username","click",function(ev){var src=$(this).closest(".gig-comment").find(".gig-comment-img").attr("src");if(src)conf1.gsUserProfileLink(src);})}
var onLoad1=conf1.onLoad;conf1.onLoad=function(){if(conf1.gsUserProfileLink){container.addClass("gs-social-comments-userprofile");}
window.gsPlugins._show_comments_count(conf1);onLogin();if(conf1.gsReadOnlyText&&window.gsPlugins._comments_readonly(conf1)){window.gsPlugins._show_readonly_message(conf1);}
container.delegate(".gig-comments-replyBox textarea","keyup paste",function(e){var textarea=$(this);if(e.type=="keyup"){window.gsPlugins._trim_text(textarea,conf1.gsCountChars);}
else{setTimeout(function(){window.gsPlugins._trim_text(textarea,conf1.gsCountChars);},150)}});if(conf1.version===2){$("#"+conf1.containerID+" .gig-comment-providerLogo").hide();}
if(onLoad1)onLoad1();}
gigya.socialize.addEventHandlers({onLogin:onLogin,onConnectionAdded:onLogin,onLogout:onLogin});gsPlugins._checkCommentButtons(conf1);if(conf1.gsRatingUI&&conf1.containerID){var confR=conf1.gsRatingUI;if(!confR.containerID)confR.containerID=conf1.containerID+"-rating";if(!confR.categoryID)confR.categoryID=conf1.categoryID;if(!confR.streamID)confR.streamID=conf1.streamID;if(!confR.gsUrl&&conf1.gsUrl)confR.gsUrl=conf1.gsUrl;confR.linkedCommentsUI=conf1.containerID;gsPlugins.showRatingUI(confR);}
if(window.gigya&&conf1.categoryID&&conf1.streamID)gigya.comments.showCommentsUI(conf1);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_COMMENTS;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},_trim_text:function(elem,limit){var text=elem.val().substring(0,limit);var scroll_pos=elem.scrollTop();elem.val(text);elem.scrollTop(scroll_pos);},_show_comments_count:function(conf){if($("#"+conf.containerID+'-countchars').length>0){return;}
var counter=$('<div id="'+conf.containerID+'-countchars" title="'+conf.gsCountChars+'" style="float:right"><span>'+conf.gsCountChars+'</span> caratteri rimanenti</div><br style="clear:right" />');if(conf.version===2){var comment_box=$('#'+conf.containerID+' .gig-composebox-footer');var comment_textarea=$('#'+conf.containerID+' .gig-composebox-textarea');counter.css("margin-right","10px");comment_box.append(counter);}else{var comment_box=$('#'+conf.containerID+'-commentBox .gig-comments-commentBox-commentBox');var comment_textarea=$('#'+conf.containerID+'-commentTextarea');comment_box.before(counter);}
var limit=conf.gsCountChars;comment_textarea.bind('paste',function(e){setTimeout(function(){window.gsPlugins._update_comments_counter(comment_textarea,counter,limit,conf);},150)});comment_textarea.keyup(function(e){window.gsPlugins._update_comments_counter(comment_textarea,counter,limit,conf);});},_update_comments_counter:function(textarea,counter,limit,conf){if(conf.version===2){var txt=textarea.text();}else{var txt=textarea.val();}
var len=txt.length;if(len>limit){var scroll_pos=textarea.scrollTop();textarea.val(txt.substring(0,limit));textarea.scrollTop(scroll_pos);len=limit;}
counter.html('<span>'+(limit-len)+'</span> caratteri rimanenti');},_show_comments_button:function(conf){if(conf.version===2){var button=$('#'+conf.containerID+' .gig-composebox-post');}else{var button=$('#'+conf.containerID+' .gig-comments-commentBox-button-post');}
button.text(conf.gsTextButton);},_show_readonly_message:function(conf){var message=$("<h1>").css("font-size","1.2em");var hours=new Date().getHours();var is_night=hours>=22||hours<8;if(is_night&&conf.gsNoModerationText){message.text("Dalle 22 alle 8 non è possibile inserire nuovi commenti.");}else{message.text("I commenti sono temporaneamente chiusi.");}
if(conf.version===2){var box=$('#'+conf.containerID);box.prepend(message);}else{var box=$('#'+conf.containerID+'-commentBox');box.append(message);}},_comments_readonly:function(conf){if(conf.version===2){if($('#'+conf.containerID+' .gig-comments-composebox').is(':hidden')){return true;}}else{if($('#'+conf.containerID+'-commentBox').find("textarea").length==0){return true;}}
return false;},showChatUI:function(localConf){var commonFunc=function(conf){};var perIdFunc=function(conf1){window.gsPlugins._checkCID(conf1,"chat");if(window.gigya&&conf1.categoryID)gigya.chat.showChatUI(conf1);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_CHAT;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showFollowBarUI:function(localConf){var commonFunc=function(conf){if(conf.gsDisableButtons){window.gsPlugins.__checkDisableButtons(conf,"buttons");}
if(conf.gsOrderButtons){window.gsPlugins.__checkOrderButtons(conf,"buttons");}
if(conf.gsButtons){window.gsPlugins.__checkButtons(conf,"gsButtons","buttons");}}
var perIdFunc=function(conf1){window.gsPlugins._checkCID(conf1,"follow");if(conf1.gsCustomTemplate){conf1.buttonTemplate='<div class="gs-follow-button gs-follow-button-$provider"></div>';}
if(conf1.gsAfterConf){conf1.gsAfterConf();}
var smallIcons=conf1.iconSize&&conf1.iconSize<=20;var createFBConf=function(containerID1,conf1,b1){return{containerID:containerID1,gsButtons:[{provider:"gs-native-facebook",type:"like-box",href:b1.actionURL,header:false,"show-border":false}],gsOrderButtons:"gs-native-facebook"}}
var createTwConf=function(containerID1,conf1,b1){return{containerID:containerID1,gsButtons:[{provider:"gs-native-twitter",text:"Segui @"+b1.followUsers,lang:"it","show-count":true,"show-screen-name":true,href:"https://twitter.com/"+b1.followUsers}],gsOrderButtons:"gs-native-twitter"}}
var createLinkedinConf=function(containerID1,conf1,b1){return{containerID:containerID1,gsButtons:[{provider:"gs-native-linkedin"}],gsOrderButtons:"gs-native-linkedin"}}
var createBalloon=function(conf1,b1,getConf){var popup=$("<div></div>").addClass("gs-social-popup");var trigger=$("<div></div>").addClass("gs-social-popup-trigger").addClass("gs-follow-button").addClass("gs-follow-button-"+b1.provider);var balloon=$("<div></div>").addClass("gs-social-popup-balloon").addClass("gs-social-popup-balloon-"+b1.provider);var containerID1=conf1.containerID+"-"+b1.provider;balloon.attr("id",containerID1);popup.append(trigger).append(balloon);var conf=getConf(containerID1,conf1,b1);conf.gsUrl=location.href;conf=JSON.stringify(conf);trigger.attr("data-sharebuttons",conf);if(!conf1.gsCustomTemplate&&!conf1.buttonTemplate){var img=$("<img>");img.attr("src","//www.repstatic.it/cless/common/social/stable/img/followbar/"+b1.provider+".png");img.css("width","30px");if(smallIcons)img.css("width","20px");trigger.append(img);}
if(conf1.buttonTemplate){var html1=conf1.buttonTemplate.replace(/\$provider/g,b1.provider);var button=$(html1);trigger.append(button);}
return popup;}
var createContents={"facebook":function(conf1,b1){return createBalloon(conf1,b1,createFBConf);},"twitter":function(conf1,b1){return createBalloon(conf1,b1,createTwConf);},"linkedin":function(conf1,b1){var ret=createBalloon(conf1,b1,createLinkedinConf);if($(ret).find("#"+conf1.containerID+"-"+b1.provider).size()){var html_link=$('<script src="//platform.linkedin.com/in.js" type="text/javascript"> lang: en_US</script><script type="IN/FollowCompany" data-id="'+b1.dataId+'" data-counter="right"></script>');$(ret).find("#"+conf1.containerID+"-"+b1.provider).html(html_link);}else
ret='';return ret;},"instagram":function(conf1,b1){var ret=$('<a class="gnn-header_socials_instagram" href="'+b1.actionURL+'" title="Instagram"><svg width="16" height="16"><path fill="#7F7F7F" fill-rule="nonzero" d="M8 0C5.827 0 5.555.01 4.702.048 3.85.088 3.27.222 2.76.42a3.918 3.918 0 0 0-1.417.923c-.445.444-.72.89-.923 1.417-.198.51-.333 1.09-.372 1.942C.008 5.555 0 5.827 0 8s.01 2.445.048 3.298c.04.851.174 1.432.372 1.942.204.525.478.973.923 1.417.444.444.89.72 1.417.923.51.197 1.09.333 1.942.372.853.04 1.125.048 3.298.048s2.445-.01 3.298-.048c.851-.04 1.432-.175 1.942-.372a3.932 3.932 0 0 0 1.417-.923c.444-.444.72-.89.923-1.417.197-.51.333-1.09.372-1.942.04-.853.048-1.125.048-3.298s-.01-2.445-.048-3.298c-.04-.851-.175-1.433-.372-1.942a3.926 3.926 0 0 0-.923-1.417A3.898 3.898 0 0 0 13.24.42c-.51-.198-1.09-.333-1.942-.372C10.445.008 10.173 0 8 0zm0 1.44c2.135 0 2.39.01 3.233.047.78.037 1.204.166 1.485.277.375.145.64.318.921.597.28.28.453.546.598.921.109.281.24.705.275 1.485.038.844.047 1.097.047 3.233s-.01 2.39-.05 3.233c-.04.78-.17 1.204-.28 1.485-.15.375-.32.64-.6.921-.279.28-.549.453-.92.598-.28.109-.71.24-1.49.275-.849.038-1.099.047-3.239.047-2.14 0-2.39-.01-3.24-.05-.78-.04-1.21-.17-1.49-.28-.38-.15-.64-.32-.92-.6a2.43 2.43 0 0 1-.6-.92c-.11-.28-.239-.71-.28-1.49-.03-.84-.04-1.099-.04-3.229s.01-2.39.04-3.24c.041-.78.17-1.21.28-1.49.14-.38.32-.64.6-.92.28-.28.54-.46.92-.6.28-.11.7-.24 1.48-.28.85-.03 1.1-.04 3.24-.04l.03.02zm0 2.452a4.108 4.108 0 1 0 0 8.215 4.108 4.108 0 0 0 0-8.215zm0 6.775a2.666 2.666 0 1 1 0-5.334 2.666 2.666 0 1 1 0 5.334zm5.23-6.937a.96.96 0 1 1-1.92-.001.96.96 0 0 1 1.92.001z"></path></svg></a>');return ret;},"rss":function(conf1,b1){var ret=$('<a style="padding:0px;margin:0px;border:0px;"></a>');ret.attr("href",b1.actionURL);if(!conf1.gsCustomTemplate){var img=$("<img>");img.attr("src","//www.repstatic.it/cless/common/social/stable/img/followbar/"+b1.provider+".png");img.css("width","30px");if(smallIcons)img.css("width","20px");ret.append(img);}
return ret;}}
if(conf1.containerID){var cont=$("#"+conf1.containerID);var followbar=$('<div class="gs-followbar gig-followbar"></div>');if(smallIcons)followbar.addClass("gs-followbar-small");if(!conf1.gsCustomTemplate)followbar.addClass("gs-followbar-default");cont.append(followbar);cont.addClass("gig-followbar");if(conf1.buttons){for(var i=0;i<conf1.buttons.length;i++){var b1=conf1.buttons[i];var followbarCell=$('<div class="gs-followbar-cell"></div>');if(createContents[b1.provider]){var conts=createContents[b1.provider](conf1,b1);followbarCell.append(conts);followbar.append(followbarCell);gsPlugins.lazyPopups.init(followbarCell);}}}}}
var defaultConf=window.gsPlugins.DEFAULT_CONF_FOLLOWBAR;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showFeedUI:function(localConf){var commonFunc=function(conf){};var perIdFunc=function(conf1){if(!conf1.feedID){conf1.feedID=window.location.hostname.replace(/\./gi,"-");}
window.gsPlugins._checkCID(conf1,"activityfeed");if(conf1.gsAfterConf){conf1.gsAfterConf();}
if(window.gigya)gigya.socialize.showFeedUI(conf1);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_ACTIVITYFEED;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},showPrintUI:function(localConf){var commonFunc=function(conf){}
var perIdFunc=function(conf1){var container=$("#"+conf1.containerID);container.css("overflow","hidden");container.children().css("float","left");var print=$('<a title="Stampa questa pagina" href="javascript:window.print()"><span class="gs-print-text">Stampa</span></a>');print.addClass("gs-print");print.css("float","left");if(conf1.iconUrl){print.css({"background-image":"url(\""+conf1.iconUrl+"\")","background-position":"0px 0px"});}
else{print.addClass("default-icon");}
if(conf1.text!==undefined){if(conf1.text.length==0)print.find(".gs-print-text").hide();else print.find(".gs-print-text").html(conf1.text);}
container.append(print);}
var defaultConf=window.gsPlugins.DEFAULT_CONF_PRINT;this.withMultipleContainer(defaultConf,localConf,commonFunc,perIdFunc);},_parseAttributeConf:function(trigger){var attributeMethod={"sharebuttons":"showShareBarUI","follow":"showFollowBarUI","reactions":"showReactionsBarUI","polls":"showPollUI","comments":"showCommentsUI","chat":"showChatUI","activityfeed":"showFeedUI"};var method=undefined;var type=undefined;var conf=undefined;$.each(attributeMethod,function(attribute,method1){var attr=trigger.attr("data-"+attribute);if(attr){try{if((typeof attr).toLowerCase()=="string")eval("conf="+attr);else conf=attr;}catch(e){}
if(conf){type=attribute;method=method1;return false;}}})
var attrConf={};attrConf.type=type;attrConf.method=method;attrConf.conf=conf;return attrConf;},_renderAttributeConf:function(attrConf,callback){var me=window.gsPlugins;if(attrConf.type&&attrConf.method&&attrConf.conf){var conf=attrConf.conf;var method=attrConf.method;var type=attrConf.type;var confPrint=attrConf.confPrint;var onLoad1=conf.onLoad;conf.onLoad=function(){if(callback)callback();if(onLoad1)onLoad1();if(type=="sharebuttons"&&confPrint!==undefined){confPrint.containerID=conf.containerID;me.showGlobalConfPlugins(me.showPrintUI,confPrint);}}
if(window.gsPlugins)window.gsPlugins[method](conf);}},inplace:{init:function(elements,force){if(!elements)elements=$("body");elements=$(elements);var me=window.gsPlugins;var triggers=elements.find(".gs-social-inplace").not(".initialized");if(force)triggers=elements;triggers.each(function(i,trigger){trigger=$(trigger);trigger.addClass("initialized");var triggerId=trigger.attr("id");if(!triggerId){return;}
var attrConf=me._parseAttributeConf(trigger);var conf=attrConf.conf;var confPrint=undefined;if(!conf){return;}
if(conf.gsInplace){if(conf.gsInplace.print!==undefined){attrConf.confPrint=conf.gsInplace.print;}}
if(!conf.containerID){conf.containerID=triggerId;}
me._renderAttributeConf(attrConf);});}},lazyPopups:{balloons:jQuery([]),triggers:jQuery([]),containers:jQuery([]),configure:function(){if(window.gsPluginsConf.lazyPopups){jQuery.each(window.gsPluginsConf.lazyPopups,function(k,v){var trigger=$("#"+k);if(trigger.length==0)return;var type=v.type;if(!type)return;attrName="data-"+type
trigger[0][attrName]=v.conf;});window.gsPluginsConf.lazyPopups={};}},init:function(elements){this.configure();if(!elements)elements=$("body");elements=$(elements);var me=window.gsPlugins;var triggers=elements.find(".gs-social-popup-trigger").not(".initialized,.preinitialized");triggers.each(function(i,trigger){trigger=$(trigger);trigger.addClass("preinitialized");var balloon=null;var delayEnter=300;var delayLeave=600;var delayLoading=1000;var delayOpen=200;var attrConf=me._parseAttributeConf(trigger);var conf=attrConf.conf;if(!conf||!conf.containerID){trigger.addClass("initialized");return;}
var container=trigger.closest(".gs-social-popup");balloon=$(document.getElementById(conf.containerID));if(balloon.length==0)return;var all=trigger.add(container).add(balloon);if(conf.gsPopup){var gsPopup=conf.gsPopup;if(gsPopup.delayEnter)delayEnter=conf.gsPopup.delayEnter;if(gsPopup.delayLeave)delayLeave=conf.gsPopup.delayLeave;if(gsPopup.delayLoading)delayLoading=conf.gsPopup.delayLoading;if(gsPopup.delayOpen)delayOpen=conf.gsPopup.delayOpen;if(gsPopup.loading===false)delayLoading=0;if(gsPopup.print!==undefined){attrConf.confPrint=gsPopup.print;}}
var onLoad1=conf.onLoad;conf.onLoad=function(){if(onLoad1)onLoad1();setTimeout(function(){all.removeClass("notloaded");all.addClass("loaded");},delayLoading);}
me.lazyPopups.balloons=me.lazyPopups.balloons.add(balloon);me.lazyPopups.triggers=me.lazyPopups.triggers.add(trigger);me.lazyPopups.containers=me.lazyPopups.containers.add(container);var lastOpenClose=null;var open=function(){lastOpenClose=new Date().getTime();if(!trigger.hasClass("initialized")){me._renderAttributeConf(attrConf);all.addClass("initialized");all.addClass("notloaded");}
me.lazyPopups.balloons.removeClass("open");me.lazyPopups.triggers.removeClass("open");me.lazyPopups.containers.removeClass("open");all.addClass("open");}
var close=function(){all.removeClass("open");}
var timIn=null;var inside=function(){if(balloon.is(":not(.open)")&&trigger.is('.hover')){open();}
timIn=null;};var timOut=null;var outside=function(){if(balloon.is(".open")&&balloon.is(':not(.hover)')){close();}
timOut=null;};var tmouseover=function(){trigger.addClass("hover");if(timIn)return;else{timIn=setTimeout(inside,delayEnter);}
bmouseover();}
var tmouseout=function(){trigger.removeClass("hover");if(timIn){clearTimeout(timIn);timIn=null;}
bmouseout();}
var bmouseout=function(){balloon.removeClass("hover");if(timOut)return;else{timOut=setTimeout(outside,delayLeave);}}
var bmouseover=function(){balloon.addClass("hover");if(timOut){clearTimeout(timOut);timOut=null;}}
trigger.hover(tmouseover,tmouseout);balloon.hover(bmouseover,bmouseout);trigger.click(function(){var now=new Date().getTime();if(lastOpenClose&&now<lastOpenClose+delayOpen)return;lastOpenClose=now;if(balloon.is(".open")){close();}else{open();}})});}},highlighter:function(conf){if(!$.fn.highlighter)return;var containerSelector=".highlighter-container";if(conf.containerSelector)containerSelector=conf.containerSelector;var highlighter_container=$(containerSelector);if(highlighter_container.length==0){if(!conf.containerContent){var containerContent=$("<div class='highlighter-container'><div id='highlighter-container-title'>Condividi la selezione "+"<span class='highlighter-container-chars'></span></div><div id='highlighter-container-share'></div></div>");}else{var containerContent=conf.containerContent;}
highlighter_container=containerContent;$("body").append(highlighter_container);if(!conf.textSelector){var textSelector='span.article-body';}else{var textSelector=conf.textSelector}
if(textSelector.call)textSelector=textSelector.call();var article_body=$(textSelector);if(!article_body.highlighter)return;var shareButton={containerID:"highlighter-container-share",layout:'vertical',iconsOnly:true,showCounts:'none',buttonTemplate:'<a href="javascript:void(0);" onclick="$onClick"><div class="floating-highlight-img"></div><div class="floating-highlight-text"></div></a>',gsButtons:[{"provider":"facebook"},{"provider":"twitter"}],gsOrderButtons:"facebook,twitter,email"}
if(conf.shareButton)shareButton=$.extend(true,{},shareButton,conf.shareButton);var highlighterConf={'selector':containerSelector,'minWords':3,'complete':function(data){if(data&&data.length){highlighter_container.find(".highlighter-container-chars").html(data.length+" caratteri");}
if(window.gsPlugins){shareButton.gsDescription=data;var twitterConf=$.grep(shareButton.gsButtons,function(a){return a.provider=="twitter"});if(twitterConf.length>0){twitterConf[0].gsTitle=data;}
gsPlugins.showShareBarUI(shareButton);}}};if(conf.highlighterConf)highlighterConf=$.extend(true,{},highlighterConf,conf.highlighterConf);article_body.highlighter(highlighterConf);}},openGraph:{ogType:function(){var ret=null;var type=$("meta[property='og:type']");if(type.length>0)ret=type.attr("content").split(":");return ret;},create:function(action,object,callback,graphParams1){var me=window.gsPlugins.openGraph;if(!graphParams1)graphParams1={};var ogType=me.ogType();var domain=ogType[0];if(graphParams1.ogDomain){domain=graphParams1.ogDomain;delete graphParams1.ogDomain;}
var pobject=ogType[1];if(!pobject)pobject=ogType[0];var url=$("meta[property=\"og:url\"]").attr("content");var graphParams={};if(object==pobject)graphParams[object]=url;graphParams=jQuery.extend(true,graphParams,graphParams1);if(!graphParams[object])return;var params1={graphPath:"/me/"+domain+":"+action,method:'POST',graphParams:graphParams};var callback1=function(response){if(response.errorCode==0){if(!me.__lastObjects)me.__lastObjects={};me.__lastObjects[action]=response.graphResponse.id;}
if(callback)callback(response);}
params1.callback=callback1;if(window.gigya)gigya.socialize.facebookGraphOperation(params1);},edit:function(action,object,callback,graphParams1){var me=window.gsPlugins.openGraph;if(!object&&me.__lastObjects&&me.__lastObjects[action]){object=me.__lastObjects[action];}
if(!object){callback({errorCode:-1});}else{if(!graphParams1)graphParams1={};var graphParams={};graphParams=jQuery.extend(true,graphParams,graphParams1);var params1={graphPath:"/"+object,method:'POST',graphParams:graphParams};if(callback)params1.callback=callback;if(window.gigya)gigya.socialize.facebookGraphOperation(params1);}}},comments:{post:function(text,conf){var conf1=jQuery.extend(true,{},conf);var act=window.gsPlugins._getUserAction(conf1);var url=window.gsPlugins._getUrl(conf1);act.setUserMessage(text);conf1.userAction=act;conf1.commentText=text;conf1.streamID=url;if(window.gigya)gigya.comments.postComment(conf1);},enrichForm:function(form,conf){if(!window.GeleSocial||!window.GeleSocial.version||window.GeleSocial.version!=2)return;var conf1=jQuery.extend(true,{},conf);var logged=GeleSocial.status.logged;var input=form.find("textarea").last();var submit=form.find('[type="submit"]').last();form.find('*[name="submit"]').attr("name","submit2");if(!logged){var gsNotLoggedAction=function(){GeleSocial.openLoginModal();}
if(conf1.gsNotLoggedAction)gsNotLoggedAction=conf1.gsNotLoggedAction;var gsNotLoggedAction1=gsNotLoggedAction;gsNotLoggedAction=function(){gsNotLoggedAction1();return false;}
input.focus(gsNotLoggedAction);submit.focus(gsNotLoggedAction);submit.mousedown(gsNotLoggedAction);}else{var activeProviders=GeleSocial.status.gigya.activeProviders;activeProviders=jQuery.grep(activeProviders,function(a){return a!="site"&&a!="google";});var renderCheckboxes=function(activeProviders){var checkboxes=$('<div class="gs-enrich-comment-providers"><span id="gs-enrich-comment-label">Condividi su:</span></div>');checkboxes.css({"line-height":"50px"});jQuery.each(activeProviders,function(i,a){var title="Condividi su "+a.substring(0,1).toUpperCase()+a.substring(1);var id='gs-enrich-comment-provider-'+a;var input=$('<input type="checkbox" checked="checked" class="gs-enrich-comment-provider" data-provider="'+a+'" id="'+id+'" title="'+title+'"/>');var checkbox=$('<span></span>');checkbox.append(input);var img=$('<span title="'+title+'" id="'+id+'-img"></span>');img.css({"margin-right":"7px","padding-right":"16px","background-image":'url("http://cdn.gigya.com/gs/i/shareBar/icons/'+a+'.png")',"background-position":"right"});checkbox.css({"vertical-align":"middle"});checkboxes.append(checkbox);checkboxes.append(img);img.click(function(){input.click();});});return checkboxes;}
var checkboxes=null;if(conf1.gsTemplates&&conf1.gsTemplates.renderCheckboxes)checkboxes=conf1.gsTemplates.renderCheckboxes(activeProviders);else checkboxes=renderCheckboxes(activeProviders);if(!conf1.containerID)
input.after(checkboxes);else
form.find("#"+conf1.containerID).append(checkboxes);var onsubmit=function(ev){if(onsubmit.disabled)return true;if(conf1.loading)conf1.loading();ev.preventDefault();ev.stopImmediatePropagation();submit.attr('disabled','disabled');var text=input.val();var enabledProviders=[];checkboxes.find('input[type="checkbox"]:checked').each(function(i,a){var prov=$(a).attr("data-provider");enabledProviders.push(prov);});conf1.enabledProviders=enabledProviders;conf1.callback=function(){onsubmit.disabled=true;if(form.length>0&&form[0].submit&&form[0].submit.click){submit.removeAttr('disabled');submit.click();submit.attr('disabled','disabled');}else{form.submit();}
onsubmit.disabled=false;}
var ret=window.gsPlugins.comments.post(text,conf1);return false;};form.submit(onsubmit);}}}};window.gsPlugins.customTemplate=new(function(){var langData={localization:{"it":"it_IT"}}
var getUrl=function(conf,button,overrides){var ret=button.gsUrl&&window.gsPlugins._checkLinkParams(button.gsUrl,button,button)||overrides.url;if(ret)return ret;else return window.gsPlugins._checkLinkParams(window.gsPlugins._getUrl(conf,true),button,button);};var getVia=function(conf,button){button=$.extend({},button);if(conf.gsVia&&!button.gsVia)button.gsVia=conf.gsVia;return window.gsPlugins._getVia(button);};var getTitle=function(conf,button,overrides){return button.gsTitle||overrides.title||window.gsPlugins._getTitle(conf);};var getDescription=function(conf,button,overrides){return button.gsDescription||overrides.desc||window.gsPlugins._getDescription(conf);};var getImage=function(conf,button,overrides){return button.gsImage||overrides.image||window.gsPlugins._getImage(conf);};var getLang=function(conf,button){return navigator.language||navigator.userLanguage;}
var getProviderOverrides=function(button){return window.gsPlugins._getProviderOverrides(button);}
var getLocalization=function(conf,button){var lang=getLang(conf,button);if(langData.localization[lang])lang=langData.localization[lang];return lang;}
var isNull=function(t){return!t||t=="null"||t=="None";}
var socialNetworks={labels:{"facebook":"Facebook","twitter":"Twitter","linkedin":"LinkedIn","whatsapp":"WhatsApp"},shareLabels:{"it":{"facebook-like":"Mi piace","facebook-recommend":"Consiglia","facebook-share":"Condividi","twitter-share":"Tweet","linkedin-share":"LinkedIn","pinterest-share":"Pinterest","tumblr-share":"Tumblr","email-share":"Email"},"it-IT":{"facebook-like":"Mi piace","facebook-recommend":"Consiglia","facebook-share":"Condividi","twitter-share":"Tweet","linkedin-share":"LinkedIn","pinterest-share":"Pinterest","tumblr-share":"Tumblr","email-share":"Email"},"en-US":{"facebook-like":"Like","facebook-recommend":"Recommend","facebook-share":"Share","twitter-share":"Tweet","linkedin-share":"LinkedIn","pinterest-share":"Pinterest","tumblr-share":"Tumblr","email-share":"Email"},"en_US":{"facebook-like":"Like","facebook-recommend":"Recommend","facebook-share":"Share","twitter-share":"Tweet","linkedin-share":"LinkedIn","pinterest-share":"Pinterest","tumblr-share":"Tumblr","email-share":"Email"}}};var checkFacebookAppID=function(conf){if(conf&&conf.gsStandalone&&conf.gsFacebookAppId)return conf.gsFacebookAppId;if(window.gsPluginsConf&&window.gsPluginsConf.gsFacebookAppId)return gsPluginsConf.gsFacebookAppId;return window.gigya&&gigya.providersConfig&&gigya.providersConfig.facebook&&gigya.providersConfig.facebook.appID;}
var actionUrls={}
actionUrls.facebook=function(conf,button,overrides){var base="https://www.facebook.com/dialog/";var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var description=getDescription(conf,button,overrides);var img=getImage(conf,button,overrides);var is_share=button.type=="share";base+=is_share?"share":"share_open_graph";var appID=checkFacebookAppID(conf);if(!appID)return null;if(conf.gsClosePage)var close_page=conf.gsClosePage;else var close_page="https://www.repubblica.it/static/js/common/gs/close.html";var params={app_id:appID,display:"popup",redirect_uri:close_page}
if(!isNull(title))params.title=title;if(!isNull(description))params.description=description;if(!isNull(img))params.picture=img;if(is_share)params.href=url;else if(window.JSON){var defActionProperties={"og.likes":{"object":url}};if(!button.action_type&&button.type&&button.type=="like")button.action_type="og.likes";if(!button.action_properties&&defActionProperties[button.action_type]){button.action_properties=defActionProperties[button.action_type];}
params.action_type=button.action_type;if(button.action_properties)params.action_properties=JSON.stringify(button.action_properties);}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.twitter=function(conf,button,overrides){if(button.type!="share")return null;var base="https://twitter.com/share";var url=getUrl(conf,button,overrides);var via=getVia(conf,button,overrides);var lang=getLang(conf,button,overrides);var title=getTitle(conf,button,overrides);var params={url:url,lang:lang}
if(via)params.via=via;if(button.text)params.text=text;if(!params.text)params.text=title;if(params.text)params.text=gsPlugins.__checkTwitterTitle(params.text,url,via);return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.pinterest=function(conf,button,overrides){var base="http://www.pinterest.com/pin/create/bookmarklet/";var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var description=getDescription(conf,button,overrides);var img=getImage(conf,button,overrides);var params={url:url,title:title,description:description,media:img}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.linkedin=function(conf,button,overrides){var base="https://www.linkedin.com/shareArticle"
var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var description=getDescription(conf,button,overrides);var params={url:url,title:title,summary:description,source:"",mini:"true"}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.tumblr=function(conf,button,overrides){var base="https://www.tumblr.com/share";var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var params={u:url,t:title,v:3}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.email=function(conf,button,overrides){var base="mailto:";var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var description=getDescription(conf,button,overrides);var body=description||"";if(body.length>0)body+=" ";if(url)body+=url;var params={subject:title,body:body}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.whatsapp=function(conf,button,overrides){var base="whatsapp://send";var url=getUrl(conf,button,overrides);var title=getTitle(conf,button,overrides);var params={text:title+" "+url}
return base+"?"+$.param(params).replace(/\+/g,"%20");}
actionUrls.comments=function(conf,button,overrides){return"#commenta";}
var hasProviderText=function(conf,button){return!(conf.gsCustomTemplateConf&&conf.gsCustomTemplateConf.layout=="square");}
var getProviderText=function(conf,button){var provider=button.provider;var type=button.type;var lang=getLang(conf,button);if(provider=="facebook")type=button.action?button.action:type;if(socialNetworks.shareLabels[lang]&&socialNetworks.shareLabels[lang][provider+"-"+type])return socialNetworks.shareLabels[lang][provider+"-"+type];else return"";}
var getActionUrl=function(conf,button){var ret=null;var overrides=getProviderOverrides($.extend({},conf,button));if(actionUrls[button.provider])ret=actionUrls[button.provider](conf,button,overrides);if(!ret)ret="javascript:void(0)";return ret;}
var getSharedOGUrl=function(conf,button){var overrides=getProviderOverrides(button);var url=button.gsUrl||overrides.url||window.gsPlugins._getUrl(conf);return url;}
var incrementShares=function(incrementUrl,url){$.ajax({dataType:"script",cache:false,url:incrementUrl,data:{url:url}})}
this.toGSCustom=function(conf,share1){var provider=share1.provider;var me=this;if(provider.indexOf("gs-customtpl-")==0){provider=provider.substring("gs-customtpl-".length);}
share1.provider="gs-custom-customtpl-"+provider;share1.template=function(){var widget1=$.extend(true,{},share1);widget1.provider=provider;if(!widget1.type)widget1.type="share";var givenT=widget1.gsCustomTemplate||conf.gsCustomTemplate;var text="";var label="";var hasProviderText1=hasProviderText(conf,widget1);if(provider.length>0){var label=provider[0].toUpperCase()+provider.substring(1);if(socialNetworks.labels[provider])label=socialNetworks.labels[provider];}
if(hasProviderText1)text=getProviderText(conf,widget1);text=widget1.gsText?widget1.gsText:text;var ret=givenT({provider:provider,text:text,label:label,conf:conf,button:widget1});ret=$(ret);var gs_link=ret.find(".gs-link");var gs_count=ret.find(".gs-count");if(ret.hasClass("gs-link"))gs_link=gs_link.add(ret);var showCounts=conf.layout=="vertical"?"top":"right";if(conf.showCounts=="right"||conf.showCounts=="top"||conf.showCounts=="none")showCounts=conf.showCounts;if(!gsPlugins._isCountableProvider(provider,conf)){gs_count.hide();showCounts="none";}
var no_window=["comments","email","whatsapp"].indexOf(provider)>=0;var actionUrl=getActionUrl(conf,widget1);gs_link.attr("href",actionUrl);if(!actionUrl.match(/^https?:/)){if(!no_window)gs_link.attr("target","_blank");}else{gs_link.bind("click",function(){var incrementUrl=conf.gsIncrementMostshared||window.gsPluginsConf&&window.gsPluginsConf.gsIncrementMostshared;var sharedUrl=getSharedOGUrl(conf,widget1);if(incrementUrl&&sharedUrl)incrementShares(incrementUrl,sharedUrl);var href=$(this).attr("href");if(no_window)location.href=href;else window.open(href,"_blank","width=800,height=600");return false;});}
if(text.trim().length>0)ret.addClass("gs-has-text");ret.addClass("gig-button-container-count-"+showCounts);return ret;}};})();window.gsPlugins.native=new(function(){var populateAttrs=function(div,conf,copyAttrs){var attr={};for(var i=0;i<copyAttrs.length;i++){attr[copyAttrs[i]]=conf[copyAttrs[i]];}
var attr1={};for(var i in attr){attr1["data-"+i]=attr[i];}
div.attr(attr1);}
var checkScript=function(d,id,src,fun){var s="script";var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)||(fun&&fun()))return true;js=d.createElement(s);js.id=id;js.type="text/javascript";js.async=true;js.src=src;fjs.parentNode.insertBefore(js,fjs);return false;}
var twitter={check:function(conf,button,element){var check=function(){return window.twttr!==undefined;}
var existing=checkScript(document,"twitter-wjs","//platform.twitter.com/widgets.js",check);if(existing&&element&&element.parentElement){window.twttr.widgets.load(element.parentElement);}},button:function(conf,button){var href=button.href;if(!href&&button.followUsers){href='https://twitter.com/'+escape(button.followUsers);}
var text=button.text;var copyAttrs=["show-count","lang","size","show-screen-name"];var twitter=$('<a href="'+href+'" class="twitter-follow-button"></a>');twitter.text(text);populateAttrs(twitter,button,copyAttrs);return twitter;}}
var facebook={check:function(conf,button,element){var check=function(){return window.FB!==undefined;}
var hasFB=document.getElementById("facebook-jssdk")||check();if(!hasFB){var appID=window.gigya&&gigya.providersConfig&&gigya.providersConfig.facebook&&gigya.providersConfig.facebook.appID;if(window.gsPluginsConf&&gsPluginsConf.gsFacebookAppId)appID=gsPluginsConf.gsFacebookAppId;if(conf.gsFacebookAppId)appID=conf.gsFacebookAppId;if(appID){var fbInitialized=false;var fun=function(){FB.init({appId:appID,xfbml:true,version:'v2.2'});window.gsPlugins.__checkFBEvents();gsPlugins.__facebook_loaded=true;gsPlugins.__events.trigger("gs-plugins.facebook.load",true);fbInitialized=true;};try{Object.defineProperty(window,"fbAsyncInit",{get:function(){return fun;},set:function(f1){var fun1=fun;if(fbInitialized){try{f1()}catch(e){console.error(e);};}else{fun=function(){try{fun1()}catch(e){console.error(e);};try{f1()}catch(e){console.error(e);};}}}})}catch(e){}}}
var existing=checkScript(document,"facebook-jssdk","//connect.facebook.net/it_IT/sdk.js",check);if(existing&&element&&element.parentElement){if(window.FB&&FB.XFBML&&FB.XFBML.parse)FB.XFBML.parse(element.parentElement);}
if(conf.onSendDone){gsPlugins.addCallback("gs-plugins.facebook.like",function(ev,url,el){if(el==element&&conf.onSendDone){var arg={eventName:"sendDone",providers:"gs-native-facebook",source:"showShareBarUI",sourceContainerID:conf.containerID,targetURL:url,userMessage:""}
conf.onSendDone(arg);}});}},button:function(conf,button){var copyAttrs=["href","width","height","colorscheme","layout","show-faces","action","share","show-border","header","small-header","adapt-container-width","hide-cover","show-facepile","show-posts","ref"];var facebook=$('<div></div>');var url=window.gsPlugins._getUrl(button);if(!button.href)button.href=url;populateAttrs(facebook,button,copyAttrs);facebook.addClass("fb-"+button.type);var fbRoot=$("#fb-root");if(fbRoot.length==0){$("body").prepend('<div id="fb-root"></div>');}
return facebook;}}
var whatsapp={check:function(){},default_title:"Ciao! Ti consiglio di vedere questo link:",is_supported:function(){return!!navigator.platform.match(/iPhone|iPod|iPad|Android/i)||!!navigator.userAgent.match(/iPhone|iPod|iPad|Android/i);},button:function(conf,share1){var is_supported=whatsapp.is_supported();var iconImgUp=share1.iconImgUp;var tooltip=share1.tooltip;var width=share1.width;var height=share1.height;var title=gsPlugins._getTitle(share1);if(!title)title=this.default_title;if(!tooltip)tooltip="{title} {url}";if(!width)width=50;if(!height)height=50;if(!iconImgUp)iconImgUp="https://www.repubblica.it/static/images/common/gs/whatsapp.png";var url=window.gsPlugins._getUrl(share1,true);var shortlink=gsPlugins._getShortLink(share1);if(shortlink)url=shortlink;tooltip=tooltip.supplant({url:url,title:title});if(is_supported){var link='whatsapp://send?text='+encodeURIComponent(tooltip);}else{var link="javascript:void(0)";}
if(share1.buttonTemplate){var ret=$(share1.buttonTemplate);}else{var waButton='<a class="gs-whatsapp-link" href="javascript:void(0)">';waButton+='<img src="'+iconImgUp+'" alt="'+tooltip+'" ';waButton+='style="width:'+width+'px;height:'+height+'px"></img>';waButton+='</a>';var ret=$(waButton);}
var link_selector="a";var link1=ret.find(link_selector).addBack(link_selector);link1.attr("href",link);ret.addClass("gig-button-container-count-none gs-sharebutton-whatsapp");if(!is_supported){ret.addClass("gs-sharebutton-disabled");}
return ret;}}
var instagram={check:function(){},button:function(conf,share1){var url=share1.url;var ret='';if(url){var ret='<div>'+'  <style>img.follow-instagram {'+'    margin: 3px 3px 3px 0px;'+'}'+'.gig-button-container-gs-custom-instagram-follow {'+'    border-radius: 3px;'+'    background: #385d7b;'+'    overflow: hidden;'+'    line-height: 22px;'+'    padding: 0px 5px;'+'    font-size: 11px;'+'    font-family: "Helvetica Neue", Arial, sans-serif;'+'}'+'.gig-button-container-gs-custom-instagram-follow * {'+'    display: block; float: left; color: white;'+'  }</style><div class="gig-button-container gig-button-container-gs-custom-instagram-follow">'+'    <a href="'+url+'"><img src="https:///badges.instagram.com/static/images/ig-badge-16.png" class="follow-instagram"><span>Seguici su Instagram</span></a></div>'+'</div>';}
return $(ret);}}
if(!whatsapp.is_supported()){$(function(){$("body").addClass("gs-whatsapp-disabled");});}
var checkFunctions={"facebook":facebook.check,"twitter":twitter.check,"whatsapp":whatsapp.check}
var buttonTemplates={"facebook":facebook.button,"twitter":twitter.button,"whatsapp":whatsapp.button,"instagram":instagram.button}
this.whatsapp={default_title:whatsapp.default_title};this.button=function(conf,provider,button){if(buttonTemplates[provider])return buttonTemplates[provider](conf,button);else return undefined;}
this.render=function(conf,provider,button,element){if(checkFunctions[provider])checkFunctions[provider](conf,button,element);}
this.toGSCustom=function(conf,share1){var provider=share1.provider;var me=this;if(provider.indexOf("gs-native-")==0){provider=provider.substring("gs-native-".length);}
share1.provider="gs-custom-"+provider;share1.template=function(){var button=me.button(conf,provider,share1);if(button&&button.length>0){var ret=$("<div class='gig-button-container'></div>");button[0].initGsCustom=function(){me.render(conf,provider,share1,this);};ret.append(button);button=ret;}
return button;}};})();$(function(){window.gsPlugins.load();});}
if(($.browser&&$.browser.msie&&(parseInt($.browser.version)<=7)||(document.documentMode&&document.documentMode<=7))){window.FB={init:function(){},XFBML:{parse:function(){}}};}
if(window.RenderAsync)RenderAsync.call("gsPlugins");})();;
(function(){if(window.GeleSocial){var logintrekURL='/login/SSO?op=logintrek&service=repubblica.it&trektype=1';var cookiename="repconc2017v1";var expiredate=function(d){d.setDate(d.getDate()+1);d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);}
GeleSocial.addFinalStatusCallback(function(){if(GeleSocial.settings.test){logintrekURL="https://test-login.kataweb.it"+logintrekURL;cookiename="T-"+cookiename;}
else logintrekURL="https://login.kataweb.it"+logintrekURL;var hascookie=document.cookie.match("(^|\\ |;)"+cookiename+"=1($|\\ |;)")
if(!hascookie){if(GeleSocial.status.logged){var success=function(){var d=new Date();expiredate(d);document.cookie=cookiename+'=1; domain=repubblica.it; path=/; expires='+d.toString();}
$.ajax({url:logintrekURL,dataType:"script",cache:true,success:success})}}})}})();;
;;
;;
;window.kwait=window.kwait||[];kwait.push(['call',"common_detail_js"]);